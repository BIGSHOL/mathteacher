"""AI 문제 생성을 위한 교육과정 프롬프트 컨텍스트.

2022 개정 교육과정 기반, 학년별·개념별 핵심 지식을 구조화하여
Gemini 프롬프트에 주입한다.
"""

from typing import TypedDict


class ConceptPromptContext(TypedDict, total=False):
    """개념별 프롬프트 컨텍스트."""

    core_concepts: str  # 핵심 개념·공식
    misconceptions: str  # 주요 오개념
    design_guidelines: str  # 출제 포인트
    key_summary: str  # [Phase 3] 핵심 요약 문장 (빈칸 소거용)

CONCEPT_QUESTION_PROTOCOL = """
## [중요] 개념 문항 개발 프로토콜 (3단 변환 필터)

모든 개념 문제는 출제 전 반드시 아래 3단계를 거쳐 변형해야 합니다. 교과서 정의를 그대로 베끼지 마세요.

1단계 [Extract]: 해당 개념에서 학생들이 가장 많이 틀리는 핵심 포인트나 시각 자료를 추출하세요.
2단계 [Invert]: "답을 구하시오"를 "왜 이것이 답입니까?" 또는 "이 과정은 무엇을 의미합니까?"로 질문을 뒤집으세요.
3단계 [Context]: 가상의 학생(민수, 지혜 등)을 등장시켜 오답 상황이나 대화 상황으로 포장하세요.

### 품질 검증 (모든 문제 필수 통과)
- [NO CALC] 계산을 하지 않아도 개념만으로 풀 수 있는가? (단순 연산 문제 금지)
- [WHY] "왜?"라는 질문에 답을 요구하거나, 과정의 의미를 묻고 있는가?
- [LEVEL] 난이도가 자연스럽게 이어지는가?
"""



# ─────────────────────────────────────────────
# 학년별 특성 (프롬프트 상단에 주입)
# ─────────────────────────────────────────────
GRADE_CONTEXT: dict[str, str] = {
    "elementary_3": (
        "초3: 자연수 연산 완성 + 분수·소수 첫 도입의 교차점. "
        "구체적 조작기 중반부로, 직관적 활동에서 형식적 알고리즘으로 전환하는 시기. "
        "분수 도입은 수포자 발생의 분수령. 개념적 이해(Conceptual Understanding) 평가 중시."
    ),
    "elementary_4": (
        "초4: 구체적 조작기→형식적 조작기 과도기. 추상화 수준 급상승. "
        "단순 연산 숙달→수학적 문해력과 개념적 이해 강조. "
        "도형의 포함 관계, 각도 개념, 큰 수의 자릿값 이해가 핵심."
    ),
    "elementary_5": (
        "초5: 한국 수학교육의 가장 결정적 분수령, '수포자' 대거 발생 시기. "
        "자연수→유리수(분수, 소수) 본격 확장. "
        "구체적 조작기→형식적 조작기 이행 과도기(Critical Transition Period). "
        "산술적 사고→대수적 사고(Algebraic Thinking) 태동. "
        "2022 개정 핵심: 5대 핵심 역량(문제해결·추론·의사소통·연결·정보처리), "
        "정당화(Justification) 강화, 디지털 소양(알지오매스) 전면 배치. "
        "약수·배수·통분은 이후 모든 분수 연산의 토대. "
        "과정 중심 평가: 결과→사고 과정 추적, 서술형 강화."
    ),
    "elementary_6": (
        "초6: 초등 수학의 완성 + 중등 수학(대수, 기하)으로의 결정적 도약점. "
        "계산 숙달→'개념의 연결(Connection)'과 '수학적 모델링(Modeling)' 능력 함양. "
        "비와 비율은 중등 함수적 사고의 기초. "
        "2022 개정 핵심: 원주율 3.14 고정, '변화와 관계' 영역 신설, "
        "미지수는 □ 또는 '어떤 수' 사용(중등 방정식과 연결). "
        "'이해하고 설명하기', '추론하기'로 평가 주안점 이동."
    ),
    "middle_1": (
        "중1: 산술→대수 전환의 시작. 음수 도입, 문자와 식, 방정식. "
        "좌표평면과 비례 그래프로 함수 개념 첫 접근. "
        "기본 도형의 성질과 통계 기초."
    ),
    "middle_2": (
        "중2: 초등 직관→고등 형식적 수학의 교량. "
        "유리수 체계 완성, 대수적 유창성 확보, 논증 기하 시작. "
        "디지털 도구 활용 필수, 증명→정당화로 접근 장벽 완화."
    ),
    "middle_3": (
        "중3: 초·중등 수학의 완결점 + 고등 수학의 결정적 가교. "
        "유리수→실수 확장 완성. 이차식의 인수분해, 이차방정식, 이차함수가 대수의 정점. "
        "상자그림·산점도 신설/강화."
    ),
    "high_1": (
        "공통수학1(고1 1학기): 고교 수학 첫 관문, 고교학점제 공통 과목(4학점). "
        "디지털 대전환 시대의 '수학적 소양'과 '디지털 리터러시' 함양 목표. "
        "기하학적 직관→수식의 논리적 전개와 패턴 파악 중심 (순수 대수학+이산수학). "
        "2022 개정 핵심: 행렬 신설(AI/데이터 과학 기초, 비가환적 연산 체계), "
        "경우의 수 1학기 이동(이산수학적 사고 조기 정립), 도형의 방정식→공통수학2 이동. "
        "계산 복잡도 완화, 구조적 사고(Structural Thinking)와 정의의 엄밀성 강조. "
        "추론형 문항 위주로 평가 재편 예고."
    ),
    "high_2": (
        "공통수학2(고1 2학기): 미적분학으로 나아가는 징검다리, 공통수학1과 쌍대 구조. "
        "기하학적 조건의 대수적 번역(해석기하학) + 논리적 언어(집합·명제) + 함수적 변환 통합. "
        "2022 개정 핵심: 외분 삭제(계산 부담 완화), 도형의 방정식 수용(공통수학1에서 이동), "
        "코시-슈바르츠 비중 감소. 해석기하적 사고·논리적 엄밀성·전략적 선택 역량 강조. "
        "증가함수/감소함수에 따른 역함수 교점 패러독스, 무리함수 무연근 등 고난도 출제 소재 풍부."
    ),
}


# ─────────────────────────────────────────────
# 개념별 프롬프트 컨텍스트 (103개)
# ─────────────────────────────────────────────
PROMPT_CONTEXTS: dict[str, ConceptPromptContext] = {
    # ================================================================
    # 초등학교 3학년 (24개)
    # ================================================================
    # ━━ 1단원: 덧셈과 뺄셈 ━━
    "concept-e3-add-sub-01": {
        "core_concepts": (
            "• 세 자리 수 + 세 자리 수의 덧셈 (받아올림)\n"
            "• 각 자리의 합이 10 이상일 때 상위 자릿수로 1 올림\n"
            "• 연속 받아올림: 일→십→백의 자리 순차적 올림"
        ),
        "misconceptions": (
            "• 받아올림 누락: 십의 자리 합이 12인데 백의 자리로 1 안 올림\n"
            "• 자릿수 정렬 오류: 가로셈→세로셈 변환 시 왼쪽 정렬\n"
            "• 연속 받아올림 시 이전 올림 누락"
        ),
        "design_guidelines": (
            "• 받아올림이 일어나는 자리 모두 찾기 문항\n"
            "• 중간 계산 과정 빈칸으로 받아올림 표기 강제\n"
            "• 연속 받아올림 문제 출제"
        ),
        "key_summary": "각 자리 수의 합이 10 이상이면 윗자리로 1을 받아올림한다.",
    },
    "concept-e3-add-sub-02": {
        "core_concepts": (
            "• 세 자리 수 - 세 자리 수의 뺄셈 (받아내림/재구조화)\n"
            "• 상위 자리에서 1을 빌려 10으로 바꾸는 원리\n"
            "• 감산 방향성: 항상 위 수에서 아래 수를 빼야 함"
        ),
        "misconceptions": (
            "• 감산 방향성 오류: 423-157에서 일의 자리 3-7이 안 되니 7-3=4로 계산\n"
            "• 받아내림의 자릿값 오해: 십의 자리에서 빌려온 '1'이 10임을 모름\n"
            "• 연속 받아내림 시 중간 자리 갱신 누락"
        ),
        "design_guidelines": (
            "• 받아내림의 필요성 인식 문항 출제\n"
            "• 오류 찾기(Error Analysis) 유형 적극 활용\n"
            "• 받아내림 시 자릿값 의미 묻는 문항"
        ),
    },
    # ━━ 2단원: 평면도형 ━━
    "concept-e3-plane-01": {
        "core_concepts": (
            "• 선분: 두 점을 잇는 가장 짧은 선 (길이 유한)\n"
            "• 반직선: 한 점에서 시작해 한쪽으로 끝없이 뻗은 선 (시작점+방향)\n"
            "• 직선: 양쪽으로 끝없이 뻗은 선"
        ),
        "misconceptions": (
            "• 반직선 AB = 반직선 BA라고 착각 (시작점+방향 모두 같아야 동일)\n"
            "• 선분 AB = 선분 BA는 같지만 반직선은 다름을 혼동\n"
            "• 선분·반직선·직선의 유한/무한 구별 실패"
        ),
        "design_guidelines": (
            "• 반직선 AB와 BA를 구별하는 문항\n"
            "• 선분·반직선·직선의 정의를 구별하는 분류 문항\n"
            "• 그림에서 선분/반직선/직선 찾기"
        ),
    },
    "concept-e3-plane-02": {
        "core_concepts": (
            "• 각: 한 점(꼭짓점)에서 그은 두 반직선(변)으로 이루어진 도형\n"
            "• 직각: 종이를 반듯하게 두 번 접은 각 (90도)\n"
            "• 각의 크기는 변이 벌어진 정도로 결정 (변 길이 무관)"
        ),
        "misconceptions": (
            "• 직각의 방향성 고착: 기울어진 직각 못 찾음\n"
            "• 변 길이 = 각 크기 혼동: 변이 길면 각도 크다고 착각\n"
            "• 직각이 아닌 각도 직각으로 오인 (시각적 착각)"
        ),
        "design_guidelines": (
            "• 다양한 각도로 회전된 도형에서 직각 모두 찾기\n"
            "• 변의 길이는 다르지만 각의 크기는 같은 두 각 비교\n"
            "• 각의 정의를 정확히 서술하는 문항"
        ),
    },
    # ━━ 3단원: 나눗셈 ━━
    "concept-e3-div1-01": {
        "core_concepts": (
            "• 등분제: 전체를 똑같은 수의 묶음으로 나눌 때 한 묶음의 개수\n"
            "• 포함제: 전체를 한 묶음씩 덜어낼 때 묶음의 개수\n"
            "• 등분제와 포함제 모두 나눗셈으로 표현"
        ),
        "misconceptions": (
            "• 등분제/포함제 상황 구별 못함\n"
            "• 몫의 단위(개/묶음) 혼동\n"
            "• 문장제에서 나눗셈 상황 인식 실패"
        ),
        "design_guidelines": (
            "• 구체물 그림 제시→상황에 맞는 나눗셈식 고르기\n"
            "• 등분제와 포함제를 구별하는 문항\n"
            "• 실생활 맥락의 문장제"
        ),
    },
    "concept-e3-div1-02": {
        "core_concepts": (
            "• 곱셈과 나눗셈의 역연산 관계: 12÷3=4 ↔ 3×4=12\n"
            "• 하나의 곱셈식에서 나눗셈식 2개 유도 가능\n"
            "• 나눗셈은 교환법칙이 성립하지 않음"
        ),
        "misconceptions": (
            "• 교환법칙 적용 오류: 12÷4와 4÷12를 같다고 착각\n"
            "• 곱셈→나눗셈 변환 시 피제수/제수 혼동\n"
            "• 뺄셈/나눗셈에서 교환법칙 불성립 인식 부족"
        ),
        "design_guidelines": (
            "• 관계 짓기: 곱셈식 2개, 나눗셈식 2개 만들기\n"
            "• 교환법칙 성립/불성립 비교 문항\n"
            "• 나눗셈 검산으로 곱셈 활용"
        ),
    },
    # ━━ 4단원: 곱셈 ━━
    "concept-e3-mul1-01": {
        "core_concepts": (
            "• (몇십몇)×(몇) 계산 원리\n"
            "• 십의 자리와 일의 자리를 분리하여 각각 곱하기\n"
            "• 십의 자리 숫자의 자릿값(실제 값) 이해"
        ),
        "misconceptions": (
            "• 십의 자리 '4'를 '40'이 아닌 '4'로 계산\n"
            "• 자릿수 혼동으로 결과값 자릿수 오류\n"
            "• 각 자리 곱의 합산 시 자리 맞춤 실패"
        ),
        "design_guidelines": (
            "• (몇십몇)×(몇) 기본 계산 연습\n"
            "• 자릿값 의미를 확인하는 문항\n"
            "• 올바른 계산 과정 고르기"
        ),
    },
    "concept-e3-mul1-02": {
        "core_concepts": (
            "• 분배법칙의 기초: 23×4 = 20×4 + 3×4\n"
            "• 모눈종이(Area Model)로 분배법칙 시각화\n"
            "• 올림이 있는 곱셈 처리"
        ),
        "misconceptions": (
            "• 자릿수 혼동: 23×4에서 3×4=12, 2×4=8을 나열해 812로 표기\n"
            "• 분배법칙 적용 시 십의 자리 값을 자릿값 없이 계산\n"
            "• 올림 처리 누락"
        ),
        "design_guidelines": (
            "• 모눈종이(Area Model) 활용 문항\n"
            "• 20×4 영역과 3×4 영역 구분하여 합산\n"
            "• 분배법칙 과정 빈칸 채우기"
        ),
    },
    # ━━ 5단원: 길이와 시간 ━━
    "concept-e3-length-time-01": {
        "core_concepts": (
            "• 길이 단위: 10mm=1cm, 100cm=1m, 1000m=1km\n"
            "• 자 눈금 읽기: 시작 눈금≠0일 수 있음\n"
            "• 단위 간 변환 계산"
        ),
        "misconceptions": (
            "• 자 눈금 읽기: 항상 0에서 시작해야 한다고 착각 (부러진 자 문제)\n"
            "• 단위 변환 비율 혼동: cm→m가 100배인지 1000배인지 헷갈림\n"
            "• mm, cm, m, km 순서 혼동"
        ),
        "design_guidelines": (
            "• 부러진 자 문제: 0 눈금 없는 자에서 물체 길이 구하기\n"
            "• 단위 변환 연습 (mm↔cm, cm↔m, m↔km)\n"
            "• 실생활 물체의 적절한 단위 선택"
        ),
    },
    "concept-e3-length-time-02": {
        "core_concepts": (
            "• 시각과 시간(양) 구별\n"
            "• 60진법: 60분=1시간, 60초=1분\n"
            "• 시간의 덧셈과 뺄셈 (받아올림 기준 60)"
        ),
        "misconceptions": (
            "• 60진법과 10진법 충돌: 1시간 40분+30분=1시간 70분=1.7시간으로 계산\n"
            "• '시각'과 '시간'의 개념 혼동\n"
            "• 시간 뺄셈에서 받아내림 기준(60) 오류"
        ),
        "design_guidelines": (
            "• 시간 덧셈에서 받아올림 기준(60) 강조\n"
            "• 시각과 시간의 차이 구별 문항\n"
            "• 60진법 기반 계산 연습"
        ),
    },
    # ━━ 6단원: 분수와 소수 ━━
    "concept-e3-frac-dec-01": {
        "core_concepts": (
            "• 분수의 정의: 전체를 '똑같이' 나눈 것 중 일부\n"
            "• 단위분수: 분자가 1인 분수 (1/2, 1/3, 1/4, ...)\n"
            "• 단위분수 크기 비교: 분모가 작을수록 큼"
        ),
        "misconceptions": (
            "• '똑같이 나누기' 실패: 크기 다른 4조각 중 1개를 1/4이라 함\n"
            "• 단위분수의 역설: 1/3 > 1/2라고 착각 (3이 2보다 크니까)\n"
            "• 전체의 기준이 달라져도 분수가 같다고 오해"
        ),
        "design_guidelines": (
            "• 등분된 것과 안 된 것 섞어서 올바른 분수 그림 고르기\n"
            "• 단위분수의 크기 비교 (분모↑ → 크기↓)\n"
            "• 구체적 조작물로 분수 개념 확인"
        ),
    },
    "concept-e3-frac-dec-02": {
        "core_concepts": (
            "• 소수 도입: 1/10 = 0.1\n"
            "• 수직선 위 소수 위치: 0과 1 사이를 10등분\n"
            "• 분수와 소수의 관계: 1/10=0.1, 3/10=0.3"
        ),
        "misconceptions": (
            "• 소수 0.1의 실체성 부재: 0보다 작은 수로 오해\n"
            "• 소수점 읽기 오류: '0.3'을 '0과 3'으로 인식\n"
            "• 분수→소수 변환에서 분모가 10이 아닌 경우 혼란"
        ),
        "design_guidelines": (
            "• 수직선 위에서 0과 1 사이를 10칸으로 나누고 소수 위치 찍기\n"
            "• 분수↔소수 변환 연습 (분모 10인 경우)\n"
            "• 소수의 크기를 시각적으로 비교"
        ),
    },
    # ━━ 7단원: 곱셈 (2) ━━
    "concept-e3-mul2-01": {
        "core_concepts": (
            "• (세 자리 수)×(한 자리 수) 세로셈\n"
            "• 각 자리에서 올림 처리\n"
            "• 받아올림의 누적 처리"
        ),
        "misconceptions": (
            "• 자릿수 나열 오류: 3×4=12, 2×4=8을 나열해 812로 표기\n"
            "• 올림 처리 시 이전 올림값 합산 누락\n"
            "• 백의 자리 계산 후 올림 처리 실패"
        ),
        "design_guidelines": (
            "• 세로셈 과정에서 받아올림 표시 강제\n"
            "• 잘못된 계산 제시→오류 원인 찾기\n"
            "• 단계별 계산 과정 빈칸 채우기"
        ),
    },
    "concept-e3-mul2-02": {
        "core_concepts": (
            "• (두 자리 수)×(두 자리 수): 부분 곱 합산\n"
            "• 십의 자리 계산에서 0 쓰기 (자릿수 맞춤)\n"
            "• 초등 연산 중 가장 복잡한 알고리즘"
        ),
        "misconceptions": (
            "• 자릿수 맞춤 오류: 34×12에서 34×10=340인데 0 생략하고 34로 적음\n"
            "• 34×2+34×1로 잘못 계산 (자릿값 무시)\n"
            "• 부분 곱 합산 시 자리 정렬 오류"
        ),
        "design_guidelines": (
            "• 계산 과정에서 0을 쓰는 이유 묻기\n"
            "• 자릿수 개념 강화 문항\n"
            "• 올바른 계산 과정 고르기"
        ),
    },
    # ━━ 8단원: 나눗셈 (2) ━━
    "concept-e3-div2-01": {
        "core_concepts": (
            "• 나머지가 있는 나눗셈\n"
            "• 검산: A÷B=Q...R → A=B×Q+R\n"
            "• 나머지 < 나누는 수 (R < B) 조건"
        ),
        "misconceptions": (
            "• 나머지 크기 조건 위반: 14÷3=3...5라고 씀\n"
            "• 검산 과정 생략하여 오답 인지 못함\n"
            "• 나머지가 0인 경우 '나머지 없음'과 혼동"
        ),
        "design_guidelines": (
            "• 잘못된 계산 제시→나머지 성질로 틀린 이유 설명\n"
            "• 검산(B×Q+R=A) 연습 문항\n"
            "• 나머지 크기 조건 확인 문항"
        ),
    },
    "concept-e3-div2-02": {
        "core_concepts": (
            "• 나머지의 맥락적 해석\n"
            "• 올림 상황: 남은 것도 포함해야 할 때 (텐트 배정)\n"
            "• 버림 상황: 남은 것을 무시할 때 (사탕 나누기)"
        ),
        "misconceptions": (
            "• 문맥적 해석 실패: 올림 상황에서 몫만 답으로 씀\n"
            "• 버림 상황에서 올림 적용\n"
            "• 나머지의 의미를 문맥과 연결하지 못함"
        ),
        "design_guidelines": (
            "• 올림 상황 vs 버림 상황 구별 문항\n"
            "• 실생활 맥락에서 나머지 해석하기\n"
            "• 같은 나눗셈이지만 맥락에 따라 답이 다른 상황 비교"
        ),
    },
    # ━━ 9단원: 원 ━━
    "concept-e3-circle-01": {
        "core_concepts": (
            "• 원의 중심: 원 그릴 때 고정된 점\n"
            "• 반지름: 중심에서 원 위의 한 점까지 (한 원에서 모두 같음)\n"
            "• 지름: 원 위의 두 점을 잇는 선분 중 중심을 지나는 선분"
        ),
        "misconceptions": (
            "• 반지름 방향 가변성 오해: 위쪽/옆쪽 반지름 길이가 다르다고 착각\n"
            "• 지름 정의 오류: 원 내부를 지나는 아무 선분(현)을 지름이라 부름\n"
            "• 중심을 지나지 않는 선분도 지름이라고 착각"
        ),
        "design_guidelines": (
            "• 원 안에 여러 선분 그려놓고 지름인 것/아닌 것 분류\n"
            "• 기준: 원의 중심을 지나는가?\n"
            "• 반지름의 정의를 정확히 서술하는 문항"
        ),
    },
    "concept-e3-circle-02": {
        "core_concepts": (
            "• 지름 = 반지름 × 2\n"
            "• 반지름 = 지름 ÷ 2\n"
            "• 컴퍼스로 원 그리기: 컴퍼스 벌린 길이 = 반지름"
        ),
        "misconceptions": (
            "• 지름과 반지름의 관계(×2, ÷2) 혼동\n"
            "• 컴퍼스 벌린 길이를 지름으로 착각\n"
            "• 반지름이 주어졌는데 그대로 지름이라고 답함"
        ),
        "design_guidelines": (
            "• 반지름↔지름 변환 계산 문항\n"
            "• 컴퍼스 사용 원리와 반지름의 관계\n"
            "• 지름이 주어졌을 때 반지름 구하기"
        ),
    },
    # ━━ 10단원: 분수 (2) ━━
    "concept-e3-frac2-01": {
        "core_concepts": (
            "• 진분수: 분자 < 분모 (1보다 작음)\n"
            "• 가분수: 분자 ≥ 분모 (1 이상)\n"
            "• 대분수: 자연수 + 진분수 (예: 1과 2/5)\n"
            "• 가분수↔대분수 상호 변환"
        ),
        "misconceptions": (
            "• 대분수↔가분수 변환 오류\n"
            "• 가분수를 '잘못된 분수'로 오해\n"
            "• 진분수/가분수 분류 시 분자=분모인 경우 혼란"
        ),
        "design_guidelines": (
            "• 분수 분류 문항 (진분수/가분수/대분수)\n"
            "• 가분수↔대분수 변환 연습\n"
            "• 수직선 위에 분수 위치 표시"
        ),
    },
    "concept-e3-frac2-02": {
        "core_concepts": (
            "• 분모가 같은 분수의 크기 비교: 분자가 클수록 큼\n"
            "• 분모가 같은 분수의 덧셈과 뺄셈: 분모 그대로, 분자끼리 연산\n"
            "• 시각적 확인: 파이 차트에서 조각 수(분자)만 변화"
        ),
        "misconceptions": (
            "• 분모 덧셈 오류: 2/7+3/7=5/14 (분모와 분자 각각 더함)\n"
            "• 분수 뺄셈에서 분모까지 뺌\n"
            "• 계산 결과가 가분수가 되면 당황"
        ),
        "design_guidelines": (
            "• 파이 차트로 분수 덧셈 시각적 증명\n"
            "• 조각의 크기(분모)는 불변, 개수(분자)만 증가\n"
            "• 분모 덧셈 오류를 유도하는 함정 선지 포함"
        ),
    },
    # ━━ 11단원: 들이와 무게 ━━
    "concept-e3-vol-wt-01": {
        "core_concepts": (
            "• 들이 단위: L, mL (1L=1000mL)\n"
            "• 무게 단위: kg, g (1kg=1000g)\n"
            "• 단위 간 변환: ×1000, ÷1000"
        ),
        "misconceptions": (
            "• 단위 변환 오류: 1000 관계 혼동 (100인지 1000인지)\n"
            "• L↔mL, kg↔g 변환 방향 혼동\n"
            "• 들이와 무게 단위 자체를 혼동 (mL과 g)"
        ),
        "design_guidelines": (
            "• 단위 변환 문제 (L↔mL, kg↔g)\n"
            "• 실생활 물체의 적절한 단위 선택\n"
            "• 변환 계수 1000을 강조하는 문항"
        ),
    },
    "concept-e3-vol-wt-02": {
        "core_concepts": (
            "• 부피(크기)와 무게는 다른 물리량\n"
            "• 같은 단위끼리 들이·무게의 덧셈과 뺄셈\n"
            "• 밀도 차이: 큰 물체가 항상 무거운 것은 아님"
        ),
        "misconceptions": (
            "• 부피=무게 혼동: 부피가 크면 무조건 더 무겁다고 착각\n"
            "• 다른 단위끼리 직접 연산 (L+g 등)\n"
            "• 들이와 무게를 같은 물리량으로 취급"
        ),
        "design_guidelines": (
            "• 시각적 부피와 실제 무게가 상충하는 상황 제시\n"
            "• 같은 단위끼리만 연산 가능함을 강조\n"
            "• 스티로폼 vs 쇠구슬 같은 반례 활용"
        ),
    },
    # ━━ 12단원: 자료의 정리 ━━
    "concept-e3-data-01": {
        "core_concepts": (
            "• 자료 수집→분류→표 정리 과정\n"
            "• 표의 구성 요소: 항목, 수량, 합계\n"
            "• 표로 정리하면 한눈에 비교·파악 가능"
        ),
        "misconceptions": (
            "• 자료 분류 기준 불명확\n"
            "• 합계 계산 오류\n"
            "• 표의 목적(정리·비교)을 이해하지 못함"
        ),
        "design_guidelines": (
            "• 자료를 표로 정리하는 이유 묻기\n"
            "• 주어진 자료에서 표 완성하기\n"
            "• 표에서 정보 읽기 문항"
        ),
    },
    "concept-e3-data-02": {
        "core_concepts": (
            "• 그림그래프(Picture Graph): 그림으로 수량 표현\n"
            "• 범례: 그림 하나가 나타내는 수 (10, 100 등)\n"
            "• 큰 그림/작은 그림의 수량 차이"
        ),
        "misconceptions": (
            "• 상징의 수량화 실패: 큰 스마일=10명인데 그림 3개를 보고 3명이라 답함\n"
            "• 범례 무시하고 그림 개수만 셈\n"
            "• 큰 그림과 작은 그림의 범례 차이 혼동"
        ),
        "design_guidelines": (
            "• 범례 다양하게 변형 (큰 그림=100, 작은 그림=10)\n"
            "• 그림 개수 ≠ 실제 수량임을 계산하는 문제\n"
            "• 범례를 확인하고 값 계산하기"
        ),
    },

    # ================================================================
    # 초등학교 4학년 (24개)
    # ================================================================
    "concept-e4-big-num-01": {
        "core_concepts": (
            "• 10배의 원리 (자릿수가 왼쪽으로 한 칸→10배)\n"
            "• 4자리씩 끊어 읽기 (만, 억, 조)\n"
            "• 자릿값: 숫자가 놓인 위치에 따른 값"
        ),
        "misconceptions": (
            "• 0이 포함된 수에서 빈 자리 누락 (삼억 오천만→35000)\n"
            "• 자릿값과 숫자 자체 혼동 (50000에서 5의 값 ≠ 5)"
        ),
        "design_guidelines": (
            "• 연속된 0이 있는 수의 받아쓰기\n"
            "• 자릿값 묻는 문제 (숫자 vs 자릿값 구분)"
        ),
    },
    "concept-e4-big-num-02": {
        "core_concepts": (
            "• 수의 크기 비교: 자릿수→최상위 자릿수부터 비교\n"
            "• 10배, 100배 관계를 이용한 대소 판단\n"
            "• 큰 수의 양감 형성"
        ),
        "misconceptions": (
            "• 자릿수만 보고 크기 판단 (9억 vs 10억)\n"
            "• 큰 수의 양감 부족 (억과 조의 차이)"
        ),
        "design_guidelines": (
            "• 실생활 데이터(국가 예산, 인구) 연결\n"
            "• 여러 큰 수의 대소 비교 문제"
        ),
    },
    "concept-e4-angle-01": {
        "core_concepts": (
            "• 각의 크기 = 두 변이 벌어진 정도 (변의 길이와 무관)\n"
            "• 분류: 예각(0°~90°), 직각(90°), 둔각(90°~180°)\n"
            "• 각도기 사용법"
        ),
        "misconceptions": (
            "• 변이 길면 각도 크다고 착각\n"
            "• 각도기 안쪽/바깥쪽 눈금 혼동 (둔각을 60°로 읽음)"
        ),
        "design_guidelines": (
            "• 변의 길이는 다르나 각이 같은 도형 비교\n"
            "• 예각/둔각 분류 문제"
        ),
    },
    "concept-e4-angle-02": {
        "core_concepts": (
            "• 삼각형 내각의 합 = 180°\n"
            "• 사각형 내각의 합 = 360°\n"
            "• 두 각을 알면 나머지 각 계산"
        ),
        "misconceptions": (
            "• 삼각형 모양 달라지면 내각의 합도 변한다고 오해\n"
            "• 사각형 내각의 합을 180°로 착각"
        ),
        "design_guidelines": (
            "• 다양한 삼각형의 내각의 합 확인 문제\n"
            "• 나머지 각 구하기 문제"
        ),
    },
    "concept-e4-mul-div-01": {
        "core_concepts": (
            "• (세 자리 수)×(두 자리 수) 세로셈 알고리즘\n"
            "• 부분곱을 자릿수에 맞추어 더하기\n"
            "• 올림 처리"
        ),
        "misconceptions": (
            "• 곱셈 세로셈에서 자릿수 맞추기 오류\n"
            "• 부분곱 위치 혼동 (십의 자리 곱을 한 칸 왼쪽에 쓰지 않음)"
        ),
        "design_guidelines": (
            "• 세로셈 과정에서 오류 찾기\n"
            "• 어림하여 답의 범위 가늠하기"
        ),
    },
    "concept-e4-mul-div-02": {
        "core_concepts": (
            "• (세 자리 수)÷(두 자리 수): 가늠→곱하기→빼기→확인\n"
            "• 검산: 나누는 수 × 몫 + 나머지 = 나누어지는 수\n"
            "• 나머지의 맥락적 해석 (올림/버림)"
        ),
        "misconceptions": (
            "• 나눗셈 몫 가늠하기 어려움\n"
            "• 나머지의 맥락적 해석 실패 (올림/버림 판단)"
        ),
        "design_guidelines": (
            "• 몫의 범위 어림하기 문항\n"
            "• 실생활 문장제에서 나머지 처리 판단"
        ),
    },
    "concept-e4-transform-01": {
        "core_concepts": (
            "• 밀기(평행이동): 위치만 변화\n"
            "• 모양·크기·방향 불변\n"
            "• 밀기의 방향과 거리"
        ),
        "misconceptions": (
            "• 밀기에서 방향도 변한다고 착각\n"
            "• 밀기와 돌리기를 혼동"
        ),
        "design_guidelines": (
            "• 밀기 전후 도형 비교\n"
            "• 위치만 변하는 것 확인 문제"
        ),
    },
    "concept-e4-transform-02": {
        "core_concepts": (
            "• 뒤집기: 대칭축 기준 좌우/상하 반전\n"
            "• 돌리기: 중심점 기준 90°, 180°, 270° 회전\n"
            "• 시계 90° = 반시계 270°"
        ),
        "misconceptions": (
            "• 오른쪽 뒤집기↔시계방향 180° 돌리기 혼동\n"
            "• 시계/반시계 방향 혼동\n"
            "• 비대칭 도형에서 뒤집기와 돌리기 결과 착각"
        ),
        "design_guidelines": (
            "• 비대칭 도형(ㄱ, ㄴ, P 등) 활용 필수\n"
            "• 뒤집기+돌리기 복합 적용 문제"
        ),
    },
    "concept-e4-bar-graph-01": {
        "core_concepts": (
            "• 구성 요소: 가로축, 세로축, 눈금, 막대, 제목\n"
            "• 눈금 읽기와 값 파악\n"
            "• 항목 간 대소 비교, 중간값 어림"
        ),
        "misconceptions": (
            "• 눈금선 중간값 읽기 어려움\n"
            "• 막대그래프와 꺾은선그래프 구성 요소 혼동"
        ),
        "design_guidelines": (
            "• 눈금 중간값 어림하여 읽기\n"
            "• 구성 요소 식별 문제"
        ),
    },
    "concept-e4-bar-graph-02": {
        "core_concepts": (
            "• 적절한 눈금 한 칸의 크기 결정\n"
            "• 자료를 막대그래프로 나타내기\n"
            "• 눈금 크기에 따른 표현의 정확성"
        ),
        "misconceptions": (
            "• 눈금 한 칸을 무조건 1로 설정\n"
            "• 눈금 크기가 너무 크거나 작아 표현이 부적절"
        ),
        "design_guidelines": (
            "• 적절한 눈금 크기 결정하기\n"
            "• 다양한 눈금 크기로 같은 자료 비교"
        ),
    },
    "concept-e4-pattern-01": {
        "core_concepts": (
            "• 수 배열에서 덧셈/뺄셈 규칙 찾기\n"
            "• 곱셈 규칙 찾기 (등비 수열 기초)\n"
            "• 다음 수 예측하기"
        ),
        "misconceptions": (
            "• 표면적 패턴만 인식 (2,4,6...→+2로 단정, ×2 가능성 무시)\n"
            "• 차이가 일정하지 않으면 규칙이 없다고 판단"
        ),
        "design_guidelines": (
            "• 덧셈과 곱셈 규칙 구분 문제\n"
            "• 규칙을 말로 설명하기"
        ),
    },
    "concept-e4-pattern-02": {
        "core_concepts": (
            "• 도형 배열의 규칙 (삼각수, 사각수 등)\n"
            "• 계산식의 패턴 발견\n"
            "• 규칙을 수학적 언어로 표현"
        ),
        "misconceptions": (
            "• 도형 패턴을 수로 변환하지 못함\n"
            "• 복잡한 규칙(제곱수, 삼각수)을 인식하지 못함"
        ),
        "design_guidelines": (
            "• 삼각수, 제곱수 등 도형 기반 패턴\n"
            "• 복잡한 단계(10번째 도형의 개수) 문제"
        ),
    },
    "concept-e4-frac-op-01": {
        "core_concepts": (
            "• 분모가 같은 분수: 분모 그대로, 분자끼리 연산\n"
            "• 진분수의 덧셈과 뺄셈\n"
            "• 결과가 1 이상이면 대분수로 변환"
        ),
        "misconceptions": (
            "• 분모끼리 더하기: ⅓+⅓=2/6\n"
            "• 분자끼리 빼면서 분모도 바꿈"
        ),
        "design_guidelines": (
            "• 분모끼리 더하는 오류 선택지 포함\n"
            "• 파이, 막대 등 그림 모델과 식 연결"
        ),
    },
    "concept-e4-frac-op-02": {
        "core_concepts": (
            "• 대분수 덧셈: 자연수끼리+분수끼리 (또는 가분수로 변환)\n"
            "• 대분수 뺄셈 받아내림: 자연수에서 1 빌려와 가분수로 변환\n"
            "• 자연수 - 분수 계산"
        ),
        "misconceptions": (
            "• 자연수-분수 계산 오류 (3-⅖ 처리 못함)\n"
            "• 받아내림 시 분자에 10 더함 (분모만큼 더해야 함)"
        ),
        "design_guidelines": (
            "• 재그룹화 과정 시각화\n"
            "• 자연수에서 분수 빼기 문제"
        ),
    },
    "concept-e4-triangle-01": {
        "core_concepts": (
            "• 이등변삼각형: 두 변 같음, 두 밑각 같음\n"
            "• 정삼각형: 세 변 같음, 세 각 모두 60°\n"
            "• 포함 관계: 정삼각형 ⊂ 이등변삼각형"
        ),
        "misconceptions": (
            "• 회전된 이등변삼각형 인식 못함\n"
            "• 정삼각형은 이등변삼각형이 아니라고 오답"
        ),
        "design_guidelines": (
            "• 포함 관계 확인 문제\n"
            "• 다양한 방향의 도형 제시"
        ),
    },
    "concept-e4-triangle-02": {
        "core_concepts": (
            "• 예각삼각형: 세 각 모두 예각\n"
            "• 직각삼각형: 한 각이 90°\n"
            "• 둔각삼각형: 한 각이 둔각"
        ),
        "misconceptions": (
            "• 예각이 하나만 있어도 예각삼각형이라 착각\n"
            "• 둔각삼각형에 예각이 있으면 혼란"
        ),
        "design_guidelines": (
            "• 세 각이 주어진 삼각형 분류\n"
            "• 둔각삼각형에서 예각 찾기"
        ),
    },
    "concept-e4-dec-op-01": {
        "core_concepts": (
            "• 0.01, 0.001의 의미와 자릿값\n"
            "• 소수점 아래 같은 자리부터 크기 비교\n"
            "• 3.5 = 3.50 (0 채우기)"
        ),
        "misconceptions": (
            "• 소수가 길면 크다고 착각 (0.125 > 0.5 오류)\n"
            "• 3.5 ≠ 3.50으로 착각"
        ),
        "design_guidelines": (
            "• 자릿값 판(Place Value Chart) 활용\n"
            "• 자릿수가 다른 소수 크기 비교"
        ),
    },
    "concept-e4-dec-op-02": {
        "core_concepts": (
            "• 소수점 위치 맞추어 세로로 정렬\n"
            "• 빈 자리에 0 채워 자릿수 맞추기\n"
            "• 소수의 덧셈과 뺄셈 계산"
        ),
        "misconceptions": (
            "• 자릿수 정렬 오류 (2.5+12에서 5와 2를 더함)\n"
            "• 소수점 위치를 맞추지 않고 끝자리부터 계산"
        ),
        "design_guidelines": (
            "• 소수점 기준 정렬 강조\n"
            "• 자릿수가 다른 소수의 덧뺄셈"
        ),
    },
    "concept-e4-quad-01": {
        "core_concepts": (
            "• 수직: 두 직선이 만나 직각(90°) 형성\n"
            "• 평행: 두 직선이 만나지 않음\n"
            "• 수직과 평행의 기본 성질"
        ),
        "misconceptions": (
            "• 수직과 수평을 혼동\n"
            "• 평행선 사이 거리를 비스듬히 잼"
        ),
        "design_guidelines": (
            "• 수직/평행 관계 식별 문제\n"
            "• 사각형 내각의 합(360°) 활용"
        ),
    },
    "concept-e4-quad-02": {
        "core_concepts": (
            "• 분류: 사다리꼴→평행사변형→마름모/직사각형→정사각형\n"
            "• 포함 관계: 정사각형 ⊂ 직사각형 ⊂ 평행사변형\n"
            "• 각 사각형의 정의와 성질"
        ),
        "misconceptions": (
            "• 포함 관계 이해 부족: 정사각형은 직사각형인가?→예\n"
            "• 마름모를 다이아몬드 형태로만 인식"
        ),
        "design_guidelines": (
            "• 벤다이어그램으로 포함 관계 평가\n"
            "• 평행사변형을 모두 고르시오에 직사각형·정사각형 포함"
        ),
    },
    "concept-e4-line-graph-01": {
        "core_concepts": (
            "• 연속적 변량(시간에 따른 변화) 시각화\n"
            "• 선분 방향으로 증가/감소 판단\n"
            "• 기울기로 변화 크기 판단"
        ),
        "misconceptions": (
            "• 항목별 비교에도 꺾은선그래프 사용 (막대그래프가 적합)\n"
            "• 기울기의 의미를 '값이 크다'로 오해"
        ),
        "design_guidelines": (
            "• 자료 성격에 따른 그래프 선택 문제\n"
            "• 기울기로 변화량 비교하기"
        ),
    },
    "concept-e4-line-graph-02": {
        "core_concepts": (
            "• 적절한 그래프 유형 선택\n"
            "• 물결선: 불필요한 구간 생략\n"
            "• 꺾은선그래프 그리기"
        ),
        "misconceptions": (
            "• 물결선의 역할을 모름 (장식으로 오해)\n"
            "• 미래 예측 시 추세 반영 못함"
        ),
        "design_guidelines": (
            "• 물결선 역할 이해 문제\n"
            "• 추세 기반 합리적 추론"
        ),
    },
    "concept-e4-polygon-01": {
        "core_concepts": (
            "• 다각형: 선분으로만 둘러싸인 닫힌 도형\n"
            "• 대각선: 이웃하지 않는 두 꼭짓점 연결\n"
            "• 대각선 수 공식: n(n-3)/2"
        ),
        "misconceptions": (
            "• 곡선이 포함된 도형도 다각형으로 착각\n"
            "• 삼각형에 대각선이 없다는 사실 간과"
        ),
        "design_guidelines": (
            "• 다각형 정의 확인 문제\n"
            "• 대각선 수 구하기"
        ),
    },
    "concept-e4-polygon-02": {
        "core_concepts": (
            "• 정다각형: 변의 길이 모두 같음 + 각의 크기 모두 같음 (두 조건 필수)\n"
            "• 마름모는 변만 같으므로 정다각형 아님\n"
            "• 직사각형은 각만 같으므로 정다각형 아님"
        ),
        "misconceptions": (
            "• 변만 같으면 정다각형 (마름모 반례)\n"
            "• 각만 같으면 정다각형 (직사각형 반례)"
        ),
        "design_guidelines": (
            "• 마름모 제시 후 정다각형인가? 질문\n"
            "• 두 조건의 필요충분성 확인 문제"
        ),
    },

    # ================================================================
    # 초등학교 5학년 (24개)
    # ================================================================
    # ── 1학기 1단원: 자연수의 혼합 계산 ──
    "concept-e5-mixed-calc-01": {
        "core_concepts": (
            "• 연산의 위계성: ① 괄호 ( ) 가장 먼저 → ② 곱셈·나눗셈 → ③ 덧셈·뺄셈\n"
            "• 좌결합성: 동순위 연산은 왼쪽부터 처리 (72÷4×3=18×3=54)\n"
            "• 연산 순서는 임의가 아닌 사회적 약속(Convention)\n"
            "• 우선순위 규칙이 없으면 같은 식도 사람마다 다른 답 → 수학적 의사소통 불가"
        ),
        "misconceptions": (
            "• 선형적 계산 오류(가장 빈출): 위계 무시하고 왼→오 순서대로만 계산\n"
            "  (예: 10+5×2=15×2=30, 정답: 10+10=20)\n"
            "• 좌결합성 무시: 72÷4×3에서 4×3을 먼저 계산\n"
            "• 괄호 무용론: 괄호 있어도/없어도 같다고 생각"
        ),
        "design_guidelines": (
            "• 계산 순서 번호 매기기(가지치기 다이어그램) 의무화\n"
            "• 반례를 통한 정당화: 동일한 식, 순서 다르면 결과 달라지는 사례\n"
            "• 동순위 연산에서 좌결합성 확인 문항"
        ),
    },
    "concept-e5-mixed-calc-02": {
        "core_concepts": (
            "• 괄호의 역할: 연산 순서를 바꾸는 도구, 괄호 안을 가장 먼저 계산\n"
            "• 문장제 모델링: 실생활 상황을 하나의 통합된 식(One-line expression)으로 표현\n"
            "• 부분적 계산이 아닌 구조적 파악 → 정보처리 역량\n"
            "• 괄호 유무에 따른 결과 차이"
        ),
        "misconceptions": (
            "• 역연산 논리 결함: '어떤 수' 구할 때 연산 순서 거꾸로 뒤집기 혼란\n"
            "• 식 세우기와 계산 과정 분리 못함"
        ),
        "design_guidelines": (
            "• 괄호 위치만 바꿨을 때 결과 비교 문항\n"
            "• 오류 수정형: 잘못 계산된 식 → 오류 단계 찾아 바르게 고치기\n"
            "• 목표수 만들기: 숫자 카드(3,5,8,2)와 연산·괄호로 특정 값(24) 만들기\n"
            "• 실생활 문장→하나의 식으로 모델링"
        ),
    },
    # ── 1학기 2단원: 약수와 배수 ──
    "concept-e5-divisor-01": {
        "core_concepts": (
            "• 포함 관계와 상호 관계: 약수와 배수는 역(Inverse)의 관계\n"
            "  21=3×7에서 3,7은 21의 약수이고, 21은 3,7의 배수\n"
            "• 약수는 유한, 배수는 무한\n"
            "• 1은 모든 자연수의 약수, 자기 자신은 자신의 약수이자 배수\n"
            "• 약수 구하기 전략: 쌍 찾기(1×12, 2×6, 3×4)"
        ),
        "misconceptions": (
            "• 약수 누락: 1과 자기 자신 빠뜨림\n"
            "• 배수의 유한성 착각: 배수는 무한함을 모름\n"
            "• 약수·배수 관계의 언어적 표현 혼동: '~의 약수'와 '~의 배수' 방향"
        ),
        "design_guidelines": (
            "• 정의 기반 발문: '12를 나누어떨어지게 하는 수를 모두 찾으시오'\n"
            "• 직사각형 배열 모델: 바둑돌 12개를 배열하여 약수 발견\n"
            "• 약수 빠짐없이 구하기 (쌍 찾기 전략)"
        ),
    },
    "concept-e5-divisor-02": {
        "core_concepts": (
            "• 최대공약수(GCD): 공약수 중 가장 큰 수. '두 수의 공약수 = GCD의 약수'\n"
            "• 최소공배수(LCM): 공배수 중 가장 작은 수. '두 수의 공배수 = LCM의 배수'\n"
            "• 거꾸로 나눗셈법으로 GCD·LCM 구하기\n"
            "• 핵심 관계식: (두 수의 곱)=GCD×LCM"
        ),
        "misconceptions": (
            "• 최대공배수/최소공약수 오류: 존재하지 않는 개념을 구하려 함\n"
            "  (최소공약수=항상 1, 최대공배수=무한대)\n"
            "• 직관 오류: '최대'공약수가 두 수보다 크다고 착각\n"
            "• GCD와 LCM 혼동: 어떤 상황에 어떤 것을 쓰는지 구분 못 함"
        ),
        "design_guidelines": (
            "• 곱과 GCD만 알 때 LCM 구하기 (관계식 활용)\n"
            "• GCD 활용: 타일 붙이기(가장 큰 정사각형), 사탕 똑같이 나누기\n"
            "• LCM 활용: 버스 배차 간격(동시 출발), 톱니바퀴 맞물리기\n"
            "• '왜 최대공배수는 구할 수 없는지' 서술형 문항"
        ),
    },
    # ── 1학기 3단원: 규칙과 대응 ──
    "concept-e5-corresp-01": {
        "core_concepts": (
            "• 변수(Variable)의 도입: 변화하는 두 양을 ○, △, □ 등으로 표현\n"
            "  → 고정값이 아닌 다양한 수를 대입할 수 있는 변수 인식\n"
            "• 대응 관계의 일반화: '자전거 수 × 2 = 바퀴 수' → y=2x (정비례 함수의 전조)\n"
            "• 비례 관계(y=ax)와 차이 관계(y=x+a) 구별\n"
            "• '함수 상자' 모델: 입력→변환→출력"
        ),
        "misconceptions": (
            "• 세로적 관계 편향: 가로적 관계(Functional Relationship)보다\n"
            "  한 양의 변화 패턴(Recursive Pattern)에만 주목\n"
            "  (예: y가 3,6,9일 때 '3씩 커진다'만 답하고 'y는 x의 3배'를 못 도출)\n"
            "• 덧셈 규칙↔곱셈 규칙 혼동: y=x+3(차이 일정) vs y=3x(비율 일정)\n"
            "• 복합 규칙 오류: 책상 연결하기(2n+2)를 단순히 4n으로 오인"
        ),
        "design_guidelines": (
            "• 표에서 변화 패턴 찾기 (차이 일정? 비율 일정?)\n"
            "• 아주 큰 수(100번째) 질문 → 패턴 세기 불가 → 식 일반화 필요성 정당화\n"
            "• 실생활 비례/차이 관계 구분"
        ),
    },
    "concept-e5-corresp-02": {
        "core_concepts": (
            "• 대응 관계를 기호(○, △)를 사용한 식으로 표현\n"
            "• 식의 의미 해석: 기호를 사용한 식의 의미를 문장으로 설명\n"
            "• 주어진 식에서 규칙을 역으로 추론\n"
            "• 초6 비와 비율, 중1 정비례·반비례로 연결되는 기초"
        ),
        "misconceptions": (
            "• 기호 정의 부재: □,△가 뭔지 정의 안 하고 식만 씀\n"
            "• 복합 규칙 인식 실패: y=ax+b 형태 못 찾음\n"
            "• 표에서 한 줄만 보고 일반화"
        ),
        "design_guidelines": (
            "• 표의 일부 지워진 상태에서 규칙 유추→빈칸 채우기\n"
            "• 역방향 문제: 식을 만족하는 실생활 상황 만들기\n"
            "• 의사소통 역량: 대응 관계를 말, 표, 식으로 각각 나타내기"
        ),
    },
    # ── 1학기 4단원: 약분과 통분 ──
    "concept-e5-reduce-01": {
        "core_concepts": (
            "• 분수의 기본 성질: 분모·분자에 0이 아닌 같은 수를 곱하거나 나누어도 크기 불변\n"
            "• 약분: 공약수로 나눠 간단히 만들기\n"
            "• 기약분수: 분자와 분모의 GCD가 1인 분수 (더 이상 약분 불가)\n"
            "• 약분 불완전 방지: 최대공약수로 한 번에 약분하는 전략\n"
            "• 수학적 동치류(Equivalence Class)의 초등 수준 경험"
        ),
        "misconceptions": (
            "• 가법적 오류(Additive Error): 분모·분자에 같은 수를 '더하거나 빼도' 크기 같다고 착각\n"
            "  (예: 1/2 = (1+1)/(2+1) = 2/3 ← 틀림!)\n"
            "• 약분 불완전: 2로 한 번 나누고 멈춤 (기약분수까지 계속해야 함)\n"
            "• 기약분수 판별 실패: 더 약분 가능한데 멈춤"
        ),
        "design_guidelines": (
            "• 영역 모델(Area Model) 재분할: 종이접기로 전체 양 보존 증명\n"
            "• 기약분수 여부 판별 문제\n"
            "• 여러 단계 약분 과정 추적"
        ),
    },
    "concept-e5-reduce-02": {
        "core_concepts": (
            "• 통분: 이분모 분수의 크기 비교나 연산을 위해 공통된 단위(공통분모) 설정\n"
            "• 공통분모: 두 분모의 곱 vs 최소공배수(효율적)\n"
            "• 통분 후 분자 크기로 분수의 대소 비교\n"
            "• 2단원 약수·배수→4단원 약분·통분으로 연결되는 핵심 고리"
        ),
        "misconceptions": (
            "• 통분 시 분자 연산 누락(매우 빈출): 분모만 바꾸고 분자는 그대로\n"
            "  (예: 1/2 → 1/6 ← 분자에도 같은 수 곱해야)\n"
            "• 크기 비교 직관 오류: 분모·분자 숫자가 크면 큰 수라고 착각"
        ),
        "design_guidelines": (
            "• 통분 과정에서 분자 변환 확인 문항\n"
            "• 수직선 위에 분수 표시하여 크기 비교\n"
            "• 세 분수 이상의 크기 비교"
        ),
    },
    # ── 1학기 5단원: 분수의 덧셈과 뺄셈 ⭐ (핵심) ──
    "concept-e5-frac-add-01": {
        "core_concepts": (
            "• 핵심 원리: 분모가 다르면 '단위'가 다름 → 통분으로 단위 일치 후 연산\n"
            "• 알고리즘: 통분 → 분자끼리 연산 → 약분(기약분수)\n"
            "• 대분수의 연산: 자연수끼리·분수끼리 분리 계산 또는 가분수 변환\n"
            "• '사과 1개 + 배 1개 = 과일 2개는 되지만 사과 2개는 안 된다' 비유"
        ),
        "misconceptions": (
            "• 분모끼리/분자끼리 덧셈(전 세계 가장 보편적 오개념):\n"
            "  1/2+1/3=2/5 ← 분수를 양(Quantity)이 아닌 두 자연수의 쌍으로 인식\n"
            "• 단위의 통일성 무시: 서로 다른 단위(분모)에서 직접 덧셈 수행\n"
            "• 통분 후 분자 연산 누락"
        ),
        "design_guidelines": (
            "• 피자 조각/수직선 모델로 2/5가 1/2보다 작음을 시각적 증명\n"
            "• 오류 찾기(Error Correction) 문항: 틀린 풀이→오류 단계 지적\n"
            "• '단위 통일' 비유 활용 문항"
        ),
    },
    "concept-e5-frac-add-02": {
        "core_concepts": (
            "• 받아올림: 분수끼리의 합이 가분수가 되면 자연수 부분으로 올림\n"
            "• 받아내림: 분수끼리 뺄 수 없으면 자연수에서 1을 빌려옴\n"
            "  → 빌려온 1 = 분모/분모 (분모만큼 더해야 함)\n"
            "• 빌린 1은 분모와 같은 분자로 변환 (예: 분모가 5이면 5/5)"
        ),
        "misconceptions": (
            "• 받아내림 시 십진법 혼동(매우 빈출): 자연수에서 빌려온 1을 분자에 10으로 더함\n"
            "  (정답: 분모만큼 더해야 함. 분모가 5이면 5/5를 더함)\n"
            "• 가분수/대분수 변환 미처리: 답을 대분수로 안 고침\n"
            "• 대분수를 가분수로 바꾸지 않고 부분별 연산 오류"
        ),
        "design_guidelines": (
            "• 받아내림이 필요한 경우와 아닌 경우 구분\n"
            "• 자연수-대분수 뺄셈 (예: 3-1(2/3))\n"
            "• 받아내림 과정을 단계별로 서술하는 문항\n"
            "• 틀린 계산 과정 제시 → 오류 찾기"
        ),
    },
    # ── 1학기 6단원: 다각형의 둘레와 넓이 ──
    "concept-e5-poly-area-01": {
        "core_concepts": (
            "• 등적 변형: 도형을 잘라 붙여 모양은 다르지만 넓이가 같은 도형으로 만듦\n"
            "  (평행사변형 → 직사각형)\n"
            "• 배적 변형: 도형을 복사하여 2배로 만든 뒤 넓이 구하고 ÷2\n"
            "  (삼각형, 사다리꼴)\n"
            "• 공식 체계:\n"
            "  평행사변형: 밑변×높이 / 삼각형: 밑변×높이÷2\n"
            "• 높이=밑변에 수직인 거리 (빗변이 아님)"
        ),
        "misconceptions": (
            "• ÷2 누락(가장 빈출): 삼각형, 마름모, 사다리꼴에서 마지막 ÷2 잊음\n"
            "  → 공식 유도 과정(배적 변형) 잊고 결과만 암기했을 때 발생\n"
            "• 높이 오인: 평행사변형·삼각형에서 '높이'를 빗변 길이로 착각\n"
            "  → 높이 = 밑변과 수직인 거리"
        ),
        "design_guidelines": (
            "• '삼각형 넓이 공식을 평행사변형으로 설명하시오' 서술형\n"
            "• 밑변·빗변만 주고 높이 안 주는 함정 문제\n"
            "• 등적 변형 과정 서술 문항\n"
            "• 카발리에리의 원리: 밑변·높이 같은 여러 삼각형 → 넓이 같음"
        ),
    },
    "concept-e5-poly-area-02": {
        "core_concepts": (
            "• 사다리꼴: (윗변+아랫변)×높이÷2 (뒤집어 붙여 평행사변형→÷2)\n"
            "• 마름모: 한 대각선×다른 대각선÷2 (대각선 잘라 직사각형→÷2)\n"
            "• 둘레↔넓이 독립성: 둘레가 같아도 넓이는 다를 수 있음\n"
            "• 단위넓이: 1cm², 1m² = 단위 정사각형의 개수"
        ),
        "misconceptions": (
            "• ÷2 누락: 사다리꼴, 마름모 넓이\n"
            "• 직사각형 편향: 모든 사각형을 가로×세로로 계산\n"
            "• 둘레 길면 넓이도 크다는 직관적 오류"
        ),
        "design_guidelines": (
            "• 사다리꼴 넓이 공식 유도 과정 문항\n"
            "• 둘레와 넓이 비교 문항\n"
            "• 공학 도구(알지오매스): 평행사변형 밑변 고정 후 윗변 밀기(Shear)→넓이 일정 확인"
        ),
    },
    # ── 2학기 1단원: 수의 범위와 어림하기 ──
    "concept-e5-range-01": {
        "core_concepts": (
            "• 이상(≥), 이하(≤): 기준수 포함 (수직선에서 ●)\n"
            "• 초과(>), 미만(<): 기준수 미포함 (수직선에서 ○)\n"
            "• 수직선에 구간 시각화 (꽉 찬 점/빈 점)\n"
            "• 범위에 속하는 자연수/정수 세기\n"
            "• 중고등학교 부등식 영역의 기초"
        ),
        "misconceptions": (
            "• 경계값 포함 여부 혼동: '50 이상'에 50이 포함되는지\n"
            "• 이상/초과, 이하/미만 용어 혼동\n"
            "• '이상'과 '초과', '이하'와 '미만'을 동일시"
        ),
        "design_guidelines": (
            "• 수직선에 범위 정확히 작도 (●/○ 구분)\n"
            "• 경계값 포함/미포함 판단 문항\n"
            "• 실생활 데이터(인구, 물건 가격)로 범위 표현"
        ),
    },
    "concept-e5-round-01": {
        "core_concepts": (
            "• 올림: 부족하면 안 되는 상황 (텐트 개수, 화물차 대수)\n"
            "• 버림: 넘치면 안 되는 상황 (구매 가능 개수, 엘리베이터 정원)\n"
            "• 반올림: 가장 가까운 근삿값 (0~4 버림, 5~9 올림)\n"
            "• 연속적인 양(Continuous Quantity)을 다루기 위한 근삿값 개념"
        ),
        "misconceptions": (
            "• 자릿수 표현 언어 혼동(가장 빈출):\n"
            "  '십의 자리에서 반올림' → 십의 자리 숫자 보고 판단 → 백의 자리까지 나타냄\n"
            "  '십의 자리까지 나타내시오' → 일의 자리에서 반올림\n"
            "• 반올림 시 하위 자리부터 연속적으로 올리는 오류\n"
            "• 올림/버림/반올림 상황 판단 실패"
        ),
        "design_guidelines": (
            "• 상황 판단: 올림/버림/반올림 중 적절한 것 선택\n"
            "• '~에서 반올림'과 '~까지 나타내시오' 구분 문항\n"
            "• 실생활 데이터로 어림의 필요성과 오차 허용 범위 토론"
        ),
    },
    # ── 2학기 2단원: 분수의 곱셈 ──
    "concept-e5-frac-mul-01": {
        "core_concepts": (
            "• (자연수)×(분수): 동수누가 개념으로 설명 (6×1/3 = 6을 3등분한 것 중 1)\n"
            "• 연산자의 의미 확장: 분수를 곱하는 것 = 대상을 축소(Scaling down)\n"
            "• (분수)×(자연수): 분자에 자연수를 곱함\n"
            "• 진분수×자연수→결과는 원래 자연수보다 작음 (축소 변환)\n"
            "• 덧셈적 사고→승법적 사고(Multiplicative Thinking) 전환점"
        ),
        "misconceptions": (
            "• '곱하면 무조건 커진다': 자연수 곱셈의 직관에 갇혀\n"
            "  진분수 곱셈 결과가 작아지는 것 불신\n"
            "• 분모에도 자연수를 곱하는 오류"
        ),
        "design_guidelines": (
            "• 넓이 모델로 1/2×1/2=1/4 시각적 증명\n"
            "• 분수×자연수의 의미를 그림으로 표현\n"
            "• 진분수 곱셈의 축소 효과 확인"
        ),
    },
    "concept-e5-frac-mul-02": {
        "core_concepts": (
            "• 분수×분수: 분자끼리 곱, 분모끼리 곱 (통분 불필요)\n"
            "• 면적 모델(Area Model): 가로·세로를 분할하고 겹치는 부분 = 결과\n"
            "• 대분수 곱셈: 반드시 가분수로 변환 후 계산\n"
            "• 약분의 효율성: 대각선 방향으로 미리 약분"
        ),
        "misconceptions": (
            "• 대분수 곱셈 오류(매우 빈출): 1(1/2)×1(1/2)에서 자연수끼리·분수끼리 따로 곱함\n"
            "  → 오답: 1(1/4), 정답: 3/2×3/2=9/4=2(1/4)\n"
            "  (덧셈/뺄셈 습관이 곱셈으로 전이되는 현상)\n"
            "• 곱셈에서도 통분이 필요하다고 착각"
        ),
        "design_guidelines": (
            "• 면적 모델로 진분수×진분수 시각화\n"
            "• 대분수 곱셈→가분수 변환 필수 강조\n"
            "• 분배법칙 전개와 가분수 변환 비교: 효율성 정당화"
        ),
    },
    # ── 2학기 3단원: 합동과 대칭 ──
    "concept-e5-congru-01": {
        "core_concepts": (
            "• 합동: 모양과 크기가 같아 완전히 포개어지는 도형\n"
            "• 대응점·대응변·대응각: 합동 도형에서 겹치는 요소 (길이·크기 같음)\n"
            "• 뒤집거나 회전해도 합동 관계 유지\n"
            "• 도형의 이동(Rigid Motion) 기반 탐구 → 중1 삼각형 합동 조건(SSS,SAS,ASA) 기초"
        ),
        "misconceptions": (
            "• 방향에 따른 합동 인지 오류: 뒤집히거나 회전된 도형을 합동 아니라고 착각\n"
            "• 모양만 같으면 합동이라고 오해 (크기도 같아야 함)"
        ),
        "design_guidelines": (
            "• 회전·뒤집기된 도형에서 대응 요소 찾기\n"
            "• 합동과 닮음 구분 문항"
        ),
    },
    "concept-e5-congru-02": {
        "core_concepts": (
            "• 선대칭도형: 대칭축을 따라 접으면 완전히 겹침\n"
            "  → 대응점끼리 이은 선분이 대칭축과 수직, 대칭축까지 거리 같음\n"
            "• 점대칭도형: 대칭의 중심 기준 180° 돌리면 겹침\n"
            "  → 대응점끼리 이은 선분이 대칭 중심을 지나고 중심까지 거리 같음\n"
            "• 도형별 대칭 유형: 정사각형(선+점), 평행사변형(점만), 마름모(선+점)"
        ),
        "misconceptions": (
            "• 평행사변형 대칭축 오류(가장 빈출): 대각선을 대칭축으로 착각 (선대칭 아님!)\n"
            "• 직사각형 대칭축=대각선(×), 각 변의 중점 연결이 대칭축(○)\n"
            "• 점대칭 작도 오류: 대응점을 대칭 중심 통과 반대편 같은 거리에 정확히 안 찍음"
        ),
        "design_guidelines": (
            "• '선대칭도형의 대칭축을 잘못 그린 것을 모두 고르시오' (평행사변형 함정)\n"
            "• 도형 일부만 주고 대칭 성질로 완성하기\n"
            "• 공학 도구(알지오매스): 도형 회전·뒤집기 시뮬레이션으로 불변량/가변량 탐구"
        ),
    },
    # ── 2학기 4단원: 소수의 곱셈 ──
    "concept-e5-dec-mul-01": {
        "core_concepts": (
            "• 소수점 이동 원리: 곱하는 수가 1/10배 → 결과의 소수점 왼쪽으로 이동\n"
            "• (소수)×(자연수): 자연수처럼 계산 후 소수점 찍기\n"
            "• 소수를 분수로 고쳐서 계산하면 소수점 위치의 원리 설명 가능\n"
            "• 어림(Estimation)으로 결과 범위 예측 후 검증"
        ),
        "misconceptions": (
            "• 소수점 위치 오류: 1.2×3=0.36 (자릿수 잘못 계산)\n"
            "• 어림 부재: 계산 결과의 타당성 미확인"
        ),
        "design_guidelines": (
            "• 계산 전 어림(Estimation)으로 결과 범위 예측 습관화\n"
            "• 소수×자연수 기본 계산 문항\n"
            "• 소수→분수 변환으로 원리 확인"
        ),
    },
    "concept-e5-dec-mul-02": {
        "core_concepts": (
            "• (소수)×(소수): 두 수의 소수점 아래 자릿수의 합만큼 소수점 찍기\n"
            "• 계산 알고리즘: 자연수처럼 계산 후, 두 수의 소수점 아래 자릿수 합만큼 소수점 찍기\n"
            "• 0 처리 주의: 0.5×0.4=0.20=0.2, 0.2×0.3=0.06 (앞에 0 추가)\n"
            "• 1/10×1/10=1/100 원리로 이해"
        ),
        "misconceptions": (
            "• 소수점 위치 오류(0 처리): 0.5×0.4에서\n"
            "  0을 먼저 지우고 소수점 찍으면 0.02 오류\n"
            "  → '소수점 먼저 찍고, 그 뒤에 맨 끝 0 지우기' 순서 명확히\n"
            "• 어림 부재: 4.1×5.2≈20인데 213.2나 2.132라 답하고 이상함 못 느낌"
        ),
        "design_guidelines": (
            "• 소수점 위치 확인 문제 (0 처리 포함)\n"
            "• 어림과 정확한 계산 비교\n"
            "• 소수→분수 변환으로 원리 확인"
        ),
    },
    # ── 2학기 5단원: 직육면체 ──
    "concept-e5-cuboid-01": {
        "core_concepts": (
            "• 직육면체: 직사각형 6개로 둘러싸인 도형 (면 6, 모서리 12, 꼭짓점 8)\n"
            "• 정육면체: 정사각형 6개로 둘러싸인 도형 (직육면체의 특수한 경우)\n"
            "• 면, 모서리, 꼭짓점의 관계: 오일러 공식(V-E+F=2)의 기초\n"
            "• 면의 관계: 마주 보는 면(평행, 합동), 만나는 면(수직)"
        ),
        "misconceptions": (
            "• 밑면 고정 관념: '밑에 있는 면'만 밑면이라 생각\n"
            "  → 마주 보는 어떤 쌍이든 밑면 가능, 그에 따라 옆면 결정\n"
            "• 면·모서리·꼭짓점 수 혼동"
        ),
        "design_guidelines": (
            "• 구성 요소 수 묻기 (면/모서리/꼭짓점)\n"
            "• 평행/수직 관계 판별\n"
            "• 입체도형을 평면으로 표현하고 다시 구성하는 공간 시각화 능력 배양"
        ),
    },
    "concept-e5-cuboid-02": {
        "core_concepts": (
            "• 겨냥도: 보이지 않는 모서리=점선, 보이는 면 3개·안 보이는 면 3개\n"
            "• 전개도의 다양성: 정육면체의 전개도 = 11가지\n"
            "• 서로 마주 보는 면(평행)과 수직인 면의 관계 파악\n"
            "• 전개도 접기: 마주 보는 면 찾기, 모서리 연결 관계"
        ),
        "misconceptions": (
            "• 전개도는 하나뿐이라고 착각\n"
            "• 전개도 접기 실패: 멀리 떨어진 선분이 접으면 만나는지 파악 못함\n"
            "• 전개도가 될 수 없는 모양 구별 실패\n"
            "• 겨냥도 그리기 서툶: 점선 규칙 미준수"
        ),
        "design_guidelines": (
            "• 전개도에 무늬 그려놓고→접었을 때 올바른 겨냥도 고르기\n"
            "• 주사위 전개도: 마주 보는 면(한 칸 건너) 찾기\n"
            "• 디지털 도구(알지오매스): '전개도 접기' 기능으로 즉각적 시각적 피드백"
        ),
    },
    # ── 2학기 6단원: 평균과 가능성 ──
    "concept-e5-avg-01": {
        "core_concepts": (
            "• 계산적 정의: 자료의 값을 모두 더해 자료의 수로 나눔\n"
            "• 개념적 의미(Leveling out): 자료를 평평하게 고르는 것\n"
            "  → '튀어나온 곳 깎고 부족한 곳 채우는' 평탄화 개념\n"
            "• 블록 모델: 들쑥날쑥한 높이의 블록을 평평하게 맞추기\n"
            "• 0도 자료에 포함, 극단값이 평균에 미치는 영향"
        ),
        "misconceptions": (
            "• 평균의 대표성 오해: 평균 80점이면 모든 과목 80점 근처라 착각\n"
            "  → 극단값(0점)이 평균에 미치는 영향 이해 필요\n"
            "• 0의 처리: 0점인 과목도 자료의 수(나누는 수)에 포함해야 함\n"
            "• 평균값이 자료 집단 내에 반드시 존재해야 한다고 착각\n"
            "  (예: 가구당 자녀 수 2.5명)"
        ),
        "design_guidelines": (
            "• 극단값이 평균에 미치는 영향 문제\n"
            "• 0이 포함된 자료의 평균 계산\n"
            "• 평균이 실생활에서 오용될 수 있는 상황 서술 (예: 평균 연봉의 함정)"
        ),
    },
    "concept-e5-avg-02": {
        "core_concepts": (
            "• 사건이 일어날 가능성을 5단계 척도로 수치화:\n"
            "  불가능하다(0) - 아닐 것 같다 - 반반이다(1/2) - 일 것 같다 - 확실하다(1)\n"
            "• 경우의 수 세기→가능성을 분수로 표현\n"
            "• 고등학교 확률과 통계의 기초"
        ),
        "misconceptions": (
            "• 가능성의 주관적 해석: 수학적 확률이 아닌 개인적인 믿음이나 운으로 판단\n"
            "• 0과 1 사이의 수치 대응 거부\n"
            "• 경우의 수를 빠뜨리거나 중복 세기"
        ),
        "design_guidelines": (
            "• 회전판 돌리기 등 실험적 활동→가능성의 수치화\n"
            "• 가능성을 수치(0, 1/2, 1, 2/3 등)로 표현\n"
            "• 상황별 가능성 판단 문항"
        ),
    },

    # ================================================================
    # 초등학교 6학년 (12개)
    # ================================================================
    "concept-e6-frac-div1": {
        "core_concepts": (
            "• 나눗셈의 몫을 분수로: a÷b=a/b (등분할 상황)\n"
            "• (분수)÷(자연수): a/b÷c = a/b×1/c\n"
            "• 분자가 자연수 배수인 경우(분자끼리 나눗셈) vs 아닌 경우(×1/n 변환)\n"
            "• 나눗셈 기호(÷)와 분수 막대의 동일한 의미\n"
            "• 나누는 수가 정수일 때 곱하기 역수(×1/n)로 바뀌는 원리: 넓이 모델로 설명"
        ),
        "misconceptions": (
            "• '나눗셈 하면 숫자가 작아진다' (자연수 경험칙에 갇힘)\n"
            "• 교환법칙 오류: 작은 수÷큰 수에서 순서 뒤바꿈 (3L를 4명→4÷3)\n"
            "• 분모와 자연수를 곱해야 하는데 분자와 곱하는 역방향 오류"
        ),
        "design_guidelines": (
            "• 숫자 크기만 보고 식 세우면 틀리는 문항 (예: 2m÷5=2/5m)\n"
            "• '2L를 3명이 나눔' vs '2L는 3L의 몇 배?' 상황 구분 문항\n"
            "• 넓이 모델(직사각형)로 원리 설명하기\n"
            "• 수행평가형: 주어진 식을 그림으로 표현하고 서술"
        ),
    },
    "concept-e6-prism-pyramid": {
        "core_concepts": (
            "• 분류 기준: 밑면의 모양(삼각형, 사각형...)에 따라 이름 결정\n"
            "• 각기둥: 두 밑면이 합동이고 평행, 옆면이 모두 직사각형\n"
            "• 각뿔: 밑면이 다각형, 옆면이 모두 삼각형, 뿔 꼭짓점 1개\n"
            "• 각기둥 높이: 두 밑면 사이의 거리\n"
            "• 각뿔 높이: 꼭짓점에서 밑면에 내린 수선의 길이\n"
            "• n각기둥: 면 n+2, 모서리 3n, 꼭짓점 2n\n"
            "• n각뿔: 면 n+1, 모서리 2n, 꼭짓점 n+1"
        ),
        "misconceptions": (
            "• '밑면=바닥에 있는 면' (가장 빈출! 눕힌 기둥에서 밑면 찾기 실패)\n"
            "• 각뿔의 높이(수직 거리)↔옆 모서리(모선) 길이 혼동\n"
            "• 오일러 공식 단순 암기만 하고 직접 세지 못함"
        ),
        "design_guidelines": (
            "• 옆으로 누운 삼각기둥에서 밑면/높이 찾기\n"
            "• 전개도를 접었을 때 맞닿는 선분이나 점 찾기 (공간지각력)\n"
            "• 조건(모서리의 합이 36cm인 정사각기둥 등)을 주고 도형 유추하기"
        ),
    },
    "concept-e6-dec-div1": {
        "core_concepts": (
            "• 자연수 나눗셈과의 연결: 246÷2=123 → 24.6÷2=12.3\n"
            "• 자릿수 원리: 나누어지는 수가 1/10배 되면 몫도 1/10배\n"
            "• 몫의 소수점 위치: 피제수의 소수점 위치를 그대로 올려 찍기\n"
            "• 몫이 1보다 작은 경우(0.xxx), 소수점 위치 맞추기"
        ),
        "misconceptions": (
            "• 몫의 중간 0 누락 (가장 치명적): 6.12÷3=2.4 (정답: 2.04)\n"
            "• 나머지 소수점 오류: 13.4÷4에서 나머지를 14나 1로 표기\n"
            "  (나머지의 소수점은 이동 전 원래 피제수 위치 따름)"
        ),
        "design_guidelines": (
            "• 몫의 중간에 0이 들어가는 문항 필수 (6.12÷3, 8.32÷4)\n"
            "• 자릿값 개념 테스트\n"
            "• '철사 2.5m를 5명에게 나눌 때' 등 단위 포함 문장제"
        ),
    },
    "concept-e6-ratio": {
        "core_concepts": (
            "• 비의 구조: a:b에서 a=비교하는 양, b=기준량 (기호 ':'의 오른쪽이 기준)\n"
            "• 읽기: 'a 대 b', 'a의 b에 대한 비', 'b에 대한 a의 비'\n"
            "• 비율: 기준량을 1로 볼 때의 비교하는 양 크기 (a/b 또는 소수)\n"
            "• 백분율: 기준량을 100으로 할 때의 비율\n"
            "• 실생활 비율: 타율, 속력, 인구 밀도, 진하기(농도) 등"
        ),
        "misconceptions": (
            "• 기준량 찾기 실패: '~에 대한'이 붙은 대상이 기준량(b)임을 모름\n"
            "• 농도 분모 오류: 소금물 농도=소금/(소금+물)인데 분모를 '물'로 잡음\n"
            "• 문장 어순과 비의 순서 혼동\n"
            "• 비율과 비의 개념 혼동"
        ),
        "design_guidelines": (
            "• 문장 어순과 비 순서가 반대인 문제\n"
            "• 소금물 농도 함정 (물 100g+소금 25g→진하기? 오답 25%, 정답 20%)\n"
            "• 기준량 변화에 따른 비율의 의미 해석에 집중하는 문항\n"
            "• 단순 계산보다 '왜 이 비율인가?' 설명 요구"
        ),
    },
    "concept-e6-graphs": {
        "core_concepts": (
            "• 비율 그래프(띠그래프, 원그래프): 전체에 대한 각 부분의 비율(백분율) 시각화\n"
            "• 작도 순서: 각 항목 백분율 구하기→합계(100%) 확인→구획 나누기\n"
            "• 원그래프 중심각 변환: 중심각 = 360° × (비율)\n"
            "• 비율과 실제 양 구분: 전체가 다르면 비율이 커도 양은 적을 수 있음\n"
            "• 데이터 특성에 따른 그래프 유형 선택 능력"
        ),
        "misconceptions": (
            "• 원그래프 중심각 오류: 30%를 30°로 착각 (정답: 360°×0.3=108°)\n"
            "• 백분율 합계 불일치 당황 (반올림으로 99% 또는 101%)\n"
            "• 비율과 실제 양 혼동: 비율이 크면 양도 크다고 착각\n"
            "• 전체가 다른 두 그래프 비교 시 오류"
        ),
        "design_guidelines": (
            "• 비율→중심각 변환 식 세우기\n"
            "• 합계가 100%가 되지 않을 때 조정하는 통계적 약속 이해\n"
            "• 자료 일부가 가려진 그래프 해석\n"
            "• 전체가 다른 두 그래프 비교 문제"
        ),
    },
    "concept-e6-volume": {
        "core_concepts": (
            "• 부피: 단위 부피(1cm³)가 몇 개 들어가는가 (쌓기나무 개수)\n"
            "• 부피 공식 유도: V = 밑면의 넓이 × 높이 = 가로 × 세로 × 높이\n"
            "• 겉넓이: 전개도 상의 6개 면의 넓이 합 (밑넓이×2 + 옆넓이)\n"
            "• 단위: 1cm³, 1m³의 양감\n"
            "• 부피와 겉넓이는 독립적인 값"
        ),
        "misconceptions": (
            "• '부피가 커지면 겉넓이도 항상 커진다' (반례: 납작한 모양 vs 정육면체)\n"
            "• '부피 같으면 겉넓이도 같다' (쌓기나무 개수 동일, 겉넓이 다른 반례)\n"
            "• 단위 변환 실수: 1m³=100cm³로 착각 (정답: 1,000,000cm³)"
        ),
        "design_guidelines": (
            "• 쌓기나무로 부피 세기\n"
            "• 부피는 같지만 겉넓이가 다른 두 입체 비교\n"
            "• 겉넓이가 주어지고 모서리 길이 구하기\n"
            "• 단위 변환(1m³=1,000,000cm³) 시각화 문제"
        ),
    },
    "concept-e6-frac-div2": {
        "core_concepts": (
            "• 통분 이용법: 분모 같게 만들면 분자끼리 나눗셈 (a/m ÷ b/m = a÷b)\n"
            "• 알고리즘 형식화: a/b ÷ c/d = a/b × d/c (나눗셈→곱셈, 역수)\n"
            "• 역수: a/b의 역수는 b/a (두 수의 곱이 1)\n"
            "• 번분수 또는 통분 과정을 통해 역수 곱셈 원리 유도\n"
            "• 나누는 수가 1보다 작으면 몫이 처음 수보다 커짐"
        ),
        "misconceptions": (
            "• 대분수 처리 미숙: 대분수 상태에서 바로 역수 취함 (반드시 가분수로 변환 후 계산)\n"
            "• 앞의 수(피제수) 역수 취하기: 나누어지는 수를 뒤집는 오류\n"
            "• 나누는 수가 1보다 작을 때 몫이 커지는 것 이해 못함"
        ),
        "design_guidelines": (
            "• 대분수÷대분수 문제 (가분수 변환 필수)\n"
            "• 오류가 있는 계산 과정 제시→틀린 이유 서술하기\n"
            "• 역수를 곱하는 이유를 그림으로 설명하시오 (과정 중심 평가)\n"
            "• 계산 과정 빈칸 채우기 (서술형)"
        ),
    },
    "concept-e6-dec-div2": {
        "core_concepts": (
            "• 소수점 이동의 동치성: 나누는 수를 자연수로 만들기 위해 양쪽 소수점 이동 (비례 성질)\n"
            "• 소수점 이동 = 10배, 100배 곱하기\n"
            "• 반올림: 특정 자리에서 반올림하기\n"
            "• 나머지 처리: 소수점 이동 후 계산해도 나머지는 이동 전 위치에 표기"
        ),
        "misconceptions": (
            "• 한쪽만 소수점 이동\n"
            "• 반올림 조건 혼동 (가장 빈출):\n"
            "  '소수 둘째 자리까지 구하시오' ≠ '소수 둘째 자리에서 반올림하시오'\n"
            "• 나머지의 소수점 오류: 13.6÷3에서 나머지를 16이나 1로 표기\n"
            "  (나머지의 소수점은 이동 전 원래 위치를 따름)"
        ),
        "design_guidelines": (
            "• 두 유형('~까지 구하시오' vs '~에서 반올림') 교차 출제\n"
            "• 나머지 소수점 위치 확인 문항\n"
            "• 자연수÷소수도 포함"
        ),
    },
    "concept-e6-spatial": {
        "core_concepts": (
            "• 투영도 해석: 위/앞/옆에서 본 모양으로 전체 모양 유추\n"
            "• 앞에서 본 모양 = 가로와 높이만 나타남 (깊이 정보 없음)\n"
            "• 쌓기나무 개수 추론: 위/앞/옆 모양을 단서로 최대/최소 개수\n"
            "• 층별로 나타낸 모양→전체 모양 유추하기\n"
            "• 2D↔3D 변환 능력"
        ),
        "misconceptions": (
            "• 유일성 판단 오류: 투영도만으로는 입체 모양이 유일하게 결정 안 될 수 있음\n"
            "• 시점 불일치: 앞에서 본 모양 그릴 때 깊이 고려 안 함\n"
            "• 숨겨진 쌓기나무 개수 파악 못함"
        ),
        "design_guidelines": (
            "• 위/앞/옆 모양만 주고 쌓기나무 최대/최소 개수 구하기\n"
            "• 하나의 입체→세 방향 그림 그리기\n"
            "• 층별로 나타낸 모양을 보고 전체 모양 유추하기"
        ),
    },
    "concept-e6-proportion": {
        "core_concepts": (
            "• 비례식: 비율이 같은 두 비를 등호로 연결 (a:b = c:d)\n"
            "• 비례식의 성질: 외항의 곱 = 내항의 곱 (a×d = b×c)\n"
            "• 비의 성질: 전항·후항에 0 아닌 같은 수를 곱/나눠도 비의 값 동일\n"
            "• 비례배분: 전체 × a/(a+b)"
        ),
        "misconceptions": (
            "• 덧셈적 사고 (가장 치명적): 2:3=4:□에서 +2 → 5로 답함 (비례는 곱셈적 관계)\n"
            "• 외항/내항 위치 혼동\n"
            "• 비례배분 분모 오류: 2:3으로 나눌 때 분모를 3으로 잡음 (정답: 2+3=5)"
        ),
        "design_guidelines": (
            "• 덧셈적 추론이 통하지 않는 수 제시 (4:6=10:□)\n"
            "• 미지수가 포함된 비례식 풀기\n"
            "• 톱니바퀴 문제 (반비례 관계)\n"
            "• 재산 상속/이익 배분 등 실생활 비례배분"
        ),
    },
    "concept-e6-circle-area": {
        "core_concepts": (
            "• 원주율(π): 지름에 대한 원주의 비율 (2022 개정: 3.14 고정 사용)\n"
            "• 원주: 2πr 또는 π×지름\n"
            "• 넓이 공식 유도 (무한 분할): 원을 잘게 잘라 이어 붙이면 직사각형\n"
            "  가로=원주의 1/2(πr), 세로=반지름(r) → 넓이=πr²\n"
            "• 원주율은 어떤 원이든 일정한 상수"
        ),
        "misconceptions": (
            "• 공식 혼용: 원주(2πr) ↔ 넓이(πr²) 혼동\n"
            "• '지름×지름×원주율'로 넓이 계산하는 실수\n"
            "• 반원/부채꼴 둘레 오류: 곡선 부분만 계산, 직선(지름) 누락\n"
            "• 반지름과 지름 혼동"
        ),
        "design_guidelines": (
            "• 관계적 사고: 반지름 2배→원주 몇 배? 넓이 몇 배?\n"
            "• 운동장 트랙(직사각형+반원 2개)의 둘레와 넓이\n"
            "• 색칠한 부분(도넛 모양)의 넓이\n"
            "• 문제 조건에 '원주율: 3.14' 고정 표기"
        ),
    },
    "concept-e6-solids": {
        "core_concepts": (
            "• 회전체: 평면도형(직사각형, 직각삼각형, 반원)을 축으로 1회전시킨 입체\n"
            "• 단면: 회전축에 수직→원, 회전축 포함→선대칭도형\n"
            "• 원기둥: 합동인 두 원(밑면), 전개도 옆면의 가로=밑면 원주\n"
            "• 원기둥 겉넓이: 밑넓이×2 + 옆넓이(=2πr×h)\n"
            "• 원뿔: 밑면 원 1개, 꼭짓점 1개, 모선(옆면 따라 내려가는 길이)\n"
            "• 구: 중심에서 같은 거리인 점들의 집합, 전개도 불가"
        ),
        "misconceptions": (
            "• '구도 전개도를 그릴 수 있다' (구는 평면으로 완벽히 펼칠 수 없음)\n"
            "• 원뿔의 높이(수직 거리)↔모선(옆면 길이) 혼동\n"
            "• 원기둥 옆면 전개도가 직사각형인 것 이해 못함\n"
            "• 옆면 가로 길이 = 밑면 원주 연결 실패"
        ),
        "design_guidelines": (
            "• 모선 길이/높이/반지름 모두 제시→'높이' 정확히 선택하는지 확인\n"
            "• 회전체의 단면 유추 문제\n"
            "• 회전시키기 전의 평면도형 찾기\n"
            "• 전개도로 원기둥 겉넓이 구하기"
        ),
    },

    # ================================================================
    # 중학교 1학년 (32개 세부 개념)
    # ================================================================
    # 1단원: 소인수분해
    "concept-m1-prime-01": {
        "core_concepts": (
            "• 소수: 1보다 크고 1과 자신만을 약수로 가지는 자연수\n"
            "• 합성수: 1보다 큰 자연수 중 소수가 아닌 수\n"
            "• 1은 소수도 합성수도 아님\n"
            "• 서로소: 최대공약수가 1인 두 자연수의 관계"
        ),
        "misconceptions": (
            "• 1을 소수로 착각\n"
            "• 서로소 = 둘 다 소수라고 오해 (4와 9는 서로소이지만 둘 다 합성수)\n"
            "• 2가 소수가 아니라고 착각 (유일한 짝수 소수)"
        ),
        "design_guidelines": (
            "• 소수 판별 문항 (2는 유일한 짝수 소수 강조)\n"
            "• 서로소는 '관계' 용어임을 묻는 문항"
        ),
    },
    "concept-m1-prime-02": {
        "core_concepts": (
            "• 거듭제곱: a^n에서 a는 밑, n은 지수\n"
            "• 소인수분해 방법: 가지치기(Factor Tree) / 나눗셈(Repeated Division)\n"
            "• 약수의 개수: N=a^m × b^n일 때 (m+1)(n+1)"
        ),
        "misconceptions": (
            "• 지수와 밑 혼동: 2^3 = 2×3 = 6으로 계산\n"
            "• 소인수분해가 완전하지 않음 (4×3으로 멈춤)\n"
            "• 약수 개수 공식에서 지수에 1 더하는 것 잊음"
        ),
        "design_guidelines": (
            "• 소인수분해 실행 + 약수의 개수 연결\n"
            "• 제곱수 만들기: 지수가 짝수가 되도록"
        ),
    },
    "concept-m1-prime-03": {
        "core_concepts": (
            "• 최대공약수: 공통 소인수의 최소 지수 곱\n"
            "• 최소공배수: 모든 소인수의 최대 지수 곱\n"
            "• A × B = GCD(A,B) × LCM(A,B)\n"
            "• 공배수는 LCM의 배수, 공약수는 GCD의 약수"
        ),
        "misconceptions": (
            "• 최대공약수니까 큰 수, 최소공배수니까 작은 수 직관 오류\n"
            "• A×B = GCD×LCM 관계 미인지"
        ),
        "design_guidelines": (
            "• GCD/LCM 구하기 + A×B=GCD×LCM 활용\n"
            "• 공배수는 LCM의 배수이다 성질 문항"
        ),
    },
    # 2단원: 정수와 유리수
    "concept-m1-int-01": {
        "core_concepts": (
            "• 정수: 양의 정수(자연수), 0, 음의 정수\n"
            "• 수직선 모델: 오른쪽이 항상 큼\n"
            "• 대소 관계: 음수는 절대값이 클수록 작음"
        ),
        "misconceptions": (
            "• 0을 양의 정수에 포함\n"
            "• 음수끼리 대소 비교 시 절대값이 큰 수가 더 크다고 착각"
        ),
        "design_guidelines": (
            "• 정수 분류 문항 (양의 정수, 0, 음의 정수)\n"
            "• 수직선 위 대소 비교"
        ),
    },
    "concept-m1-int-02": {
        "core_concepts": (
            "• 절대값: 원점으로부터의 거리, 항상 0 이상\n"
            "• 유리수: a/b (a,b 정수, b≠0) 꼴로 나타낼 수 있는 수\n"
            "• 수 체계: 자연수 ⊂ 정수 ⊂ 유리수"
        ),
        "misconceptions": (
            "• -a는 반드시 음수라고 착각 (a=-3이면 -a=3)\n"
            "• 6/2는 분수이므로 정수가 아니라고 착각\n"
            "• 절대값이 같고 부호가 반대인 두 수의 합=0 놓침"
        ),
        "design_guidelines": (
            "• 절대값이 a인 수는 ±a 두 개 활용 문항\n"
            "• -a의 부호는 a에 따라 달라짐 강조"
        ),
    },
    "concept-m1-int-03": {
        "core_concepts": (
            "• 덧셈/뺄셈: 부호 같으면 절대값 합, 다르면 차\n"
            "• 곱셈/나눗셈: 마이너스 홀수개→(-), 짝수개→(+)\n"
            "• 거듭제곱 부호: (-2)^2=4 vs -2^2=-4\n"
            "• 분배법칙: a×(b+c) = ab + ac"
        ),
        "misconceptions": (
            "• -3^2을 9로 계산 (정답은 -9)\n"
            "• 뺄셈에서 교환법칙 적용: 3-5 ≠ 5-3\n"
            "• 나눗셈 역수 처리 오류"
        ),
        "design_guidelines": (
            "• 혼합 계산 순서 (PEMDAS) 적용\n"
            "• (-2)^2 vs -2^2 구별 문항"
        ),
    },
    # 3단원: 문자의 사용과 식의 계산
    "concept-m1-expr-01": {
        "core_concepts": (
            "• 문자 사용 규칙: 곱셈 기호 생략, 숫자를 문자 앞에, 1의 생략\n"
            "• 나눗셈의 분수 표현: a÷b = a/b\n"
            "• 항, 계수, 차수 용어"
        ),
        "misconceptions": (
            "• 곱셈 기호 생략 규칙 혼동: x×1=x (1 생략)\n"
            "• 음수 대입 시 괄호 미사용: 2×(-3)이 아닌 2×-3으로 표기"
        ),
        "design_guidelines": (
            "• 수량 관계를 문자식으로 표현하기\n"
            "• 대수적 관습 적용 문항"
        ),
    },
    "concept-m1-expr-02": {
        "core_concepts": (
            "• 동류항: 문자와 차수가 같은 항, 동류항끼리만 덧셈/뺄셈\n"
            "• 분배법칙으로 괄호 풀기\n"
            "• 일차식의 정리: 동류항 정리 → 내림차순"
        ),
        "misconceptions": (
            "• 분배법칙 부호 오류: -(2x-3)=-2x-3 (정답: -2x+3)\n"
            "• 2x^2와 2x를 동류항으로 착각 (차수 다름)\n"
            "• 상수항 무시"
        ),
        "design_guidelines": (
            "• 동류항 식별 후 정리 문항\n"
            "• 괄호 풀기 + 동류항 정리 복합 문항"
        ),
    },
    "concept-m1-expr-03": {
        "core_concepts": (
            "• 대입: 문자에 구체적 수를 넣어 식의 값 구하기\n"
            "• 식(Expression) vs 방정식(Equation) 구분\n"
            "• 변수(Variable) 개념"
        ),
        "misconceptions": (
            "• 식과 방정식 혼동: 2x+4를 보고 무의식적으로 =0 붙여 풂\n"
            "• 음수 대입 시 부호 처리 오류"
        ),
        "design_guidelines": (
            "• 대입하여 식의 값 구하기\n"
            "• 식을 간단히 하시오 vs 방정식을 푸시오 구분"
        ),
    },
    # 4단원: 일차방정식
    "concept-m1-eq-01": {
        "core_concepts": (
            "• 방정식: 미지수를 포함하는 등식\n"
            "• 등식의 성질 4가지: 양변에 같은 수 더하기/빼기/곱하기/나누기\n"
            "• 방정식의 해: 등식을 참으로 만드는 값, 해의 검증"
        ),
        "misconceptions": (
            "• 계수 처리 오류: 3x=6에서 x=6-3으로 계산\n"
            "• 방정식/등식/부등식 혼동"
        ),
        "design_guidelines": (
            "• 방정식의 정의 판별 문항\n"
            "• 등식의 성질 이해 문항"
        ),
    },
    "concept-m1-eq-02": {
        "core_concepts": (
            "• 이항: 항을 반대편으로 옮기면 부호가 바뀜\n"
            "• 소수 계수: 양변에 10, 100 곱하여 정수화\n"
            "• 분수 계수: 분모의 LCM을 양변에 곱하기\n"
            "• 비례식: A:B=C:D → AD=BC"
        ),
        "misconceptions": (
            "• 이항 시 부호 유지 (안 바꿈)\n"
            "• 소수/분수 계수 처리 오류"
        ),
        "design_guidelines": (
            "• 소수/분수 계수 방정식 풀이\n"
            "• 비례식 형태 방정식"
        ),
    },
    "concept-m1-eq-03": {
        "core_concepts": (
            "• 항등식: 어떤 값을 대입해도 항상 참인 등식\n"
            "• 미정계수법: 양변의 동류항 계수가 각각 같아야 함\n"
            "• 해의 특수성: a=0,b=0→무수히 많음, a=0,b≠0→해 없음"
        ),
        "misconceptions": (
            "• 항등식과 방정식 혼동\n"
            "• 해가 없는 경우를 인식 못함"
        ),
        "design_guidelines": (
            "• 항등식 조건에서 미정계수 구하기\n"
            "• 해가 무수히 많은/없는 경우 판별"
        ),
    },
    # 5단원: 좌표평면과 그래프
    "concept-m1-coord-01": {
        "core_concepts": (
            "• 순서쌍 (x, y), 좌표평면: x축, y축, 원점\n"
            "• 4개 사분면: 제1(+,+), 제2(-,+), 제3(-,-), 제4(+,-)\n"
            "• 좌표축 위의 점은 어느 사분면에도 속하지 않음\n"
            "• 대칭점: x축 대칭 (a,-b), y축 대칭 (-a,b), 원점 대칭 (-a,-b)"
        ),
        "misconceptions": (
            "• x좌표와 y좌표 순서 혼동\n"
            "• (3,0)을 제1사분면이라고 답함\n"
            "• x축 대칭과 y축 대칭 부호 변화를 반대로 기억"
        ),
        "design_guidelines": (
            "• 사분면 판별 + 축 위의 점 주의\n"
            "• 대칭점 구하기 문항"
        ),
    },
    "concept-m1-coord-02": {
        "core_concepts": (
            "• 변화의 경향 읽기: 증가, 감소, 일정, 주기적 변화\n"
            "• 정성적 추론: 수치 없이 변화의 모양 추론"
        ),
        "misconceptions": (
            "• 그래프의 높이=양의 값만 의미한다고 착각\n"
            "• 기울기와 증감 방향 혼동"
        ),
        "design_guidelines": (
            "• 물통 모양에 따른 수면 높이 변화 그래프 유추\n"
            "• 실생활 그래프 해석"
        ),
    },
    # 6단원: 정비례와 반비례
    "concept-m1-prop-01": {
        "core_concepts": (
            "• 정비례: y=ax (a≠0), x가 2배→y도 2배\n"
            "• 그래프: 원점을 지나는 직선\n"
            "• a>0: 1,3사분면, a<0: 2,4사분면"
        ),
        "misconceptions": (
            "• 정비례 판별 오류: 표에서 패턴 확인 부족"
        ),
        "design_guidelines": (
            "• 대응표에서 비례상수 구하기\n"
            "• 그래프 위 한 점으로 식 세우기"
        ),
    },
    "concept-m1-prop-02": {
        "core_concepts": (
            "• 반비례: y=a/x (a≠0), x가 2배→y가 1/2배\n"
            "• xy=a (일정한 곱)\n"
            "• 그래프: 좌표축에 점근하는 쌍곡선"
        ),
        "misconceptions": (
            "• 반비례 그래프가 x축/y축에 닿는다고 착각\n"
            "• x=0에서 정의 안 됨 인지 부족"
        ),
        "design_guidelines": (
            "• 반비례 식 세우기 (xy=a 활용)\n"
            "• 그래프의 불연속 이해"
        ),
    },
    "concept-m1-prop-03": {
        "core_concepts": (
            "• 식만 보고 그래프 개형 유추 (사분면, 형태)\n"
            "• 반비례 그래프 위 점에서 직사각형 넓이 = |a| (일정)\n"
            "• 실생활 활용: 톱니바퀴, 일의 양"
        ),
        "misconceptions": (
            "• y=2/x에서 전체 구간에서 감소한다고 일반화 (x<0과 x>0 각각에서만)\n"
            "• 반비례 그래프 점들을 선분으로 연결"
        ),
        "design_guidelines": (
            "• 비례상수 부호에 따른 그래프 위치 판별\n"
            "• 직사각형 넓이 일정 문항"
        ),
    },
    # 7단원: 기본 도형과 작도
    "concept-m1-geo-01": {
        "core_concepts": (
            "• 직선/반직선/선분 구분\n"
            "• 맞꼭지각: 크기가 항상 같음\n"
            "• 꼬인 위치: 만나지도 않고 평행하지도 않은 관계 (공간에서만)"
        ),
        "misconceptions": (
            "• 반직선의 방향성 무시: AB→ = BA→\n"
            "• 꼬인 위치 찾기 실패"
        ),
        "design_guidelines": (
            "• 직육면체에서 꼬인 위치 모서리 수 세기\n"
            "• 맞꼭지각 이용 각도 구하기"
        ),
    },
    "concept-m1-geo-02": {
        "core_concepts": (
            "• 동위각: 같은 위치에 있는 각, 평행할 때 크기 같음\n"
            "• 엇각: 엇갈린 위치, 평행할 때 크기 같음\n"
            "• 역: 동위각(엇각) 같으면 평행"
        ),
        "misconceptions": (
            "• 동위각은 항상 같다 (평행할 때만!)\n"
            "• 동위각과 엇각 위치 혼동"
        ),
        "design_guidelines": (
            "• 평행선과 각도 계산\n"
            "• 보조선(꺾인 선) 문제"
        ),
    },
    "concept-m1-geo-03": {
        "core_concepts": (
            "• 작도 도구: 눈금 없는 자 + 컴퍼스\n"
            "• 삼각형 합동 조건: SSS, SAS, ASA\n"
            "• SAS에서 끼인각(Included Angle) 중요"
        ),
        "misconceptions": (
            "• SSA를 합동 조건으로 착각\n"
            "• 합동 기호 순서가 대응점 순서임을 모름"
        ),
        "design_guidelines": (
            "• 합동 조건 판별 문항\n"
            "• 복합 도형에서 숨겨진 합동 삼각형 찾기"
        ),
    },
    # 8단원: 평면도형의 성질
    "concept-m1-plane-01": {
        "core_concepts": (
            "• 대각선 개수: n(n-3)/2\n"
            "• 내각의 합: (n-2)×180°\n"
            "• 외각의 합: 항상 360°\n"
            "• 삼각형 외각 = 이웃하지 않는 두 내각의 합"
        ),
        "misconceptions": (
            "• 내각과 외각 관계 혼동\n"
            "• n각형에서 n값 잘못 세기"
        ),
        "design_guidelines": (
            "• 정다각형의 한 내각/외각 구하기\n"
            "• 별 모양 도형에서 외각 활용"
        ),
    },
    "concept-m1-plane-02": {
        "core_concepts": (
            "• 원주: 2πr, 넓이: πr²\n"
            "• 부채꼴 호의 길이: 2πr×(x/360)\n"
            "• 부채꼴 넓이: πr²×(x/360) 또는 ½rl\n"
            "• 현의 길이는 중심각에 비정비례"
        ),
        "misconceptions": (
            "• π를 문자처럼 취급하지 못함\n"
            "• 중심각 2배→현 2배라고 착각 (거짓)"
        ),
        "design_guidelines": (
            "• 부채꼴 호의 길이/넓이 계산\n"
            "• ½rl 공식 활용 (중심각 모를 때)"
        ),
    },
    # 9단원: 입체도형의 성질
    "concept-m1-solid-01": {
        "core_concepts": (
            "• 다면체: 면, 모서리, 꼭짓점\n"
            "• 오일러 다면체 정리: V-E+F=2\n"
            "• 회전체: 평면도형을 1회전, 단면 성질"
        ),
        "misconceptions": (
            "• 회전체 상상 실패\n"
            "• 원기둥 비스듬히 자른 단면(타원)을 원으로 착각"
        ),
        "design_guidelines": (
            "• 오일러 공식 적용\n"
            "• 회전체의 단면 모양 추론"
        ),
    },
    "concept-m1-solid-02": {
        "core_concepts": (
            "• 기둥 겉넓이: 2(밑넓이)+옆넓이, 부피: 밑넓이×높이\n"
            "• 뿔 부피: 기둥 부피 × 1/3\n"
            "• 원뿔 전개도: 옆면=부채꼴, 호의 길이=밑면 둘레"
        ),
        "misconceptions": (
            "• 원뿔 전개도 호의 길이=밑면 원주 연결 못함\n"
            "• 전개도 접기 실패"
        ),
        "design_guidelines": (
            "• 겉넓이/부피 기본 계산\n"
            "• 전개도에서 맞닿는 부분 추적"
        ),
    },
    "concept-m1-solid-03": {
        "core_concepts": (
            "• 구의 겉넓이: 4πr²\n"
            "• 구의 부피: (4/3)πr³\n"
            "• 반지름 k배→겉넓이 k²배, 부피 k³배\n"
            "• 원기둥:구:원뿔 = 3:2:1 (같은 반지름, 높이)"
        ),
        "misconceptions": (
            "• 반지름 2배→부피 2배라고 착각 (8배)"
        ),
        "design_guidelines": (
            "• 구의 겉넓이/부피 계산\n"
            "• 반지름 배수에 따른 부피 변화"
        ),
    },
    # 10단원: 자료의 정리와 해석
    "concept-m1-freq-01": {
        "core_concepts": (
            "• 줄기와 잎 그림: 원자료 값을 잃지 않으면서 분포 파악\n"
            "• 도수분포표: 계급(Class), 계급값=(양 끝값 합)/2, 도수"
        ),
        "misconceptions": (
            "• 계급의 경계값 처리 (이상~미만)\n"
            "• 계급값 사용 오류: 평균 구할 때 실제 관측값 사용"
        ),
        "design_guidelines": (
            "• 도수분포표 완성하기\n"
            "• 계급값의 의미 이해"
        ),
    },
    "concept-m1-freq-02": {
        "core_concepts": (
            "• 히스토그램: 막대 높이=도수\n"
            "• 도수분포다각형: 막대 윗변 중점 연결\n"
            "• 넓이 관계: 다각형 넓이=히스토그램 넓이=(계급크기)×(총도수)"
        ),
        "misconceptions": (
            "• 히스토그램과 막대그래프 혼동\n"
            "• 막대 높이가 변량의 크기라고 착각 (높이=도수)"
        ),
        "design_guidelines": (
            "• 히스토그램 해석 문항\n"
            "• 도수분포다각형 넓이 관계"
        ),
    },
    "concept-m1-freq-03": {
        "core_concepts": (
            "• 상대도수: 해당 계급 도수 / 전체 도수\n"
            "• 상대도수의 총합은 항상 1\n"
            "• 활용: 총 도수가 다른 두 집단 비교"
        ),
        "misconceptions": (
            "• 상대도수와 도수 혼동\n"
            "• 총합이 1임을 활용 못함"
        ),
        "design_guidelines": (
            "• 상대도수를 이용한 두 집단 비교\n"
            "• 상대도수에서 도수 역산"
        ),
    },
    # 11단원: 대푯값
    "concept-m1-repr-01": {
        "core_concepts": (
            "• 평균: 총합/개수, 극단값에 취약\n"
            "• 중앙값: 크기순 정렬 후 가운데 값 (짝수개면 두 값의 평균)\n"
            "• 최빈값: 가장 자주 나타나는 값"
        ),
        "misconceptions": (
            "• 중앙값 구할 때 정렬 안 함\n"
            "• 짝수개 데이터에서 중앙값 없다고 착각\n"
            "• 평균=중앙값이라고 착각"
        ),
        "design_guidelines": (
            "• 대푯값 계산 (정렬 후 중앙값)\n"
            "• 데이터 변경 시 평균/중앙값 변화 추론"
        ),
    },
    "concept-m1-repr-02": {
        "core_concepts": (
            "• 극단값이 있을 때 중앙값이 더 대표적\n"
            "• 맥락적 판단: 어떤 대푯값이 적절한지 선택\n"
            "• 데이터 리터러시: 계산보다 의미와 판단 중시"
        ),
        "misconceptions": (
            "• 평균이 항상 가장 정확한 대푯값이라고 오해"
        ),
        "design_guidelines": (
            "• 극단값 상황에서 적절한 대푯값 선택\n"
            "• 서술형: 왜 이 대푯값이 더 적절한가?"
        ),
    },
    # 12단원: 산점도와 상관관계
    "concept-m1-scat-01": {
        "core_concepts": (
            "• 산점도: 두 변량을 좌표평면에 점으로 표현\n"
            "• 양의 상관관계: 우상향 분포\n"
            "• 음의 상관관계: 우하향 분포\n"
            "• 상관관계 없음: 원형 또는 무작위 분포"
        ),
        "misconceptions": (
            "• 모든 점이 직선 위에 있어야 상관관계라고 착각\n"
            "• 상관관계 강도 판단 오류"
        ),
        "design_guidelines": (
            "• 산점도 보고 상관관계 유형 판별\n"
            "• 실생활 예시 (기온-아이스크림, 기온-난방비)"
        ),
    },
    "concept-m1-scat-02": {
        "core_concepts": (
            "• 상관관계 ≠ 인과관계\n"
            "• 상관관계는 경향성일 뿐 원인-결과 아님\n"
            "• 제3변수(교란변수) 존재 가능"
        ),
        "misconceptions": (
            "• 상관관계=인과관계 혼동\n"
            "• 제3변수 무시: 아이스크림 판매량↔익사 사고 (진짜 원인: 기온)"
        ),
        "design_guidelines": (
            "• 인과관계 혼동 반례 문항\n"
            "• 상관관계가 있으면 인과관계도 있다 참/거짓"
        ),
    },

    # ================================================================
    # 중학교 2학년 (20개)
    # ================================================================
    # ── 1단원: 유리수와 순환소수 (2개) ──
    "concept-m2-rational-01": {
        "core_concepts": (
            "• 유리수: a/b (a,b 정수, b≠0) 꼴로 나타낼 수 있는 수\n"
            "• 유한소수 조건: 기약분수의 분모를 소인수분해했을 때 2와 5뿐\n"
            "• 유한소수 판별 3단계: 약분→소인수분해→판단\n"
            "• 분모에 2, 5 외의 소인수가 있으면 순환소수"
        ),
        "misconceptions": (
            "• 약분하지 않고 분모를 바로 소인수분해하는 오류\n"
            "• '분모가 10의 배수이면 유한소수'라는 잘못된 일반화\n"
            "• 분자 조건과 분모 조건을 혼동"
        ),
        "design_guidelines": (
            "• 약분→소인수분해→판단 단계적 출제\n"
            "• 반례를 통한 오개념 교정 문항"
        ),
    },
    "concept-m2-rational-02": {
        "core_concepts": (
            "• 순환소수: 순환마디가 있는 무한소수→유리수\n"
            "• 순환소수→분수 변환: 10x-x 또는 100x-x 방법\n"
            "• 0.999...=1 증명(10x-x=9)\n"
            "• 순환마디 표기법(점·윗줄)"
        ),
        "misconceptions": (
            "• 0.999...<1 직관적 저항\n"
            "• 순환마디 결정 오류(반복 시작점 착각)\n"
            "• π와 순환소수 혼동: 무한소수=순환소수 잘못된 일반화"
        ),
        "design_guidelines": (
            "• 순환소수↔분수 변환 연습\n"
            "• 순환마디 찾기 문항\n"
            "• 0.999...=1 증명 과정 추론"
        ),
    },
    # ── 2단원: 식의 계산 (2개) ──
    "concept-m2-expr-01": {
        "core_concepts": (
            "• 지수법칙: a^m×a^n=a^(m+n), (a^m)^n=a^(mn), (ab)^n=a^n·b^n\n"
            "• 거듭제곱의 정의: a^n = a를 n번 곱한 것\n"
            "• 중학교에서는 음의 지수, 0지수 미도입"
        ),
        "misconceptions": (
            "• 연산 기호와 지수법칙 불일치: a³×a²=a⁶ (곱셈→지수도 곱함)\n"
            "• (a^m)^n에서 m+n으로 계산하는 오류\n"
            "• a^m÷a^n에서 지수 처리 혼동"
        ),
        "design_guidelines": (
            "• 지수 정의로 돌아가 시각적 확인\n"
            "• 특정 수 대입하여 검산 습관 유도"
        ),
    },
    "concept-m2-expr-02": {
        "core_concepts": (
            "• 단항식: 수와 문자의 곱으로만 이루어진 식\n"
            "• 다항식: 단항식의 합, 차수=최고 차항의 차수\n"
            "• 동류항 정리, 분배법칙 전개\n"
            "• 단항식×다항식, 다항식÷단항식"
        ),
        "misconceptions": (
            "• 분배법칙 누락: (2x²y)³=2x⁶y³ (계수 거듭제곱 안 함)\n"
            "• 동류항 판별 오류: 차수와 문자가 다른 항을 합침\n"
            "• 다항식의 차수를 계수와 혼동"
        ),
        "design_guidelines": (
            "• 전개 후 동류항 정리까지 한 과정\n"
            "• 단항식/다항식 판별 문항"
        ),
    },
    # ── 3-1단원: 일차부등식 (2개) ──
    "concept-m2-ineq-01": {
        "core_concepts": (
            "• 부등호의 의미: <, >, ≤, ≥\n"
            "• 부등식의 성질: 양변에 같은 수를 더하거나 빼도 성립\n"
            "• 핵심: 음수를 곱/나누면 부등호 방향 반전\n"
            "• 수직선 표현: ○(미포함), ●(포함)"
        ),
        "misconceptions": (
            "• 부등호 방향 고착화: -2x>4→x>-2 (방향 안 바꿈)\n"
            "• 해를 수직선에 표시할 때 경계값 포함 여부(○, ●) 혼동\n"
            "• <와 ≤의 차이를 무시"
        ),
        "design_guidelines": (
            "• 음수 곱하기→부등호 반전 핵심 강조\n"
            "• 수직선 표현과 부등호 연결"
        ),
    },
    "concept-m2-ineq-02": {
        "core_concepts": (
            "• 복합 일차부등식: 분배법칙 활용 풀이\n"
            "• 부등식의 활용: 실생활 맥락 모델링\n"
            "• 방정식과 부등식의 차이: 해가 값 vs 범위\n"
            "• 연립부등식 기초"
        ),
        "misconceptions": (
            "• 괄호 풀기에서 부호 처리 오류\n"
            "• 부등식 풀이 후 해의 범위를 단일 값으로 답함\n"
            "• 부등식 활용 시 부등호 방향 설정 오류"
        ),
        "design_guidelines": (
            "• 실생활 맥락(요금제, 비교) 모델링\n"
            "• 방정식 vs 부등식 차이 인식 문항"
        ),
    },
    # ── 3-2단원: 연립일차방정식 (2개) ──
    "concept-m2-simul-01": {
        "core_concepts": (
            "• 미지수 2개, 방정식 2개 → 연립방정식\n"
            "• 가감법: 계수를 맞춰 한 문자 소거\n"
            "• 대입법: 한 식을 y=ax+b 형태로 정리 후 대입\n"
            "• 풀이 전략 선택: 계수 같으면 가감법, 정리되어 있으면 대입법"
        ),
        "misconceptions": (
            "• 가감법에서 부호 처리 오류\n"
            "• 계수를 맞출 때 한 식만 곱하는 실수\n"
            "• 대입 후 괄호 전개 누락"
        ),
        "design_guidelines": (
            "• 가감법 vs 대입법 효율성 판단 문항\n"
            "• 단계별 풀이 과정 제시"
        ),
    },
    "concept-m2-simul-02": {
        "core_concepts": (
            "• 해의 기하학적 의미: 두 직선의 교점 좌표\n"
            "• 해의 특수성: 해 1개(교차), 해 없음(불능·평행), 무수히 많음(부정·일치)\n"
            "• 계수 비교로 해의 상태 판별\n"
            "• a₁/a₂=b₁/b₂≠c₁/c₂→불능, a₁/a₂=b₁/b₂=c₁/c₂→부정"
        ),
        "misconceptions": (
            "• 대수적 해와 그래프 교점 연결 못함\n"
            "• 불능과 부정 개념 혼동\n"
            "• '해가 없다'를 '0이다'로 착각"
        ),
        "design_guidelines": (
            "• 해의 특수성 판별 문항\n"
            "• 그래프와 연립방정식의 관계 시각화"
        ),
    },
    # ── 4단원: 일차함수 (2개) ──
    "concept-m2-linfn-01": {
        "core_concepts": (
            "• 일차함수: y=ax+b (a≠0)\n"
            "• 기울기(a): Δy/Δx = 변화율, 양이면 우상향, 음이면 우하향\n"
            "• y절편(b): x=0일 때의 y값\n"
            "• 기울기의 절댓값이 클수록 가파름"
        ),
        "misconceptions": (
            "• 기울기 크기 비교 혼동: -2와 -5 중 어느 것이 더 가파른지\n"
            "• 절편과 좌표 혼동: x절편 3을 (0,3)에 표시\n"
            "• 기울기가 음수인 경우 그래프 방향 착각"
        ),
        "design_guidelines": (
            "• 기울기·절편 변화→그래프 변화 관찰\n"
            "• 기울기 부호에 따른 그래프 방향 문항"
        ),
    },
    "concept-m2-linfn-02": {
        "core_concepts": (
            "• 두 점을 지나는 직선의 방정식 구하기\n"
            "• ax+by+c=0 형태의 일차방정식과 그래프\n"
            "• x=k(세로선)는 함수가 아님\n"
            "• 연립방정식의 해 = 두 일차함수 그래프의 교점"
        ),
        "misconceptions": (
            "• x=2(세로선)를 함수로 착각\n"
            "• 두 점의 좌표를 기울기 공식에 대입할 때 순서 오류\n"
            "• 상수함수 y=3과 x=3을 혼동"
        ),
        "design_guidelines": (
            "• 두 점→기울기→절편 순서 문항\n"
            "• 일차방정식과 일차함수 연결"
        ),
    },
    # ── 5-1단원: 삼각형의 성질 (2개) ──
    "concept-m2-tri-01": {
        "core_concepts": (
            "• 이등변삼각형의 정의: 두 변의 길이가 같은 삼각형\n"
            "• 이등변삼각형의 성질: 두 밑각의 크기가 같다\n"
            "• 정의와 성질의 구분: 정의는 전제, 성질은 증명 대상\n"
            "• 직각삼각형의 합동 조건"
        ),
        "misconceptions": (
            "• 정의와 성질 혼동: '밑각이 같다'를 정의로 착각\n"
            "• 이등변삼각형의 꼭지각과 밑각 혼동\n"
            "• 역명제와 원래 명제의 구별 부족"
        ),
        "design_guidelines": (
            "• 정당화 활동: '왜 그런가?' 질문\n"
            "• 정의/성질 구분 문항"
        ),
    },
    "concept-m2-tri-02": {
        "core_concepts": (
            "• 외심: 세 변의 수직이등분선 교점(외접원의 중심)\n"
            "• 내심: 세 내각의 이등분선 교점(내접원의 중심)\n"
            "• 외심에서 세 꼭짓점까지 거리가 같음\n"
            "• 예각→내부, 직각→빗변 중점, 둔각→외부(외심 위치)"
        ),
        "misconceptions": (
            "• 외심/내심 혼동: 외심 작도 시 각의 이등분선 사용\n"
            "• 둔각삼각형 외심이 삼각형 외부에 있음을 잊음\n"
            "• 내심에서 세 변까지 거리가 같다는 것과 꼭짓점 혼동"
        ),
        "design_guidelines": (
            "• 외심·내심 구분 문항\n"
            "• 삼각형 종류별 외심 위치 문항"
        ),
    },
    # ── 5-2단원: 사각형의 성질 (2개) ──
    "concept-m2-quad-01": {
        "core_concepts": (
            "• 평행사변형의 정의: 두 쌍의 대변이 각각 평행\n"
            "• 평행사변형의 성질: 대변 같음, 대각 같음, 대각선 서로 이등분\n"
            "• 평행사변형이 되기 위한 조건 5가지\n"
            "• 평행사변형의 넓이"
        ),
        "misconceptions": (
            "• 평행사변형의 대각선 길이가 같다고 착각\n"
            "• 조건 하나만으로 평행사변형이라 판단\n"
            "• 성질과 조건을 구분하지 못함"
        ),
        "design_guidelines": (
            "• 평행사변형 판별 조건 문항\n"
            "• 성질 적용 계산 문항"
        ),
    },
    "concept-m2-quad-02": {
        "core_concepts": (
            "• 직사각형: 네 각이 모두 직각(대각선 길이 같음)\n"
            "• 마름모: 네 변의 길이 모두 같음(대각선 수직)\n"
            "• 정사각형: 직사각형+마름모\n"
            "• 사각형 계통도(포함 관계): 정사각형⊂직사각형/마름모⊂평행사변형"
        ),
        "misconceptions": (
            "• 사각형 포함 관계 이해 부족\n"
            "• 직사각형의 정의를 '대각선이 같다'로 착각\n"
            "• 마름모와 정사각형의 차이를 모름"
        ),
        "design_guidelines": (
            "• 사각형 포함 관계·계통도 문항\n"
            "• 정의 vs 성질 구분 문항"
        ),
    },
    # ── 6단원: 도형의 닮음 (2개) ──
    "concept-m2-simil-01": {
        "core_concepts": (
            "• 닮음의 정의: 대응변의 비가 같고 대응각이 같은 도형\n"
            "• SSS 닮음: 세 쌍 대응변 비가 같음\n"
            "• SAS 닮음: 두 쌍 대응변 비가 같고 끼인각이 같음\n"
            "• AA 닮음: 두 쌍 대응각이 같음"
        ),
        "misconceptions": (
            "• 대응변 찾기 오류: 회전/뒤집힌 도형에서 잘못 짝지음\n"
            "• AA 닮음에서 세 각을 모두 확인해야 한다고 착각\n"
            "• 닮음과 합동을 혼동"
        ),
        "design_guidelines": (
            "• 도형 분리 후 같은 방향으로 다시 그리기 전략\n"
            "• 닮음 조건 판별 문항"
        ),
    },
    "concept-m2-simil-02": {
        "core_concepts": (
            "• 닮음비 m:n → 넓이비 m²:n² → 부피비 m³:n³\n"
            "• 평행선과 선분의 비: 평행선이 만드는 비례 관계\n"
            "• 축도와 실제 크기 변환\n"
            "• 삼각형 중점연결정리"
        ),
        "misconceptions": (
            "• 닮음비를 넓이비에 그대로 적용(제곱 누락)\n"
            "• 부분 대 전체 비 혼동\n"
            "• 부피비에서 세제곱 누락"
        ),
        "design_guidelines": (
            "• 닮음비→넓이비→부피비 단계적 연결\n"
            "• 실생활 축소/확대 계산"
        ),
    },
    # ── 7단원: 피타고라스 정리 (2개) ──
    "concept-m2-pytha-01": {
        "core_concepts": (
            "• 피타고라스 정리: a²+b²=c² (c는 빗변)\n"
            "• 다양한 증명 방법(유클리드 증명, 넓이 비교)\n"
            "• 피타고라스 정리의 역: a²+b²=c²이면 직각삼각형\n"
            "• 피타고라스 수: 3-4-5, 5-12-13, 8-15-17"
        ),
        "misconceptions": (
            "• 빗변이 아닌 변을 c에 대입\n"
            "• a²+b²=c²에서 양변 제곱근 계산 오류\n"
            "• 둔각/예각삼각형 판별 시 부등호 방향 혼동"
        ),
        "design_guidelines": (
            "• 직각삼각형 판별 문항\n"
            "• 피타고라스 수 활용"
        ),
    },
    "concept-m2-pytha-02": {
        "core_concepts": (
            "• 좌표평면에서 두 점 사이 거리: √((x₂-x₁)²+(y₂-y₁)²)\n"
            "• 특수 직각삼각형: 1:1:√2 (45°-45°-90°), 1:√3:2 (30°-60°-90°)\n"
            "• 삼각형의 무게중심: 세 중선의 교점, 꼭짓점에서 2:1로 내분\n"
            "• 피타고라스 정리의 실생활 활용"
        ),
        "misconceptions": (
            "• 무게중심 비율 1:2로 거꾸로 기억\n"
            "• 두 점 사이 거리에서 빼기 순서 오류\n"
            "• 특수 직각삼각형 변의 비 혼동"
        ),
        "design_guidelines": (
            "• 좌표평면 거리 계산\n"
            "• 무게중심 성질 활용"
        ),
    },
    # ── 8단원: 확률 (2개) ──
    "concept-m2-prob-01": {
        "core_concepts": (
            "• 경우의 수: 사건이 일어나는 모든 경우\n"
            "• 합의 법칙: A 또는 B = m+n (배타적 사건)\n"
            "• 곱의 법칙: A 그리고 B = m×n (독립적 사건)\n"
            "• 수형도·표를 이용한 경우의 수 나열"
        ),
        "misconceptions": (
            "• 합의 법칙과 곱의 법칙 적용 조건 혼동\n"
            "• 중복 세기(합의 법칙에서 겹치는 경우 미제외)\n"
            "• 순서가 있는/없는 경우 구분 못함"
        ),
        "design_guidelines": (
            "• 합의 법칙 vs 곱의 법칙 판단 문항\n"
            "• 수형도 활용 문항"
        ),
    },
    "concept-m2-prob-02": {
        "core_concepts": (
            "• 수학적 확률: P(A)=n(A)/n(S), 0≤P(A)≤1\n"
            "• 근원사건의 동등성: 각 결과가 같은 확률\n"
            "• 여사건: P(A')=1-P(A)\n"
            "• 복원/비복원 추출 구별"
        ),
        "misconceptions": (
            "• 근원사건 동등성 무시: 크기 다른 공을 같은 확률로 계산\n"
            "• 여사건 활용 미숙\n"
            "• 복원/비복원 추출 구별 못함"
        ),
        "design_guidelines": (
            "• 여사건이 효율적인 문제\n"
            "• 복원 vs 비복원 추출 비교\n"
            "• 근원사건 동등성 확인 문항"
        ),
    },

    # ================================================================
    # 중학교 3학년 (20개)
    # ================================================================
    # ── 1단원: 실수와 그 연산 (3개) ──
    "concept-m3-sqrt-01": {
        "core_concepts": (
            "• 제곱근: x²=a의 해, 양수의 제곱근은 ±√a\n"
            "• √a: 양의 제곱근만 표기, √a²=|a|\n"
            "• 완전제곱수 판별과 소인수분해 활용"
        ),
        "misconceptions": (
            "• 'a의 제곱근'과 '제곱근 a(√a)' 혼동: 25의 제곱근=±5, √25=5\n"
            "• √a²=a 오류: a<0일 때 √a²=|a|"
        ),
        "design_guidelines": (
            "• '25의 제곱근'과 '√25' 구분 문항(단골 함정)\n"
            "• √(-3)²의 값 묻기 (답: 3)\n"
            "• √180x가 자연수 되게 하는 x 구하기"
        ),
    },
    "concept-m3-sqrt-02": {
        "core_concepts": (
            "• 무리수: 순환하지 않는 무한소수, 분수로 표현 불가\n"
            "• 실수 = 유리수 + 무리수 (서로 겹치지 않음)\n"
            "• 실수의 대소 비교: a-b의 부호 또는 근삿값 활용\n"
            "• 수직선 위의 무리수: 피타고라스 정리로 작도"
        ),
        "misconceptions": (
            "• '모든 무한소수는 무리수' 착각: 순환소수는 유리수\n"
            "• 무리수는 수직선 위에 나타낼 수 없다는 오해"
        ),
        "design_guidelines": (
            "• 유리수/무리수 분류 문항\n"
            "• '모든 무한소수는 무리수' 참/거짓 (반례: 순환소수)\n"
            "• 실수의 대소 비교 문항"
        ),
    },
    "concept-m3-sqrt-03": {
        "core_concepts": (
            "• 근호 계산: √a√b=√(ab), √a/√b=√(a/b)\n"
            "• 분모의 유리화: 1/√a=√a/a\n"
            "• 합차를 이용한 유리화: c/(√a+√b)=c(√a-√b)/(a-b)\n"
            "• 근호의 덧셈·뺄셈: 근호 안의 수가 같은 항끼리만 가능"
        ),
        "misconceptions": (
            "• √2+√3=√5 오류 (선형성 오류, 근삿값으로 모순 증명)\n"
            "• 분배법칙 오류: 근호 안/밖을 무분별하게 곱함"
        ),
        "design_guidelines": (
            "• 복잡한 사칙연산 혼합형\n"
            "• 합차를 이용한 유리화 문항\n"
            "• 식의 값 구하기(x=√3+2일 때)"
        ),
    },
    # ── 2단원: 다항식의 곱셈과 인수분해 (3개) ──
    "concept-m3-factor-01": {
        "core_concepts": (
            "• 분배법칙의 확장: (a+b)(c+d)\n"
            "• 곱셈 공식: (a±b)²=a²±2ab+b², (a+b)(a-b)=a²-b²\n"
            "• (x+a)(x+b)=x²+(a+b)x+ab\n"
            "• 곱셈 공식의 수 계산 활용: 103×97=(100+3)(100-3)"
        ),
        "misconceptions": (
            "• 중간항 누락: (x+3)²=x²+9 (가장 유명한 오류)\n"
            "• 중간항 2ab의 기하학적 의미(직사각형 넓이) 인식 부족"
        ),
        "design_guidelines": (
            "• (x+3)² 전개에서 중간항 확인\n"
            "• 곱셈 공식을 이용한 수의 계산\n"
            "• 변형 공식 활용: x²+y²=(x+y)²-2xy"
        ),
    },
    "concept-m3-factor-02": {
        "core_concepts": (
            "• 인수분해: 다항식을 곱의 형태로 (전개의 역연산)\n"
            "• 공통인수 묶기: ma+mb=m(a+b)\n"
            "• X자형 분리법: 합과 곱 조건 만족하는 두 수 찾기\n"
            "• 합차 인수분해: a²-b²=(a+b)(a-b)"
        ),
        "misconceptions": (
            "• 불완전한 인수분해: 2x²-8=2(x²-4)에서 멈춤→2(x+2)(x-2)\n"
            "• 인수분해와 방정식 혼동: 결과에 x=2 덧붙임\n"
            "• 식의 변형(인수분해) ≠ 등식의 풀이(방정식) 구분 부족"
        ),
        "design_guidelines": (
            "• 불완전 인수분해 찾기 문항\n"
            "• '인수분해하시오'에서 해 구하지 않기\n"
            "• 인수분해를 이용한 수의 계산"
        ),
    },
    "concept-m3-factor-03": {
        "core_concepts": (
            "• 완전제곱식 조건: x²+bx+c에서 c=(b/2)²\n"
            "• 이차항 계수가 1이 아닌 경우: (2x-3)²=4x²-12x+9\n"
            "• 공통부분 치환형 인수분해\n"
            "• 항이 4개 이상일 때 묶기 전략"
        ),
        "misconceptions": (
            "• 이차항 계수가 1이 아닐 때 완전제곱식 판별 오류\n"
            "• (x-a)²=(a-x)² 성립 인식 못함"
        ),
        "design_guidelines": (
            "• 완전제곱식 조건 문항: x²+10x+□→□=25\n"
            "• 4x²-12x+9 인수분해\n"
            "• 복잡한 식의 인수분해(치환 활용)"
        ),
    },
    # ── 3단원: 이차방정식 (3개) ──
    "concept-m3-quadeq-01": {
        "core_concepts": (
            "• 이차방정식: ax²+bx+c=0 (a≠0)\n"
            "• 풀이: ①인수분해(AB=0→A=0 or B=0)\n"
            "• ②완전제곱식 ③근의 공식: x=(-b±√(b²-4ac))/2a\n"
            "• 이차방정식이 되기 위한 조건(이차항 계수≠0)"
        ),
        "misconceptions": (
            "• 이차항 계수 조건 간과: (a-2)x²+...=0이면 a≠2 필수\n"
            "• 근의 공식에서 부호 오류, 분모 2a 빠뜨림"
        ),
        "design_guidelines": (
            "• 이차방정식이 되기 위한 조건 (a≠?)\n"
            "• 인수분해, 완전제곱식, 근의 공식 각각 풀이\n"
            "• 분수/소수 계수인 경우의 풀이"
        ),
    },
    "concept-m3-quadeq-02": {
        "core_concepts": (
            "• 판별식 D=b²-4ac\n"
            "• D>0: 서로 다른 두 실근, D=0: 중근, D<0: 실근 없음\n"
            "• 중근 조건으로 계수 결정\n"
            "• 근과 계수의 관계(심화): 합=-b/a, 곱=c/a"
        ),
        "misconceptions": (
            "• 중근='한 개의 근'으로 오해 (서로 같은 두 실근)\n"
            "• 판별식 음수일 때 중학교에서는 '해가 없다'(허수 X)"
        ),
        "design_guidelines": (
            "• 중근을 가질 조건 (D=0으로 k 구하기)\n"
            "• 근의 판별: 계수가 문자일 때 근의 개수\n"
            "• 두 근이 주어졌을 때 계수 역추적"
        ),
    },
    "concept-m3-quadeq-03": {
        "core_concepts": (
            "• 실생활→이차방정식 모델링(수학화)\n"
            "• 해의 타당성 검증: 길이>0, 사람 수=자연수\n"
            "• 기하적 활용(넓이·부피), 동적 활용(포물선 운동)"
        ),
        "misconceptions": (
            "• 물리적 타당성 무시: 길이 구하는 문제에서 음수 해 답함\n"
            "• 문제 맥락에 맞는 해 선택 과정 생략"
        ),
        "design_guidelines": (
            "• 도로/밭 넓이 문제 (기하학적 활용)\n"
            "• 쏘아 올린 물체 h=-5t²+vt+h₀ (동적 활용)\n"
            "• 연속하는 정수 문제 (수적 활용)"
        ),
    },
    # ── 4단원: 이차함수 (3개) ──
    "concept-m3-quadfn-01": {
        "core_concepts": (
            "• 기본형 y=ax²: 원점 꼭짓점, y축이 축\n"
            "• a>0 아래로 볼록, a<0 위로 볼록, |a| 클수록 폭 좁음\n"
            "• 표준형 y=a(x-p)²+q: 꼭짓점 (p,q), 축 x=p\n"
            "• 평행이동: y=ax²→y=a(x-p)²+q"
        ),
        "misconceptions": (
            "• 평행이동 부호 혼동: x축으로 p만큼→y=a(x-p)² (부호 반대)\n"
            "• 점의 이동과 함수 이동 혼동"
        ),
        "design_guidelines": (
            "• 표준형→꼭짓점, 축 찾기\n"
            "• 평행이동 문항(부호 주의)\n"
            "• y=ax²에서 |a| 값에 따른 폭 비교"
        ),
    },
    "concept-m3-quadfn-02": {
        "core_concepts": (
            "• 일반형 y=ax²+bx+c: 완전제곱식 변형으로 표준형 유도\n"
            "• 축 x=-b/(2a), 꼭짓점 (-b/2a, -(b²-4ac)/4a)\n"
            "• 그래프에서 a,b,c 부호 판별: 축 위치+볼록 방향으로 추론\n"
            "• 축이 y축 오른쪽→a와 b 부호 반대"
        ),
        "misconceptions": (
            "• b의 부호 결정 오류: 축 x=-b/2a의 위치 추론 실패\n"
            "• 증가/감소 구간: 축 기준 좌/우 나뉨을 간과"
        ),
        "design_guidelines": (
            "• 그래프 보고 a,b,c 부호 판별 문항\n"
            "• 일반형→표준형 변환 과정\n"
            "• 식 구하기: 꼭짓점+한 점 또는 x절편+한 점"
        ),
    },
    "concept-m3-quadfn-03": {
        "core_concepts": (
            "• a>0: 꼭짓점에서 최솟값 q, a<0: 꼭짓점에서 최댓값 q\n"
            "• (x-p)²≥0 이용한 정당화\n"
            "• 범위 제한(α≤x≤β)에서의 최대·최소\n"
            "• 도형·경제 최적화 문제"
        ),
        "misconceptions": (
            "• 최댓값/최솟값을 x좌표로 답함 (함숫값 y로 답해야 함)\n"
            "• 범위 내 꼭짓점 포함 여부에 따른 분류 간과"
        ),
        "design_guidelines": (
            "• '최댓값은?' 질문에 y값으로 답하는지 확인\n"
            "• 범위 내 최대·최소 (꼭짓점 포함/미포함)\n"
            "• 포물선 아래 내접 직사각형 넓이 최대화"
        ),
    },
    # ── 5단원: 삼각비 (2개) ──
    "concept-m3-trig-01": {
        "core_concepts": (
            "• 정의: sinA=대변/빗변, cosA=밑변/빗변, tanA=대변/밑변\n"
            "• 특수각: 30°(1/2, √3/2, √3/3), 45°(√2/2, √2/2, 1), 60°(√3/2, 1/2, √3)\n"
            "• 사분원에서 0°~90° 삼각비 정의"
        ),
        "misconceptions": (
            "• 변의 위치 착각: 회전된 삼각형에서 밑변/높이 못 찾음\n"
            "• 빗변=직각의 대변 (항상 고정) 인식 부족"
        ),
        "design_guidelines": (
            "• 회전된 삼각형에서 삼각비 구하기\n"
            "• 특수각 삼각비 값 유도 과정(정삼각형, 직각이등변삼각형)\n"
            "• 삼각비 표 읽기"
        ),
    },
    "concept-m3-trig-02": {
        "core_concepts": (
            "• 삼각형 넓이: S=½ab sinC (두 변과 끼인각)\n"
            "• sin²A+cos²A=1 (피타고라스 관계)\n"
            "• 삼각비의 증감: 각↑ → sin↑, cos↓\n"
            "• 실생활 측량: 건물 높이, 강폭 측정"
        ),
        "misconceptions": (
            "• 삼각비 크기 관계 혼동: sin50° vs tan50°\n"
            "• sinA, cosA는 항상 1 이하, tanA는 1 초과 가능"
        ),
        "design_guidelines": (
            "• sin, cos, tan 크기 비교 문항\n"
            "• 두 변과 끼인각으로 삼각형 넓이\n"
            "• 직접 잴 수 없는 거리 측정 문제"
        ),
    },
    # ── 6단원: 원의 성질 (3개) ──
    "concept-m3-circle-01": {
        "core_concepts": (
            "• 원주각과 중심각: 같은 호에 대해 원주각=½×중심각\n"
            "• 같은 호에 대한 원주각은 모두 같음\n"
            "• 반원(지름)의 원주각=90°\n"
            "• 현의 수직이등분선은 원의 중심을 지남"
        ),
        "misconceptions": (
            "• 중심각 착각: 원 내부의 아무 점을 중심으로 착각\n"
            "• 이등변삼각형 간과: 반지름 연결하면 이등변삼각형"
        ),
        "design_guidelines": (
            "• 원주각과 중심각 구분 문항\n"
            "• 반원의 원주각=90° 활용\n"
            "• 같은 호에 대한 원주각의 성질"
        ),
    },
    "concept-m3-circle-02": {
        "core_concepts": (
            "• 원에 내접하는 사각형: 대각의 합=180°\n"
            "• 내접 사각형 성질의 역: 대각의 합=180°이면 원에 내접\n"
            "• 내접 사각형의 외각 = 내대각"
        ),
        "misconceptions": (
            "• 내접 조건 판별 오류: 모든 사각형이 원에 내접한다고 착각\n"
            "• 대각의 합 성질과 내각의 합(360°) 혼동"
        ),
        "design_guidelines": (
            "• 내접사각형 대각의 합 활용 문항\n"
            "• 원에 내접하는지 판별하는 문항\n"
            "• 각도 계산 문항"
        ),
    },
    "concept-m3-circle-03": {
        "core_concepts": (
            "• 접선과 반지름: 접점에서 항상 수직(90°)\n"
            "• 원 밖의 한 점에서 두 접선의 길이가 같음 (RHS 합동)\n"
            "• 접현각: 접선과 현이 이루는 각 = 그 현의 원주각"
        ),
        "misconceptions": (
            "• 접선 문제에서 직각 표시 안 함\n"
            "• '접선이 나오면 중심→접점 반지름+직각' 패턴 인식 부족"
        ),
        "design_guidelines": (
            "• 접선 문제에서 반지름+직각 활용\n"
            "• 두 접선의 길이가 같은 성질 활용\n"
            "• 접현각 정리 활용(고난도)"
        ),
    },
    # ── 7단원: 통계 (3개) ──
    "concept-m3-stat-01": {
        "core_concepts": (
            "• 대푯값: 평균, 중앙값, 최빈값의 특성 비교\n"
            "• 이상치가 있을 때 중앙값이 유리\n"
            "• 산포도: 분산=편차²의 평균, 표준편차=√분산\n"
            "• 편차의 총합=항상 0"
        ),
        "misconceptions": (
            "• 편차 계산 순서 착각: (변량-평균)을 거꾸로 계산\n"
            "• 분산의 단위: 제곱 상태(단위 없음), 표준편차가 원래 단위"
        ),
        "design_guidelines": (
            "• 자료 일부 변경 시 대푯값/산포도 변화 예측\n"
            "• 두 집단 성적 비교(안정성 평가)\n"
            "• 분산/표준편차 계산 문항"
        ),
    },
    "concept-m3-stat-02": {
        "core_concepts": (
            "• 사분위수: Q1(하위 50% 중앙값), Q2(전체 중앙값), Q3(상위 50% 중앙값)\n"
            "• IQR=Q3-Q1 (중간 50%의 산포도, 이상치에 강건)\n"
            "• 상자그림: 상자(Q1~Q3), 내부선(Q2), 수염(이상치 제외 최소~최대)\n"
            "• 이상치: Q1-1.5×IQR 미만 또는 Q3+1.5×IQR 초과"
        ),
        "misconceptions": (
            "• 수염을 경계값(Q3+1.5×IQR)까지 긋는 오류→실제 데이터 값까지만\n"
            "• 상자 구간 길이=데이터 개수 착각→각 구간 25%씩 동일\n"
            "• Q2=평균 착각: 상자 내부선은 중앙값"
        ),
        "design_guidelines": (
            "• 이상치 판별 기준 적용 문항\n"
            "• 상자그림 두 개 비교(집단 간 비교형)\n"
            "• 수염이 어디까지인지(경계값 vs 실제 데이터)"
        ),
    },
    "concept-m3-stat-03": {
        "core_concepts": (
            "• 산점도: 두 변량의 관계를 좌표평면 위에 점으로 표현\n"
            "• 양의 상관관계(우상향), 음의 상관관계(우하향), 상관관계 없음\n"
            "• 상관관계 ≠ 인과관계 (제3변수 개입 가능)"
        ),
        "misconceptions": (
            "• 상관관계=인과관계 혼동 (아이스크림 판매↑→익사↑ 사례)\n"
            "• 산점도에서 점의 분포 방향 판별 오류"
        ),
        "design_guidelines": (
            "• 상관관계 판별 문항(실생활 예시)\n"
            "• 인과관계와 구분하는 논리적 사고 문항\n"
            "• 산점도 해석과 예측"
        ),
    },

    # ================================================================
    # 공통수학1 - 고1 1학기 (8개: 4단원 × 2)
    # ================================================================
    "concept-h1-polynomial-01": {
        "core_concepts": (
            "• 다항식 연산: 내림차순 정리, 덧셈·뺄셈·곱셈, 곱셈 공식의 변형\n"
            "• 항등식(Identity): 모든 x에 대해 성립하는 등식\n"
            "  → 미정계수법: 수치대입법(특정 값 대입), 계수비교법(양변의 동류항)\n"
            "• 문자의 역할: 변수 vs 상수 구분이 항등식 풀이의 핵심"
        ),
        "misconceptions": (
            "• 항등식과 방정식 혼동(가장 빈출): 'x에 대한 식' 보면 무조건 x값 구하려 함\n"
            "  → '모든 실수 k에 대해 성립' 조건에서 k가 주체 변수임을 인식 못함\n"
            "• 문자의 역할 혼동: 변수 vs 상수 구분 실패\n"
            "• 곱셈 공식 변형에서 부호 실수 (a-b)² = a²-2ab+b² 등"
        ),
        "design_guidelines": (
            "• 항등식 조건에서 미정계수 구하기\n"
            "• 문자의 역할(변수 vs 상수) 구분 문항\n"
            "• 곱셈 공식 변형 활용\n"
            "• 다항식 연산 정확성 확인"
        ),
    },
    "concept-h1-polynomial-02": {
        "core_concepts": (
            "• 다항식 나눗셈의 검산식: A=BQ+R (R의 차수 < B의 차수)\n"
            "  → 항등식 구조를 통한 다항식 공간에서의 분해 가능성 탐구\n"
            "• 나머지정리: P(x)를 (x-α)로 나눈 나머지 = P(α)\n"
            "  → 함수값 계산 = 나눗셈의 나머지 구하기와 동치\n"
            "• 인수정리: P(α)=0 → (x-α)는 P(x)의 인수 (고차방정식 해법 기초)\n"
            "• 조립제법: 간편한 다항식 나눗셈 알고리즘"
        ),
        "misconceptions": (
            "• 삼차식 제수의 구조적 오류(최상위권 변별 핵심):\n"
            "  f(x)를 (x-1)²(x+1)로 나눈 나머지 R(x) 구할 때\n"
            "  → R(x)=ax²+bx+c로 설정(미지수 3개, 조건 2개 딜레마)\n"
            "  → 정답: 나머지의 재귀적 구조 활용, R(x)=a(x-1)²+(3x+2)로 구조화\n"
            "• 조립제법 계수 오류: ax+b(a≠1)로 나눌 때 결과를 다시 a로 나누기 누락\n"
            "• 인수정리 적용 시 대입값 부호 실수: x-α에서 α 대입"
        ),
        "design_guidelines": (
            "• 나머지정리 활용 (함숫값 해석)\n"
            "• 나머지의 재귀적 구조 추론 문항 (삼차식 제수)\n"
            "• 인수정리와 조립제법을 이용한 고차 인수분해\n"
            "• 지나치게 복잡한 인수분해 지양, 원리 중심"
        ),
    },
    "concept-h1-equation-01": {
        "core_concepts": (
            "• 복소수: 실수 체계 확장, i²=-1 도입 → 대수적 닫힘(Algebraic Closure) 완성\n"
            "  → 켤레복소수 성질, 이차방정식의 해 표현 도구\n"
            "• 판별식 D: 실근/허근 판별 + 이차함수 그래프의 x축 교점 개수\n"
            "• 근과 계수의 관계: 합=-b/a, 곱=c/a\n"
            "• 이차항 계수 조건: 이차방정식이려면 a≠0"
        ),
        "misconceptions": (
            "• 음수의 제곱근 연산 성질(가장 치명적):\n"
            "  √(-2)×√(-3)=√6(X) → 정답: -√6\n"
            "  a<0,b<0일 때 i가 두 번 곱해지면서 부호 반전\n"
            "• 판별식 D와 함숫값 y의 부호 혼동(매우 빈출):\n"
            "  '모든 x에 대해 y>0' → 학생: D>0(X) → 정답: D<0\n"
            "• 이차항 계수 조건 간과: 이차방정식이려면 a≠0"
        ),
        "design_guidelines": (
            "• 음수의 제곱근 성질과 x 범위 추론 문항\n"
            "• 판별식 활용 (근의 판별, 중근 조건)\n"
            "• 근과 계수의 관계 활용 문항\n"
            "• 이차항 계수 ≠ 0 조건 확인 문항"
        ),
    },
    "concept-h1-equation-02": {
        "core_concepts": (
            "• 이차함수의 최대·최소: 정의역 제한 시 반드시 대칭축 위치 확인\n"
            "• 이차부등식: 그래프 개형 + x축 교점으로 해석\n"
            "• '항상 성립' 조건: 이차항 계수 부호 + 판별식 동시 확인\n"
            "• 절댓값 부등식: |x-a|<b → 수직선 상 '거리'로 해석"
        ),
        "misconceptions": (
            "• '항상 성립' 에서 a=0 별도 체크 누락:\n"
            "  kx²+2x+k>0 → k>0 전제 + D<0 + k=0일 때 별도 확인 필수\n"
            "• 제한된 범위 최대·최소: 꼭짓점이 범위 밖이면 경계값에서 최대·최소 발생\n"
            "  → 꼭짓점을 맹목적으로 답으로 선택 (정의역 인식 부족)\n"
            "• 이차부등식에서 이차항 계수가 음수인 경우 부등호 방향 혼동"
        ),
        "design_guidelines": (
            "• '항상 성립' 조건 → 이차항 계수 부호 + 판별식 + a=0 동시 확인\n"
            "• 제한된 범위에서 최대·최소 (대칭축 위치에 따른 분기)\n"
            "• 이차부등식 그래프 해석\n"
            "• 절댓값 부등식의 기하학적 해석"
        ),
    },
    "concept-h1-counting-01": {
        "core_concepts": (
            "• 합의 법칙(Rule of Sum): 배반사건(Mutually Exclusive)일 때 경우의 수를 더함\n"
            "• 곱의 법칙(Rule of Product): 사건이 연이어/동시에 일어날 때 경우의 수를 곱함\n"
            "  → '동시에'는 물리적 시간 일치가 아닌 '사건 완성을 위한 일련의 과정 수행'\n"
            "  → 직관적 룰: '분류하면 더하고, 진행하면 곱한다'"
        ),
        "misconceptions": (
            "• '동시에(Simultaneously)'의 언어적 오해(매우 빈출):\n"
            "  '상의 입고 하의 입는 건 시간차 있으니 동시 아니다' → 합의 법칙 적용 시도(X)\n"
            "  → 배반 사건까지 곱하는 과대 계상(Overcounting) 오류\n"
            "• 합의 법칙과 곱의 법칙 적용 상황 혼동"
        ),
        "design_guidelines": (
            "• 합의 법칙/곱의 법칙 적용 상황 구분 문항\n"
            "• 숫자 나열하고 지워가며 카운팅 (시각적 전략)\n"
            "• 수형도(Tree Diagram)로 '빠짐없이, 중복 없이' 세기"
        ),
    },
    "concept-h1-counting-02": {
        "core_concepts": (
            "• 순열 nPr: 서로 다른 n개에서 r개 택해 나열 (순서O)\n"
            "• 조합 nCr: 서로 다른 n개에서 r개 택함 (순서X)\n"
            "• 2022 개정: 단순 공식 암기보다 상황에 맞는 도구 선택 능력 강조\n"
            "• 여사건과 포함-배제 원리 활용"
        ),
        "misconceptions": (
            "• 동적 선택지 축소(Dynamic Pool Resizing, 최다 오답 원인):\n"
            "  0~9 중 특정 숫자 제외 후 4자리 자연수 만들기\n"
            "  → 각 자릿수마다 사용 가능한 숫자 풀이 동적으로 변함\n"
            "• 0을 포함한 순열(Zero Trap): 맨 앞자리 0 불가 제약\n"
            "• 여사건과 포함-배제 원리 누락\n"
            "• '순서 정해진' vs '이웃하는' vs '자리 고정' 혼동"
        ),
        "design_guidelines": (
            "• 포함-배제 원리 적용 문제\n"
            "• 조건부 순열/조합 (고정, 이웃, 순서 제약)\n"
            "• 0을 포함한 자연수 만들기 문항\n"
            "• 순열과 조합 구분 문항"
        ),
    },
    "concept-h1-matrix-01": {
        "core_concepts": (
            "• 행렬의 정의: 행과 열로 이루어진 수의 배열 (2×2 한정)\n"
            "• 기본 연산: 덧셈, 뺄셈, 실수배 → 성분별(Element-wise) 연산\n"
            "• 영행렬 O(덧셈의 항등원), 단위행렬 E(곱셈의 항등원)\n"
            "• 제외: 역행렬, 행렬식(ad-bc), 연립방정식 풀이"
        ),
        "misconceptions": (
            "• 행렬의 같음 조건: 대응하는 성분이 모두 같아야 함\n"
            "• 행렬의 뺄셈에서 부호 실수\n"
            "• 실수배와 곱셈 혼동"
        ),
        "design_guidelines": (
            "• 행렬의 덧셈·뺄셈·실수배 기본 계산\n"
            "• 행렬의 같음 조건 활용 미지수 구하기\n"
            "• 영행렬, 단위행렬 성질 확인\n"
            "• 수행평가: 실생활 데이터를 행렬로 표현하는 활동"
        ),
    },
    "concept-h1-matrix-02": {
        "core_concepts": (
            "• 행렬 곱셈: (행)×(열)의 내적 구조, 선형 변환의 합성을 내포\n"
            "• 비가환성: 일반적으로 AB≠BA → 실수와 완전히 다른 연산 체계\n"
            "• 행렬의 거듭제곱: 규칙성 찾기 (케일리-해밀턴 정리 간접 활용 소지)\n"
            "• 영인자: A≠O, B≠O인데 AB=O 가능"
        ),
        "misconceptions": (
            "• 교환법칙 성립 착각(가장 치명적, 서술형 최대 감점 요인):\n"
            "  (A+B)²=A²+2AB+B²(X)\n"
            "  → 정답: (A+B)²=A²+AB+BA+B² (AB와 BA는 동류항이 아님!)\n"
            "• 영인자(Zero Divisors, 직관 파괴):\n"
            "  실수: ab=0 → a=0 or b=0, 행렬: A≠O, B≠O인데 AB=O 가능\n"
            "• 약분(Cancellation) 시도:\n"
            "  AB=AC, A≠O → 양변을 A로 나눠 B=C?(X) → 역행렬 없으므로 불가"
        ),
        "design_guidelines": (
            "• AB≠BA 확인 문제 (반례 제시)\n"
            "• (A+B)² 전개 시 AB+BA 구분\n"
            "• 영인자 반례 구성\n"
            "• 진위 판정(ㄱ, ㄴ, ㄷ 합답형) 문항"
        ),
    },

    # ================================================================
    # 공통수학2 - 고1 2학기 (10개)
    # ================================================================
    "concept-h2-plane-coord": {
        "core_concepts": (
            "• 두 점 사이의 거리: √((x₂-x₁)²+(y₂-y₁)²) — 피타고라스 정리의 좌표평면 일반화\n"
            "• 선분의 내분점: m:n 내분 = (mx₂+nx₁)/(m+n), (my₂+ny₁)/(m+n)\n"
            "• 삼각형의 무게중심: 세 꼭짓점 좌표의 평균 = 세 중선의 교점\n"
            "• ⚠️ 2022 개정: 선분의 외분 삭제 → 내분점 심화와 무게중심 응용에 집중\n"
            "• √((x-a)²+(y-b)²) 식을 보면 '점 (x,y)와 (a,b) 사이의 거리'로 역추적"
        ),
        "misconceptions": (
            "• 내분점 공식에서 m,n에 대응하는 좌표 순서 혼동 (m은 먼 점, n은 가까운 점)\n"
            "• 거리 공식에서 뺄셈 순서 착각 → 제곱하므로 순서 무관임을 인식 못함\n"
            "• 삭제된 외분 공식을 여전히 사용하려는 시도 → 출제 금지\n"
            "• 무게중심 좌표를 '중점'과 혼동 (두 점 vs 세 점)"
        ),
        "design_guidelines": (
            "• √식을 보고 '두 점 사이의 거리'로 역추적하는 문항\n"
            "• 최단 거리 문제: 대칭이동 활용 (기하학적 직관)\n"
            "• 내분점 + 무게중심 융합 문항\n"
            "• ⚠️ 외분점 계산 문제 출제 금지"
        ),
    },
    "concept-h2-line": {
        "core_concepts": (
            "• 직선의 결정 조건: 기울기+한 점 y-y₁=m(x-x₁), 일반형 ax+by+c=0\n"
            "• 일반형의 장점: 수직선 x=k도 포괄 (y=mx+n으로는 표현 불가)\n"
            "• 두 직선의 위치 관계: 평행(기울기 같고 절편 다름), 수직(mm'=-1 또는 aa'+bb'=0)\n"
            "• 점과 직선 사이의 거리: |ax₁+by₁+c|/√(a²+b²)\n"
            "• 수직 조건의 유도: 피타고라스 정리 기반 (단순 암기 X)"
        ),
        "misconceptions": (
            "• 수직선 x=k를 y=mx+n 형태에 맞추려는 시도 → 기울기 정의 불가능 예외\n"
            "• 수직 조건 mm'=-1만 단순 암기: 피타고라스 정리 기반 유도 이해 못함\n"
            "• 점과 직선 거리 공식에서 절댓값 빠뜨림\n"
            "• 두 직선의 위치 관계에서 일치(평행이면서 절편 같음)를 빼먹음"
        ),
        "design_guidelines": (
            "• 수직 조건을 피타고라스 정리로 유도하는 서술형\n"
            "• 점과 직선 사이의 거리 공식 활용 (원의 접선과 연결)\n"
            "• 수직선 x=k가 관련된 상황 (일반형 필요성 인식)"
        ),
    },
    "concept-h2-circle": {
        "core_concepts": (
            "• 원의 정의: 한 정점에서 일정 거리에 있는 점들의 자취\n"
            "• 표준형: (x-a)²+(y-b)²=r², 일반형: x²+y²+Ax+By+C=0\n"
            "• 원이 되는 조건: A²+B²-4C > 0(실원), = 0(점원), < 0(허원)\n"
            "• 원과 직선의 위치 관계 — 전략 A(판별식 D), 전략 B(중심~직선 거리 d vs r)\n"
            "• 원의 접선 세 유형: ① 접점 주어진 경우 ② 기울기 주어진 경우 ③ 외부 점에서 그은 경우"
        ),
        "misconceptions": (
            "• 전략 선택 오류: 모든 문제에 판별식만 고집 → 거리 공식이 효율적인 경우 많음\n"
            "• 일반형→표준형 변환 시 완전제곱식 계수 실수\n"
            "• 실원/점원/허원 구별 실패: A²+B²-4C 부호 의미 미인식\n"
            "• 접선 세 유형(접점·기울기·외부 점)의 풀이 전략 구분 못함"
        ),
        "design_guidelines": (
            "• 거리 공식이 판별식보다 효율적인 문제 설계\n"
            "• 실원/점원/허원 판별 문항\n"
            "• 접선 세 유형 구분 문항\n"
            "• 원-직선 교점에서 근과 계수의 관계 활용"
        ),
    },
    "concept-h2-transform": {
        "core_concepts": (
            "• 평행이동: 점 (x,y)→(x+a,y+b), 도형 f(x,y)=0→f(x-a,y-b)=0 (부호 반대!)\n"
            "• 부호 역설(Sign Paradox): 새 좌표 x'=x+a이면 기존 좌표 x=x'-a를 대입\n"
            "• 대칭이동: x축(y→-y), y축(x→-x), 원점(x→-x,y→-y), y=x(x↔y)\n"
            "• y=x 대칭과 역함수: 3단원 역함수의 기하학적 의미와 직결\n"
            "• 자취의 방정식: 조건에서 매개변수 소거하여 x,y 관계식 도출"
        ),
        "misconceptions": (
            "• ⭐최빈출: 점의 이동 vs 도형의 이동 부호 역설 혼동\n"
            "  → 점은 +a, 도형 방정식은 -a (역변환 대입 필요)\n"
            "• y=x 대칭과 역함수의 기하학적 의미 연결 못함\n"
            "• 대칭이동 여러 종류(x축·y축·원점·y=x) 혼동\n"
            "• 자취의 방정식에서 매개변수 소거 과정 미숙"
        ),
        "design_guidelines": (
            "• '왜 도형 이동에서 부호가 반대인가?' 서술형 (역변환 논리 설명)\n"
            "• y=x 대칭과 역함수 연결 (1단원→3단원 단원 간 융합)\n"
            "• 점의 이동 vs 도형의 이동 비교 표 제시 후 오류 식별"
        ),
    },
    "concept-h2-set": {
        "core_concepts": (
            "• 집합의 정의: 명확한 기준으로 구별되는 대상들의 모임\n"
            "• 원소(∈) vs 부분집합(⊂): 문맥에 따라 같은 기호가 다른 의미\n"
            "• 공집합 ∅: 모든 집합의 부분집합 (공리적 약속)\n"
            "• 집합 연산: 교집합(∩), 합집합(∪), 여집합(Aᶜ), 차집합(A-B)\n"
            "• 드 모르간의 법칙: (A∪B)ᶜ = Aᶜ∩Bᶜ, (A∩B)ᶜ = Aᶜ∪Bᶜ\n"
            "• 포함-배제의 원리: n(A∪B) = n(A)+n(B)-n(A∩B)"
        ),
        "misconceptions": (
            "• ⭐∈과 ⊂ 혼동: A={1,2,{1,2}}일 때 {1,2}∈A ✓ vs {1}∈A ✗\n"
            "• 공집합의 존재론적 지위: ∅⊂A가 항상 참인 이유 이해 못함\n"
            "• 진부분집합 개수 오류: 2ⁿ-1에서 자기 자신 제외 (공집합 제외 아님!)\n"
            "• 집합의 정의에서 '명확한 기준' 조건 간과 (\"아름다운 꽃\"은 집합 아님)"
        ),
        "design_guidelines": (
            "• ∈과 ⊂ 구분 함정 문제\n"
            "• 공집합이 부분집합인 이유 서술\n"
            "• 드 모르간 법칙 활용\n"
            "• 부분집합·진부분집합 개수 문항"
        ),
    },
    "concept-h2-proposition": {
        "core_concepts": (
            "• 명제: 참 또는 거짓이 명확한 문장\n"
            "• 조건과 진리집합: 조건 p를 참이 되게 하는 원소의 집합 P\n"
            "• p→q의 핵심: P⊂Q이면 참\n"
            "• 역(q→p), 이(¬p→¬q), 대우(¬q→¬p): 대우만 원 명제와 진리값 일치\n"
            "• 충분조건·필요조건: P⊂Q → p는 q의 충분조건, q는 p의 필요조건\n"
            "  → '조건이 까다로울수록(진리집합 작을수록) 충분조건'\n"
            "• 대우를 이용한 증명, 귀류법"
        ),
        "misconceptions": (
            "• ⭐충분/필요조건 언어적 함정: 일상 언어와 수학적 정의의 괴리\n"
            "  → 'x=1이면 x²=1' → {1}⊂{-1,1} → 충분조건\n"
            "• 역과 대우 혼동: 역이 참이면 원 명제도 참이라고 착각\n"
            "• '모든'과 '어떤'의 부정 규칙 혼동: ¬(∀x,p(x)) = ∃x,¬p(x)\n"
            "• 진리집합 포함 관계 방향과 충분/필요 방향 연결 실패"
        ),
        "design_guidelines": (
            "• 충분/필요/필요충분조건 판별 (진리집합 활용)\n"
            "• 대우를 이용한 증명 문항 (√2 무리수 증명 등)\n"
            "• p→q의 역/이/대우 진리값 판별\n"
            "• 반례를 통한 명제의 거짓 증명"
        ),
    },
    "concept-h2-abs-inequality": {
        "core_concepts": (
            "• 절대부등식: 변수의 모든 값에 대해 항상 성립하는 부등식\n"
            "• 증명 기본 원리: A≥B ⟺ A-B≥0, A²≥0 활용\n"
            "• 산술-기하 평균 부등식(AM-GM): (a+b)/2 ≥ √(ab) (단, a>0, b>0)\n"
            "  → 등호 성립: a=b일 때\n"
            "• 코시-슈바르츠 부등식: 2022 개정에서 비중 감소, 기본 원리만"
        ),
        "misconceptions": (
            "• ⭐⭐⭐ 양수 조건 무시: AM-GM은 a>0, b>0에서만 성립\n"
            "  → 음수에 적용하면 부등식 방향 역전 (치명적 오류)\n"
            "• ⭐⭐⭐ 등호 성립 조건 망각: 최솟값 구할 때 a=b가 실제로 가능한지 확인 안 함\n"
            "  → 제약 조건 아래서 a=b 달성 불가능하면 그 최솟값은 의미 없음\n"
            "• 함수의 최솟값과 AM-GM 최솟값 혼동"
        ),
        "design_guidelines": (
            "• 음수 포함 식에서 AM-GM 사용 불가 상황 함정 문제\n"
            "• 등호 조건 가능 여부 확인 문항\n"
            "• 도형 넓이 최적화 (실생활 응용)\n"
            "• A²≥0 활용 절대부등식 증명"
        ),
    },
    "concept-h2-function": {
        "core_concepts": (
            "• 함수의 정의: 정의역의 모든 원소에 공역의 원소가 오직 하나씩 대응\n"
            "• 세로선 판별법: 세로선이 그래프와 2점 이상에서 만나면 함수 아님\n"
            "• 일대일함수: 서로 다른 정의역 원소 → 서로 다른 함숫값\n"
            "• 일대일대응: 일대일함수 + 치역=공역 → 역함수 존재 조건\n"
            "• 함수의 분류 체계: 함수 ⊃ 일대일함수 ⊃ 일대일대응"
        ),
        "misconceptions": (
            "• 일대일 함수와 일대일 대응 혼동: 치역≠공역이면 일대일 대응 아님\n"
            "• 함수의 정의에서 '오직 하나'의 의미 정확히 인식 못함\n"
            "• 세로선 판별법 적용 미숙\n"
            "• 역함수 존재 조건을 '일대일함수'로만 외움 (일대일대응 필요)"
        ),
        "design_guidelines": (
            "• 세로선 판별법으로 함수 여부 판단\n"
            "• 일대일 함수이지만 일대일 대응은 아닌 사례\n"
            "• 역함수 존재 조건 판별\n"
            "• 함수 분류 체계 이해 문항"
        ),
    },
    "concept-h2-composite": {
        "core_concepts": (
            "• 합성함수: (f∘g)(x)=f(g(x)), g를 먼저 적용한 뒤 f 적용\n"
            "• 교환법칙 불성립: f∘g ≠ g∘f (일반적)\n"
            "• 역함수: f⁻¹ 존재 조건 = 일대일대응, f(f⁻¹(x))=f⁻¹(f(x))=x\n"
            "• 역함수의 기하학적 의미: y=x에 대해 대칭 (1단원 대칭이동과 직결)\n"
            "• 합성함수 분해: 주어진 합성함수에서 원래 함수 역추적"
        ),
        "misconceptions": (
            "• f∘g = g∘f라고 착각 (교환법칙 성립한다고 오인)\n"
            "• 합성 순서 혼동: (f∘g)(x)에서 f를 먼저 적용하는 오류\n"
            "• ⭐⭐⭐ 역함수 교점 패러독스: 'f와 f⁻¹의 교점은 반드시 y=x 위'라는 착각\n"
            "  → 증가함수에서만 y=x 위, 감소함수(y=-x³, y=1/x)에서는 y=x 밖에도 존재\n"
            "• y=f(x)의 역함수를 x와 y만 바꾸면 끝이라고 착각"
        ),
        "design_guidelines": (
            "• f∘g ≠ g∘f 반례 찾기 문항\n"
            "• 합성함수에서 미지 함수 구하기 (분해)\n"
            "• f와 f⁻¹의 교점이 y=x 밖에 있는 감소함수 탐구 (고난도)\n"
            "• 역함수 그래프와 y=x 대칭 관계 활용"
        ),
    },
    "concept-h2-rational-irrational": {
        "core_concepts": (
            "• 유리함수 y=k/(x-p)+q: 점근선 x=p(수직), y=q(수평)\n"
            "  → 점근선 교점 (p,q)에 대해 점대칭\n"
            "• 유리함수 그래프: k>0이면 1·3사분면형, k<0이면 2·4사분면형 (점근선 교점 기준)\n"
            "• 무리함수 y=√(ax+b)+c: 정의역 ax+b≥0, 시작점에서 한 방향으로 뻗어나감\n"
            "• 무리함수의 역함수 관계: y=√x ↔ y=x²(x≥0)는 y=x 대칭"
        ),
        "misconceptions": (
            "• ⭐⭐⭐ 무연근(Extraneous Root): 양변 제곱 시 부호 정보 소실 → 존재하지 않는 근 등장\n"
            "  → 반드시 원래 방정식 대입 검증 또는 그래프 시각적 확인 필수\n"
            "• 점근선 도달 착각: 그래프가 점근선에 닿을 수 있다고 생각\n"
            "• 유리함수 사분면 배치 오류: k 부호와 점근선 교점 위치 혼동\n"
            "• 무리함수 정의역 조건 누락: √(ax+b)에서 ax+b≥0 빠뜨림"
        ),
        "design_guidelines": (
            "• 무리함수-직선 교점: 대수적 계산 + 그래프 확인 병행 (무연근 검증)\n"
            "• 유리함수 점근선·대칭성 활용 문항 (최단 거리, 넓이)\n"
            "• 정의역·치역 구하기\n"
            "• 유리함수/무리함수 그래프 개형 문제"
        ),
    },
}


def get_prompt_context(concept_id: str) -> ConceptPromptContext | None:
    """개념 ID로 프롬프트 컨텍스트 조회."""
    return PROMPT_CONTEXTS.get(concept_id)


def format_prompt_context(concept_id: str, grade: str) -> str:
    """프롬프트 삽입용 텍스트 생성.

    Args:
        concept_id: 개념 ID (예: "concept-e3-add-sub")
        grade: 학년 (예: "elementary_3")

    Returns:
        교육과정 컨텍스트 텍스트 (없으면 빈 문자열)
    """
    sections: list[str] = []

    grade_ctx = GRADE_CONTEXT.get(grade)
    if grade_ctx:
        sections.append(f"## 학년 특성\n{grade_ctx}")

    ctx = PROMPT_CONTEXTS.get(concept_id)
    if ctx:
        if ctx.get("core_concepts"):
            sections.append(f"## 핵심 개념\n{ctx['core_concepts']}")
        if ctx.get("misconceptions"):
            sections.append(
                f"## 학생 주요 오개념 (오답 선지에 반영)\n{ctx['misconceptions']}"
            )
        if ctx.get("design_guidelines"):
            sections.append(f"## 출제 가이드라인\n{ctx['design_guidelines']}")
        if ctx.get("difficulty_guide"):
            sections.append(f"## 난이도 기준\n{ctx['difficulty_guide']}")

    return "\n\n".join(sections) if sections else ""
