# 수학 연산/개념 테스트 시스템 설계 계획서

> 작성일: 2026-02-03
> 상태: 설계 검토 중

---

## 1. 개요

### 1.1 목표
초1~중3(+공통수학1) 범위의 수학 **연산** 문제와 **개념** 문제를 체계적으로 생성하고,
학년별 × 트랙별로 독립적인 10단계 난이도 시스템을 운영한다.

### 1.2 핵심 구조
```
[학년] × [트랙] × [레벨]
  │         │        │
  ├ 초1~중3  ├ 연산    └ Lv.1~10
  ├ 공통수학1 └ 개념
  │
  └ 10개 학년   2트랙   10레벨 = 총 200개 난이도 슬롯
```

### 1.3 설계 원칙
- **LLM 불필요**: 연산/개념 테스트는 템플릿 + 파라미터 치환으로 충분
- **학년별 독립 난이도**: 각 학년 내에서 Lv.1~10이 온전히 활용됨
- **이원 트랙**: 연산 실력과 개념 실력을 독립적으로 측정/추적
- **2022 개정 교육과정 기반**: 학년별 성취기준에 맞는 문제 범위

---

## 2. 난이도 체계 설계

### 2.1 학년 범위

| 코드 | 학년 | 주요 연산 범위 | 주요 개념 범위 |
|------|------|--------------|--------------|
| `elementary_1` | 초1 | 한 자리 덧뺄셈 | 수 세기, 크기 비교 |
| `elementary_2` | 초2 | 두 자리 덧뺄셈 | 길이·시간 단위 |
| `elementary_3` | 초3 | 곱셈 (구구단~두 자리) | 분수 개념, 도형 기초 |
| `elementary_4` | 초4 | 나눗셈, 혼합 연산 | 각도, 수직/평행 |
| `elementary_5` | 초5 | 분수 덧뺄셈, 소수 연산 | 약수·배수, 넓이 |
| `elementary_6` | 초6 | 분수 곱·나눗셈, 비율 연산 | 비례식, 원의 넓이 |
| `middle_1` | 중1 | 정수·유리수 연산 | 방정식, 좌표, 함수 |
| `middle_2` | 중2 | 문자식·단항식 연산 | 연립방정식, 일차함수 |
| `middle_3` | 중3 | 근호·다항식 연산 | 이차방정식, 삼각비 |
| `high_1` | 공통수학1 | 복소수·다항식 연산 | 집합·명제, 이차함수 |

### 2.2 학년 내 10단계 구조 (공통 패턴)

모든 학년에서 Lv.1~10은 다음 패턴을 따른다:

#### 연산 트랙 Lv.1~10 (공통 패턴)
| Lv | 패턴 | 설명 |
|----|------|------|
| 1 | 기본 연산 A | 해당 학년 핵심 연산의 가장 단순한 형태 |
| 2 | 기본 연산 B | 기본 연산의 약간 변형 |
| 3 | 확장 연산 | 자릿수/범위 확장 |
| 4 | 역연산 | 기본 연산의 역방향 |
| 5 | 혼합 기본 | 2가지 연산 혼합 |
| 6 | 혼합 확장 | 괄호·연산 순서 포함 |
| 7 | 이전 학년 연산 결합 | 이전 학년 연산과 결합 |
| 8 | 특수 케이스 | 0, 음수, 분수 등 특수한 경우 |
| 9 | 다단계 계산 | 3단계 이상의 연속 계산 |
| 10 | 복합 연산 | 모든 연산 유형 결합 |

#### 개념 트랙 Lv.1~10 (공통 패턴)
| Lv | 패턴 | 설명 |
|----|------|------|
| 1 | 용어 확인 | "~란?", 정의 선택 |
| 2 | 기본 판별 | 참/거짓, 분류하기 |
| 3 | 단순 적용 | 공식/규칙 한 번 적용 |
| 4 | 계산 포함 적용 | 개념 + 간단한 계산 |
| 5 | 다단계 적용 | 2단계 이상 풀이 |
| 6 | 조건 변환 | 조건을 수식으로 변환 |
| 7 | 역방향 추론 | 결과 → 조건 역추적 |
| 8 | 복합 개념 | 2개 개념 결합 |
| 9 | 문장제 | 실생활 상황 → 수식화 |
| 10 | 종합 응용 | 3개 이상 개념 + 추론 |

### 2.3 학년별 상세 설계 (중1 예시)

#### 중1 연산 Lv.1~10
| Lv | 내용 | 템플릿 예시 | 파라미터 |
|----|------|-----------|----------|
| 1 | 양의 정수 덧셈 | `{a} + {b}` | a,b ∈ [1,20] |
| 2 | 양의 정수 뺄셈 | `{a} - {b}` | a > b, a,b ∈ [1,20] |
| 3 | 음수 덧셈 | `({-a}) + {b}` | a,b ∈ [1,15] |
| 4 | 음수 뺄셈 | `({-a}) - ({-b})` | a,b ∈ [1,15] |
| 5 | 정수 곱셈 | `({-a}) × {b}` | a ∈ [2,9], b ∈ [2,9] |
| 6 | 정수 나눗셈 | `({-a*b}) ÷ {a}` | a ∈ [2,9], b ∈ [2,9] |
| 7 | 정수 혼합 연산 | `({-a}) × ({-b}) + {c}` | a,b ∈ [2,9], c ∈ [-10,10] |
| 8 | 유리수 덧뺄셈 | `{a}/{b} + ({-c}/{d})` | b,d ∈ [2,6] |
| 9 | 유리수 곱셈·나눗셈 | `({-a}/{b}) × ({c}/{d})` | b,d ∈ [2,6] |
| 10 | 유리수 복합 연산 | `({-a}/{b}) ÷ ({c}/{d}) + {e}` | 복합 파라미터 |

#### 중1 개념 Lv.1~10
| Lv | 내용 | 템플릿 예시 | 유형 |
|----|------|-----------|------|
| 1 | 용어 확인 | "소인수분해란?" | 객관식 (정의 선택) |
| 2 | 기본 판별 | "12의 약수를 모두 고르시오" | 객관식 |
| 3 | 단순 방정식 | `x + {a} = {b}` | 객관식/단답형 |
| 4 | 계수 방정식 | `{a}x = {b}` | 객관식/단답형 |
| 5 | 다단계 방정식 | `{a}x - {b} = {c}` | 객관식 |
| 6 | 부등식·좌표 | `x + {a} > {b}`, 사분면 판별 | 객관식 |
| 7 | 함수 기본 | `y = {a}x` 대입, 그래프 | 객관식 |
| 8 | 복합 방정식 | `{a}(x - {b}) = {c}x + {d}` | 객관식 |
| 9 | 문장제 | "어떤 수에 {a}를 더하면..." | 객관식 |
| 10 | 종합 응용 | 방정식 + 부등식 + 좌표 결합 | 객관식 |

---

## 3. 문제 생성 엔진 설계

### 3.1 아키텍처

```
┌─────────────────────────────────────────┐
│          Question Generator              │
│                                         │
│  ┌──────────┐    ┌──────────────────┐   │
│  │ Template  │───→│ Parameter Engine  │   │
│  │ Registry  │    │ (랜덤 파라미터)    │   │
│  └──────────┘    └────────┬─────────┘   │
│                           │              │
│                  ┌────────▼─────────┐   │
│                  │ Answer Calculator │   │
│                  │ (정답 자동 계산)    │   │
│                  └────────┬─────────┘   │
│                           │              │
│                  ┌────────▼─────────┐   │
│                  │ Distractor Maker  │   │
│                  │ (오답 보기 생성)    │   │
│                  └────────┬─────────┘   │
│                           │              │
│                  ┌────────▼─────────┐   │
│                  │ Question Builder  │   │
│                  │ (최종 문제 조립)    │   │
│                  └──────────────────┘   │
└─────────────────────────────────────────┘
```

### 3.2 Template Registry (템플릿 저장소)

각 학년 × 트랙 × 레벨별 템플릿을 Python dict로 관리:

```python
TEMPLATES = {
    "middle_1": {
        "computation": {
            1: [  # Lv.1 템플릿들 (여러 개 가능)
                {
                    "pattern": "{a} + {b}",
                    "params": {"a": (1, 20), "b": (1, 20)},
                    "answer_fn": lambda a, b: a + b,
                    "distractors_fn": lambda a, b, ans: [a - b, ans + 1, ans - 1],
                    "explanation_fn": lambda a, b, ans: f"{a} + {b} = {ans}",
                },
                # ... 같은 레벨의 다른 템플릿들
            ],
            2: [...],  # Lv.2
            # ...
            10: [...],  # Lv.10
        },
        "concept": {
            1: [...],
            # ...
        },
    },
    "elementary_1": { ... },
    # ...
}
```

### 3.3 Distractor (오답 보기) 생성 전략

오답은 교육적 가치를 위해 **흔한 실수 기반**으로 생성:

| 실수 유형 | 생성 방법 | 예시 (3 + 5 = 8) |
|----------|----------|------------------|
| 부호 실수 | 정답의 부호 반전 | -8 |
| 연산 혼동 | 다른 연산 적용 | 3-5=-2, 3×5=15 |
| ±1 오류 | 정답 ± 1 | 7, 9 |
| 자릿수 오류 | 십의 자리/일의 자리 혼동 | 해당 없음 |
| 계수 누락 | 계수를 무시한 결과 | (2x=10 → x=10) |
| 역연산 오류 | 이항 시 부호 반전 안 함 | (x+3=7 → x=10) |

```python
def make_distractors(correct: int, error_fns: list, count: int = 3) -> list[int]:
    """오답 보기 생성. 정답과 중복 없이 count개 생성."""
    distractors = set()
    for fn in error_fns:
        d = fn(correct)
        if d != correct:
            distractors.add(d)
    # 부족하면 ±1, ±2 등으로 채움
    offset = 1
    while len(distractors) < count:
        for delta in [offset, -offset]:
            if correct + delta != correct:
                distractors.add(correct + delta)
        offset += 1
    return list(distractors)[:count]
```

### 3.4 생성 방식: 실시간 vs 사전 생성

| 항목 | 실시간 생성 | 사전 생성 (DB) |
|------|-----------|--------------|
| 사용 시점 | 연습 모드 | 공식 테스트 |
| 장점 | 무한 변형, DB 부담 없음 | 품질 검증 가능, 통계 추적 |
| 구현 위치 | 프론트엔드 or 백엔드 | 백엔드 배치 작업 |
| 우선 적용 | 1차 구현 (MVP) | 2차 구현 |

**1차 구현 방향: 프론트엔드 실시간 생성**
- MSW mock 환경에서 빠르게 테스트 가능
- 서버 없이 동작
- 나중에 백엔드로 이전 용이 (동일 로직)

---

## 4. 데이터 모델 변경 계획

### 4.1 백엔드 모델 변경

#### Question 모델 (`backend/app/models/question.py`)
```python
# 추가할 필드
category: Mapped[str] = mapped_column(
    String(20), index=True, comment="문제 카테고리: computation | concept"
)
# difficulty (1-10)는 유지 — 학년 내 상대 난이도
# grade는 concept → concept.grade로 이미 연결됨
```

#### Concept 모델 (`backend/app/models/concept.py`)
```python
# 추가할 필드
category: Mapped[str] = mapped_column(
    String(20), default="concept", comment="카테고리: computation | concept"
)
```

#### AnswerLog 모델 (`backend/app/models/answer_log.py`)
```python
# 추가할 필드 (스냅샷)
question_category: Mapped[str | None] = mapped_column(
    String(20), nullable=True, comment="문제 카테고리 스냅샷"
)
```

#### User 모델 — 변경 없음
- `grade` 필드로 학생 학년 이미 관리
- 트랙별 레벨은 통계 쿼리로 산출 (별도 필드 불필요)

### 4.2 스키마 변경 (`backend/app/schemas/`)

#### common.py
```python
# 추가
class QuestionCategory(str, Enum):
    """문제 카테고리."""
    COMPUTATION = "computation"  # 연산
    CONCEPT = "concept"          # 개념
```

#### test.py
```python
# QuestionResponse에 추가
category: QuestionCategory

# AvailableTestResponse에 추가 (선택)
category: QuestionCategory | None = None  # 특정 카테고리 테스트인 경우
```

### 4.3 프론트엔드 타입 변경 (`frontend/src/types/index.ts`)

```typescript
// 추가
export type QuestionCategory = 'computation' | 'concept'

// Question 인터페이스에 추가
export interface Question {
  // ...기존 필드
  category: QuestionCategory
}

// Test 인터페이스에 추가
export interface Test {
  // ...기존 필드
  category?: QuestionCategory  // 연산 전용 or 개념 전용 테스트
}
```

### 4.4 Mock 데이터 변경

```typescript
// questions.ts — 기존 문제에 category 추가
{ id: 'q1', category: 'computation', difficulty: 5, content: '(-3) + 5 의 값은?', ... }
{ id: 'q3', category: 'concept', difficulty: 6, content: 'x + 5 = 12 일 때...', ... }

// concepts 배열에 category 추가
{ id: 'concept-1', category: 'computation', name: '정수의 덧셈과 뺄셈', ... }
{ id: 'concept-2', category: 'concept', name: '일차방정식', ... }
```

---

## 5. 구현 로드맵

### Phase 1: 기반 구조 (데이터 모델 + 타입)
- [ ] 백엔드: `QuestionCategory` enum 추가
- [ ] 백엔드: Question, Concept, AnswerLog 모델에 `category` 필드 추가
- [ ] 백엔드: 스키마(Pydantic) 업데이트
- [ ] 백엔드: 시드 데이터에 category 배정
- [ ] 프론트엔드: `QuestionCategory` 타입 추가
- [ ] 프론트엔드: Question, Test 타입에 category 추가
- [ ] 프론트엔드: Mock 데이터에 category 추가

### Phase 2: 문제 생성 엔진 (MVP — 중1 우선)
- [ ] 문제 생성 엔진 코어 구현 (TypeScript, 프론트엔드)
  - Template Registry 구조
  - Parameter Engine (랜덤 파라미터 생성)
  - Answer Calculator (정답 계산)
  - Distractor Maker (오답 보기 생성)
- [ ] 중1 연산 Lv.1~10 템플릿 작성
- [ ] 중1 개념 Lv.1~10 템플릿 작성
- [ ] MSW 핸들러에서 생성 엔진 연동

### Phase 3: UI 업데이트
- [ ] 대시보드: 연산/개념 트랙별 레벨 표시
- [ ] 테스트 선택: 연산 연습 / 개념 연습 분리
- [ ] QuestionCard: 카테고리 배지 표시
- [ ] MyStatsPage: 트랙별 통계 표시
- [ ] 적응형 테스트: 카테고리별 독립 난이도 조절

### Phase 4: 학년 확장
- [ ] 초1~초6 연산 템플릿 (각 10레벨)
- [ ] 초1~초6 개념 템플릿 (각 10레벨)
- [ ] 중2~중3 연산/개념 템플릿
- [ ] 공통수학1 연산/개념 템플릿

### Phase 5: 백엔드 이전 (선택)
- [ ] 문제 생성 엔진을 Python으로 포팅
- [ ] API 엔드포인트: `POST /api/v1/questions/generate`
- [ ] 배치 생성 + DB 저장
- [ ] 품질 검증 워크플로우

---

## 6. 학년별 상세 레벨 설계

> 아래는 각 학년의 연산/개념 Lv.1~10 설계이다.
> Phase 4에서 순차적으로 구현한다.

### 6.1 초1 (elementary_1)

#### 초1 연산
| Lv | 내용 | 범위 |
|----|------|------|
| 1 | 한 자리 + 한 자리 (합 ≤ 9) | 1+1 ~ 4+5 |
| 2 | 한 자리 + 한 자리 (합 ≤ 18) | 5+6 ~ 9+9 |
| 3 | 한 자리 - 한 자리 | 9-1 ~ 9-8 |
| 4 | 10 만들기 | ?+3=10 |
| 5 | 두 자리 + 한 자리 (받아올림 없음) | 13+5 |
| 6 | 두 자리 - 한 자리 (받아내림 없음) | 18-5 |
| 7 | 두 자리 + 한 자리 (받아올림) | 17+5 |
| 8 | 두 자리 - 한 자리 (받아내림) | 23-7 |
| 9 | 세 수의 덧셈 | 3+5+2 |
| 10 | 세 수의 혼합 | 8+3-2 |

#### 초1 개념
| Lv | 내용 | 예시 |
|----|------|------|
| 1 | 수 세기 | "사과가 몇 개?" |
| 2 | 수 크기 비교 | "7과 5 중 큰 수" |
| 3 | 순서 | "3번째로 큰 수" |
| 4 | 묶어 세기 | "2씩 묶으면 몇 묶음?" |
| 5 | 모양 찾기 | "삼각형은 어느 것?" |
| 6 | 시계 읽기 | "몇 시?" |
| 7 | 길이 비교 | "더 긴 것은?" |
| 8 | 규칙 찾기 기초 | "1, 3, 5, ?" |
| 9 | 문장제 기초 | "3개에서 2개를 먹으면?" |
| 10 | 복합 문장제 | "처음 5개, 3개 받고 2개 줌" |

### 6.2 초2 (elementary_2)

#### 초2 연산
| Lv | 내용 |
|----|------|
| 1 | 두 자리 + 두 자리 (받아올림 없음) |
| 2 | 두 자리 + 두 자리 (받아올림 있음) |
| 3 | 두 자리 - 두 자리 (받아내림 없음) |
| 4 | 두 자리 - 두 자리 (받아내림 있음) |
| 5 | 세 자리 + 두 자리 |
| 6 | 세 자리 - 두 자리 |
| 7 | 곱셈 구구단 (2,5단) |
| 8 | 곱셈 구구단 (3,4,6단) |
| 9 | 곱셈 구구단 (7,8,9단) |
| 10 | 혼합 (덧뺄셈 + 곱셈 기초) |

#### 초2 개념
| Lv | 내용 |
|----|------|
| 1 | 세 자리 수 읽기/쓰기 |
| 2 | 자릿값 이해 |
| 3 | 길이 단위 (cm, m) |
| 4 | 시각과 시간 |
| 5 | 표 읽기 |
| 6 | 그래프 읽기 |
| 7 | 규칙 찾기 |
| 8 | 도형 분류 |
| 9 | 문장제 |
| 10 | 복합 문장제 |

### 6.3 초3 (elementary_3)

#### 초3 연산
| Lv | 내용 |
|----|------|
| 1 | 세 자리 + 세 자리 |
| 2 | 세 자리 - 세 자리 |
| 3 | 한 자리 × 두 자리 |
| 4 | 두 자리 × 한 자리 |
| 5 | 두 자리 ÷ 한 자리 (나머지 없음) |
| 6 | 두 자리 ÷ 한 자리 (나머지 있음) |
| 7 | 분수 크기 비교 (같은 분모) |
| 8 | 동분모 분수 덧셈 |
| 9 | 동분모 분수 뺄셈 |
| 10 | 혼합 (곱셈 + 나눗셈 + 분수) |

#### 초3 개념
| Lv | 내용 |
|----|------|
| 1 | 분수 개념 ("전체의 몇 분의 몇?") |
| 2 | 분수 크기 비교 |
| 3 | 평면도형 이름 |
| 4 | 원의 구성 요소 (중심, 반지름) |
| 5 | 들이와 무게 단위 |
| 6 | mm, km 단위 변환 |
| 7 | 직각삼각형 판별 |
| 8 | 나눗셈 문장제 |
| 9 | 곱셈 문장제 |
| 10 | 복합 문장제 (곱셈 + 나눗셈) |

### 6.4 초4 (elementary_4)

#### 초4 연산
| Lv | 내용 |
|----|------|
| 1 | 큰 수 덧셈 (만, 억 단위) |
| 2 | 큰 수 뺄셈 |
| 3 | 두 자리 × 두 자리 |
| 4 | 세 자리 × 두 자리 |
| 5 | 세 자리 ÷ 두 자리 |
| 6 | 혼합 연산 (덧뺄셈 + 곱셈) |
| 7 | 혼합 연산 (괄호 포함) |
| 8 | 이분모 분수 비교 (통분) |
| 9 | 소수 덧뺄셈 기초 |
| 10 | 혼합 연산 (사칙 + 괄호) |

#### 초4 개념
| Lv | 내용 |
|----|------|
| 1 | 각도 개념 |
| 2 | 예각/둔각/직각 판별 |
| 3 | 삼각형 분류 |
| 4 | 사각형 분류 |
| 5 | 수직과 평행 |
| 6 | 소수 개념 |
| 7 | 규칙과 대응 |
| 8 | 꺾은선 그래프 읽기 |
| 9 | 문장제 (연산 순서) |
| 10 | 복합 도형 문제 |

### 6.5 초5 (elementary_5)

#### 초5 연산
| Lv | 내용 |
|----|------|
| 1 | 이분모 분수 덧셈 (통분) |
| 2 | 이분모 분수 뺄셈 |
| 3 | 대분수 덧셈 |
| 4 | 대분수 뺄셈 |
| 5 | 소수 × 자연수 |
| 6 | 소수 × 소수 |
| 7 | 소수 ÷ 자연수 |
| 8 | 약분·통분 |
| 9 | 분수 혼합 계산 |
| 10 | 소수 + 분수 혼합 |

#### 초5 개념
| Lv | 내용 |
|----|------|
| 1 | 약수와 배수 정의 |
| 2 | 공약수·최대공약수 |
| 3 | 공배수·최소공배수 |
| 4 | 직육면체·정육면체 |
| 5 | 넓이 구하기 (직사각형) |
| 6 | 넓이 구하기 (삼각형, 마름모) |
| 7 | 평균 계산 |
| 8 | 가능성과 경우의 수 기초 |
| 9 | 문장제 (약수·배수) |
| 10 | 복합 넓이 문제 |

### 6.6 초6 (elementary_6)

#### 초6 연산
| Lv | 내용 |
|----|------|
| 1 | 분수 × 자연수 |
| 2 | 분수 × 분수 |
| 3 | 분수 ÷ 자연수 |
| 4 | 분수 ÷ 분수 |
| 5 | 소수 ÷ 소수 |
| 6 | 비율 계산 (백분율) |
| 7 | 비례식 계산 |
| 8 | 분수·소수 혼합 연산 |
| 9 | 비율 혼합 문제 |
| 10 | 복합 연산 (분수+소수+비율) |

#### 초6 개념
| Lv | 내용 |
|----|------|
| 1 | 비와 비율 개념 |
| 2 | 백분율 개념 |
| 3 | 비례식 |
| 4 | 비례배분 |
| 5 | 원의 넓이 |
| 6 | 원기둥 부피 |
| 7 | 경우의 수 |
| 8 | 띠그래프·원그래프 |
| 9 | 문장제 (비율) |
| 10 | 복합 응용 |

### 6.7 중1 (middle_1) — 위 2.3절 참조

### 6.8 중2 (middle_2)

#### 중2 연산
| Lv | 내용 |
|----|------|
| 1 | 단항식 × 단항식 |
| 2 | 단항식 ÷ 단항식 |
| 3 | 다항식 + 다항식 |
| 4 | 다항식 - 다항식 |
| 5 | 단항식 × 다항식 |
| 6 | 다항식 × 다항식 (전개) |
| 7 | 곱셈 공식 (a+b)² |
| 8 | 곱셈 공식 (a-b)², (a+b)(a-b) |
| 9 | 연립방정식 계산 (대입법) |
| 10 | 연립방정식 계산 (가감법) |

#### 중2 개념
| Lv | 내용 |
|----|------|
| 1 | 단항식/다항식 구분 |
| 2 | 부등식의 해 판별 |
| 3 | 연립방정식 (대입법) |
| 4 | 연립방정식 (가감법) |
| 5 | 일차함수 y = ax + b |
| 6 | 일차함수 그래프 해석 |
| 7 | 삼각형 합동 조건 |
| 8 | 사각형 성질 |
| 9 | 확률 기본 |
| 10 | 복합 응용 (함수 + 방정식) |

### 6.9 중3 (middle_3)

#### 중3 연산
| Lv | 내용 |
|----|------|
| 1 | 제곱근 계산 (√4, √9...) |
| 2 | 근호 간소화 (√12 = 2√3) |
| 3 | 근호 덧뺄셈 (2√3 + 5√3) |
| 4 | 근호 곱셈 (√2 × √3) |
| 5 | 근호 나눗셈 |
| 6 | 유리화 |
| 7 | 인수분해 (공통인수) |
| 8 | 인수분해 (x² + bx + c) |
| 9 | 인수분해 (완전제곱식, 차이곱) |
| 10 | 복합 인수분해 |

#### 중3 개념
| Lv | 내용 |
|----|------|
| 1 | 제곱근의 뜻 |
| 2 | 무리수 판별 |
| 3 | 인수분해 개념 |
| 4 | 이차방정식 (인수분해) |
| 5 | 이차방정식 (근의 공식) |
| 6 | 이차함수 y = ax² |
| 7 | 이차함수 그래프 (꼭짓점, 축) |
| 8 | 삼각비 (sin, cos, tan) |
| 9 | 원과 접선 |
| 10 | 복합 응용 (이차방정식 + 함수) |

### 6.10 공통수학1 (high_1)

#### 공통수학1 연산
| Lv | 내용 |
|----|------|
| 1 | 다항식 정리 |
| 2 | 다항식 나눗셈 |
| 3 | 인수분해 (고급) |
| 4 | 복소수 덧뺄셈 |
| 5 | 복소수 곱셈 |
| 6 | 복소수 나눗셈 (켤레) |
| 7 | 나머지정리 계산 |
| 8 | 이차방정식 판별식 |
| 9 | 연립부등식 계산 |
| 10 | 절대값 방정식/부등식 |

#### 공통수학1 개념
| Lv | 내용 |
|----|------|
| 1 | 집합의 뜻과 표현 |
| 2 | 부분집합·교집합·합집합 |
| 3 | 명제와 조건 |
| 4 | 필요조건·충분조건 |
| 5 | 이차부등식 |
| 6 | 이차함수 최대·최소 |
| 7 | 절대값 함수 그래프 |
| 8 | 방정식·부등식의 활용 |
| 9 | 복소수와 이차방정식 관계 |
| 10 | 종합 응용 (명제 + 부등식 + 함수) |

---

## 7. 기술 상세

### 7.1 프론트엔드 문제 생성기 (TypeScript)

```
frontend/src/services/questionGenerator/
├── index.ts              # 메인 진입점
├── types.ts              # 타입 정의
├── engine.ts             # 생성 엔진 코어
├── distractors.ts        # 오답 보기 생성
├── templates/
│   ├── index.ts          # 템플릿 레지스트리
│   ├── elementary1.ts    # 초1 템플릿
│   ├── elementary2.ts    # 초2 템플릿
│   ├── ...
│   ├── middle1.ts        # 중1 템플릿
│   ├── middle2.ts
│   ├── middle3.ts
│   └── high1.ts          # 공통수학1 템플릿
└── utils/
    ├── math.ts           # 수학 유틸 (GCD, LCM, 분수 계산 등)
    └── random.ts         # 랜덤 파라미터 생성
```

### 7.2 핵심 인터페이스

```typescript
interface QuestionTemplate {
  id: string
  grade: Grade
  category: QuestionCategory
  level: number  // 1-10
  pattern: string  // "{a} + {b}"
  paramRanges: Record<string, [number, number]>
  constraints?: (params: Record<string, number>) => boolean
  answerFn: (params: Record<string, number>) => number | string
  distractorFns: ((params: Record<string, number>, answer: number) => number)[]
  explanationFn: (params: Record<string, number>, answer: number | string) => string
}

interface GeneratedQuestion {
  id: string  // uuid
  category: QuestionCategory
  grade: Grade
  difficulty: number  // 1-10
  content: string
  options: QuestionOption[]
  correct_answer: string
  explanation: string
  points: number
  question_type: 'multiple_choice'
}

// 사용 예시
const question = generateQuestion({
  grade: 'middle_1',
  category: 'computation',
  level: 5,
})
```

### 7.3 적응형 테스트 연동

```
학생이 "중1 연산 연습" 시작
  ↓
초기 난이도 = 학생의 현재 연산 레벨 (예: Lv.5)
  ↓
문제 출제: middle_1 / computation / Lv.5 템플릿에서 생성
  ↓
정답 → Lv.6 문제 출제
오답 → Lv.4 문제 출제
  ↓
10문제 후 최종 레벨 산출
  ↓
학생의 middle_1 computation level 업데이트
```

---

## 8. 영향 범위 요약

### 변경 파일 목록

#### 백엔드
| 파일 | 변경 내용 |
|------|----------|
| `schemas/common.py` | `QuestionCategory` enum 추가, `Difficulty` docstring 수정 |
| `models/question.py` | `category` 필드 추가 |
| `models/concept.py` | `category` 필드 추가 |
| `models/answer_log.py` | `question_category` 스냅샷 필드 추가 |
| `schemas/test.py` | 응답 스키마에 `category` 추가 |
| `api/v1/tests.py` | 카테고리 필터링 파라미터 추가 |
| `main.py` | 시드 데이터에 `category` 배정 |
| `tests/conftest.py` | 테스트 픽스처에 `category` 추가 |

#### 프론트엔드
| 파일 | 변경 내용 |
|------|----------|
| `types/index.ts` | `QuestionCategory` 타입, Question/Test에 category 추가 |
| `mocks/data/questions.ts` | mock 문제에 category 추가 |
| `components/test/QuestionCard.tsx` | 카테고리 배지 추가 |
| `pages/DashboardPage.tsx` | 연산/개념 별도 진입점 |
| `pages/student/MyStatsPage.tsx` | 트랙별 통계 |
| `pages/student/TestPlayPage.tsx` | 카테고리 표시 |

#### 신규 파일
| 파일 | 내용 |
|------|------|
| `frontend/src/services/questionGenerator/` | 문제 생성 엔진 (Phase 2) |
| `.claude/agents/difficulty-calibrator.md` | 이원 트랙 체계로 재작성 |
| `.claude/agents/problem-designer.md` | 학년별 템플릿 가이드 |

---

## 9. 우선순위 및 MVP 범위

### MVP (최소 기능 제품)
1. **데이터 모델에 category 필드 추가** (Phase 1)
2. **중1 연산 Lv.1~10 템플릿 + 생성 엔진** (Phase 2)
3. **중1 개념 Lv.1~10 템플릿** (Phase 2)
4. **대시보드에서 연산/개념 분리 진입** (Phase 3)

### MVP 이후
- 초1~초6, 중2~중3, 공통수학1 템플릿 확장 (Phase 4)
- 백엔드 문제 생성 API (Phase 5)
- 정답률 기반 난이도 자동 보정
- 학생별 취약점 분석 (카테고리 × 레벨 기반)
