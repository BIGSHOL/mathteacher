# 남은 작업 보고서

> 2022 개정 교육과정 기반 수학 문제 생성 시스템 — 잔여 작업 정리
>
> **작성일**: 2026-02-03
> **기준**: seed_concepts.py 93개 개념 vs 프론트엔드 템플릿 6개 파일

---

## 1. 현황 요약

### 1.1 진행 상황

| 단계 | 내용 | 상태 |
|------|------|------|
| A. 에이전트 참조 업데이트 | problem-designer.md, concept-mapper.md, math-lead.md | 완료 |
| B. DB 시드 데이터 | seed_concepts.py (93개), seed_db.py | 완료 |
| C-1. 초등 conceptId 교정 | elementary4~6.ts 총 9건 | 완료 |
| C-2. 중학교 conceptId 전면 재매핑 | middle1~3.ts 총 36건 | 완료 |
| D. 고우선도 누락 템플릿 작성 | 8개 개념, 16개 템플릿 | 완료 |
| E. 중우선도 누락 템플릿 작성 | 7개 개념, 14개 템플릿 | 완료 |
| F. 저우선도 누락 템플릿 작성 | 3개 개념, 6개 템플릿 | 완료 |
| G. DB 시드 실행 | PostgreSQL/Docker 기동 후 실행 | **대기** |
| H. 프론트→백엔드 파이프라인 | questions API + questionService | 완료 |

### 1.2 커버리지 추이

```
교정 전    ██████████████░░░░░░░  66% (61/93)  고아 42개
1차 교정   ████████████████░░░░░  81% (75/93)  고아  0개
2차 추가   █████████████████░░░░  89% (83/93)  고아  0개
3차 완성   █████████████████████ 100% (93/93)  고아  0개
목표       █████████████████████ 100% (93/93)
```

| 학년 | 현재 | 목표 | 남은 수 |
|------|------|------|---------|
| 초4 (E4) | 23/23 (100%) | 23/23 | 0 |
| 초5 (E5) | 24/24 (100%) | 24/24 | 0 |
| 초6 (E6) | 16/16 (100%) | 16/16 | 0 |
| 중1 (M1) | 11/11 (100%) | - | 0 |
| 중2 (M2) | 9/9 (100%) | - | 0 |
| 중3 (M3) | 10/10 (100%) | - | 0 |

---

## 2. 누락 템플릿 10건 상세

### 2.1 초4 — 6건 누락

#### (1) E4-NUM-02: 억 단위 이해

| 항목 | 내용 |
|------|------|
| 시드 설명 | 100,000,000 = 만의 만 배. 숫자 읽기/쓰기 |
| 선수 개념 | E4-NUM-01 (만 단위 이해) |
| 추천 배열 | conc 배열, level 2 |
| 추천 part | `calc` |
| 템플릿 설계 | (a) "3억 5000만을 숫자로 쓰면?" → 350000000<br>(b) "278000000은 몇 억 몇 천만?" → 2억 7800만 |
| 오답 유도 | 자릿수 0 누락, 만/억 단위 혼동 |

#### (2) E4-NUM-03: 조 단위 이해

| 항목 | 내용 |
|------|------|
| 시드 설명 | 1,000,000,000,000 = 억의 만 배. 단위 변환 |
| 선수 개념 | E4-NUM-02 (억 단위 이해) |
| 추천 배열 | conc 배열, level 3 |
| 추천 part | `calc` |
| 템플릿 설계 | (a) "5조 2000억을 숫자로 쓰면?" → 5200000000000<br>(b) "네 자리씩 끊어 읽기" 문제 |
| 오답 유도 | 억↔조 혼동, 0 개수 오류 |

#### (3) E4-NUM-04: 큰 수 비교

| 항목 | 내용 |
|------|------|
| 시드 설명 | 자릿수 비교, 같은 자릿수면 높은 자리부터 비교 |
| 선수 개념 | E4-NUM-01 (만 단위 이해) |
| 추천 배열 | conc 배열, level 3 |
| 추천 part | `calc` |
| 템플릿 설계 | (a) "43억 ○ 4300만 — ○에 들어갈 부등호는?"<br>(b) "다음 수를 큰 수부터 차례로 나열하면?" |
| 오답 유도 | 자릿수가 같을 때 낮은 자리부터 비교하는 오류 |

#### (4) E4-GEO-04: 삼각형 분류 (변)

| 항목 | 내용 |
|------|------|
| 시드 설명 | 이등변삼각형: 두 변 같음. 정삼각형: 세 변 같음(세 각 60°) |
| 선수 개념 | E4-GEO-01~03 (예각/직각/둔각) |
| 추천 배열 | conc 배열, level 6 |
| 추천 part | `geo` |
| 템플릿 설계 | (a) "세 변이 5cm, 5cm, 3cm인 삼각형의 이름은?" → 이등변삼각형<br>(b) "정삼각형의 세 각의 합은?" → 180 |
| 오답 유도 | 정삼각형과 이등변삼각형 포함관계 혼동 |

#### (5) E4-GEO-05: 삼각형 분류 (각)

| 항목 | 내용 |
|------|------|
| 시드 설명 | 예각삼각형: 세 각 모두 예각. 직각삼각형: 한 각 직각. 둔각삼각형: 한 각 둔각 |
| 선수 개념 | E4-GEO-01~03, E4-GEO-04 |
| 추천 배열 | conc 배열, level 7 |
| 추천 part | `geo` |
| 템플릿 설계 | (a) "세 각이 60°, 70°, 50°인 삼각형은 무엇삼각형?" → 예각삼각형<br>(b) "세 각이 모두 예각이어야 하는 삼각형은?" → 예각삼각형 |
| 오답 유도 | "한 각이 예각이면 예각삼각형" 오개념 (세 각 모두 예각이어야 함) |
| 참고 | 교육과정 가이드 핵심 오답: `세 각 모두 예각이어야 예각삼각형` |

#### (6) E4-STA-02: 꺾은선그래프

| 항목 | 내용 |
|------|------|
| 시드 설명 | 변화 추세에 적합. 시간에 따른 온도/키/인구 변화. 물결선(≈) 활용 |
| 선수 개념 | E4-STA-01 (막대그래프) |
| 추천 배열 | conc 배열, level 8 |
| 추천 part | `data` |
| 템플릿 설계 | (a) variant 기반 — "다음 중 꺾은선그래프로 나타내기에 적합한 것은?"<br>(b) variant 기반 — "물결선(≈)을 사용하는 이유는?" |
| 비고 | 그래프 시각 자료 없이 텍스트 문항으로 설계 필요 |

---

### 2.2 초5 — 2건 누락

#### (7) E5-GEO-01: 다각형의 둘레

| 항목 | 내용 |
|------|------|
| 시드 설명 | 정다각형: 한 변 × 변의 수. 직사각형: (가로+세로)×2 |
| 선수 개념 | 없음 (독립) |
| 추천 배열 | conc 배열, level 3 |
| 추천 part | `geo` |
| 템플릿 설계 | (a) "정오각형의 한 변이 acm일 때 둘레는?" → a × 5<br>(b) "직사각형 가로 a, 세로 b의 둘레는?" → (a+b)×2 |
| 오답 유도 | 정다각형에서 변의 수 혼동, 직사각형에서 ×2 누락 |

#### (8) E5-GEO-05: 합동

| 항목 | 내용 |
|------|------|
| 시드 설명 | 모양과 크기가 같아 완전히 겹쳐지는 관계. 대응변 길이·대응각 크기 같음 |
| 선수 개념 | E4-GEO-04 (삼각형 분류) |
| 추천 배열 | conc 배열, level 7 |
| 추천 part | `geo` |
| 템플릿 설계 | (a) variant 기반 — "합동인 두 삼각형에서 대응변 AB = 5cm일 때 DE의 길이는?"<br>(b) variant 기반 — "합동인 도형의 성질로 옳은 것은?" |
| 비고 | 대응변/대응각 개념 이해 확인 |

---

### 2.3 초6 — 2건 누락

#### (9) E6-GEO-05: 원기둥·원뿔·구 (회전체)

| 항목 | 내용 |
|------|------|
| 시드 설명 | 직사각형→원기둥. 직각삼각형→원뿔. 반원→구. 원기둥 겉넓이 = 2πr²+2πrh |
| 선수 개념 | E6-GEO-04 (원의 넓이), E6-GEO-01 (각기둥/각뿔) |
| 추천 배열 | conc 배열, level 9 |
| 추천 part | `geo` |
| 템플릿 설계 | (a) "직사각형을 한 변을 축으로 회전시키면 어떤 입체도형?" → 원기둥<br>(b) "반지름 r, 높이 h인 원기둥의 겉넓이 공식은?" |
| 비고 | 공식보다 회전체 개념 이해에 초점 |

#### (10) E6-GEO-06: 쌓기나무와 투영도

| 항목 | 내용 |
|------|------|
| 시드 설명 | 위/앞/옆에서 본 모양. 3차원→2차원 압축. 최소/최대 개수 추론 |
| 선수 개념 | E5-GEO-07 (직육면체와 정육면체) |
| 추천 배열 | conc 배열, level 9 |
| 추천 part | `geo` |
| 템플릿 설계 | (a) variant 기반 — "위에서 본 모양에 적힌 수의 합이 최소일 때 쌓기나무 개수는?"<br>(b) variant 기반 — "앞에서 본 모양이 ㄱ자일 때 가능한 쌓기나무 배치는?" |
| 비고 | 공간 추론 문제. 텍스트만으로 난이도 조절 어려움 → 단순한 형태로 제한 권장 |

---

## 3. 인프라 잔여 작업

### 3.1 DB 시드 실행 (Task #6 후속)

**현재 상태**: seed_concepts.py 데이터 검증 완료 (93개, 0 오류). PostgreSQL 미기동 상태.

**실행 방법**:
```bash
# 1. Docker 기동
docker-compose up -d

# 2. 시드 실행
cd backend
python -m app.data.seed_db --clear

# 3. 확인
python -m app.data.seed_db --dry-run
```

### 3.2 프론트 템플릿 → 백엔드 DB 파이프라인 (Task #7)

**목적**: 프론트엔드 `QuestionTemplate`에서 파라미터를 주입하여 생성한 문제를 백엔드 `questions` 테이블에 저장하는 연결.

**필요 작업**:

| 단계 | 내용 | 대상 파일 |
|------|------|----------|
| 1 | questions 테이블 스키마 확인/설계 | `backend/app/models/` |
| 2 | 문제 생성 API 엔드포인트 | `backend/app/api/` |
| 3 | 프론트에서 생성된 문제를 API로 전송 | `frontend/src/services/` |
| 4 | conceptId 기반 필터링/조회 API | `backend/app/api/` |
| 5 | 생성 이력 관리 (중복 방지) | `backend/app/models/` |

**설계 고려사항**:
- 프론트에서 `paramRanges` 내에서 랜덤 파라미터를 생성 → `contentFn`, `answerFn` 등 실행 → 완성된 문제를 API로 POST
- 백엔드는 conceptId로 concepts 테이블과 FK 연결
- 같은 템플릿에서 다른 파라미터로 무한 변형 가능 → 중복 허용 정책 결정 필요

---

## 4. 작업 우선순위 권장

### Phase 1: 핵심 인프라

| 순서 | 작업 | 근거 |
|------|------|------|
| 1 | Docker 기동 + DB 시드 실행 | 모든 백엔드 기능의 전제조건 |
| 2 | Task #7 파이프라인 구축 | 템플릿↔DB 연결이 없으면 문제 출제 불가 |

### Phase 2: 중우선도 템플릿 (7건)

| 순서 | 파일 | 개념 |
|------|------|------|
| 3 | elementary4.ts | E4-NUM-02 (억), E4-NUM-03 (조), E4-NUM-04 (큰 수 비교) |
| 4 | elementary4.ts | E4-GEO-04 (삼각형/변), E4-GEO-05 (삼각형/각) |
| 5 | elementary5.ts | E5-GEO-01 (둘레), E5-GEO-05 (합동) |

### Phase 3: 저우선도 템플릿 (3건)

| 순서 | 파일 | 개념 | 비고 |
|------|------|------|------|
| 6 | elementary4.ts | E4-STA-02 (꺾은선그래프) | 텍스트 전용 설계 |
| 7 | elementary6.ts | E6-GEO-05 (회전체) | 공식보다 개념 |
| 8 | elementary6.ts | E6-GEO-06 (쌓기나무) | 공간 추론, 난이도 제한 |

---

## 5. 템플릿 작성 규칙 (참고)

새 템플릿 작성 시 반드시 준수할 사항:

1. **Params 필드**: `a, b, c, d, e, x, y, n, variant, total, px, py`만 사용 (`noUncheckedIndexedAccess` 호환)
2. **ID 네이밍**: `{학년약어}-{comp|conc}-{번호}{a|b}` (예: `e4-conc-11a`)
3. **conceptId**: `seed_concepts.py`의 ID와 정확히 일치
4. **distractor 3개**: 학생의 대표적 오개념/실수를 반영
5. **explanationFn**: 풀이 과정을 단계별로 제시
6. **constraints**: 0 나누기, 음수 결과 등 비정상 케이스 방지
7. **TypeScript 빌드**: `npx tsc --noEmit` 에러 0건 확인 후 완료

---

## 6. 완료 시 기대 효과

| 지표 | 현재 | 전체 완료 시 |
|------|------|------------|
| 전체 커버율 | 89% (83/93) | **100% (93/93)** |
| 100% 달성 학년 | 4개 (M1~M3) | **6개 (전 학년)** |
| 총 템플릿 수 | ~190개 | ~210개 (+20) |
| 파이프라인 | 미연결 | DB 저장/조회 가능 |
| 적응형 테스트 | conceptId 기반 일부 | 전 개념 출제 가능 |
