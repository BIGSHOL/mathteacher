# 카테고리 자동 감사 안정화 및 Git 환경 개선 계획

## 개요
최근 커밋(및 배포) 시마다 일부 문제의 카테고리가 '개념(concept)'과 '연산(computation)' 사이에서 반복적으로 변경되는 현상이 발견되었습니다. 또한, Git의 줄바꿈(Line Ending) 처리로 인한 경고 메시지가 빈번하게 발생하고 있습니다. 본 계획서는 이러한 불안정성을 해결하기 위한 방안을 담고 있습니다.

## 문제 분석

### 1. 카테고리 재분류 루프 (Flip-Flop)
`backend/app/main.py`의 `audit_question_categories` 함수가 서버 시작 시마다 실행되는데, 이때 사용되는 정규표현식 패턴이 서로 겹치는 경우가 있습니다.

- **원인**: 예를 들어 "의미"라는 단어가 포함된 문항은 '개념'으로 분류되려고 하지만, 동시에 "얼마"라는 단어와 수식이 포함되어 있으면 다시 '연산'으로 분류되려고 합니다.
- **결과**: 서버가 재시작될 때마다 (커밋 후 배포 시마다) 카테고리가 번갈아 가며 바뀝니다. `e3-comp-002` 문항이 대표적인 예시입니다.

### 2. Git 줄바꿈 경고 (LF vs CRLF)
Windows 환경에서 `core.autocrlf` 설정이 활성화되어 있어, 서버(LF)와 로컬(CRLF) 간의 줄바꿈 차이로 인해 Git이 경고를 출력하고 있습니다.

## 제안된 변경 사항

### [Backend] 카테고리 감사 로직 개선
- **대상 파일**: [main.py](file:///f:/math_test/backend/app/main.py)
- **수정 사항**: `CONCEPT_CONTEXT` 패턴에 `의미`, `뜻`, `몇 개` 등의 키워드를 추가하여, 개념적인 질문이 연산으로 오분류되는 것을 방지합니다. 또한, 로직이 멱등성(Idempotency)을 갖도록 보완합니다.

### [Root] Git 속성 설정 추가
- **대상 파일**: [NEW] `.gitattributes`(file:///f:/math_test/.gitattributes)
- **수정 사항**: 프로젝트 전체의 줄바꿈 방식을 명시적으로 지정하여 환경에 따른 경고를 차단합니다.

## 검증 계획
1. `main.py` 수정 후 로컬에서 `audit_question_categories`를 여러 번 실행하여 카테고리가 더 이상 바뀌지 않는지 확인합니다.
2. `.gitattributes` 적용 후 `git status`에서 줄바꿈 관련 경고가 사라지는지 확인합니다.
