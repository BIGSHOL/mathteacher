# User Flow (사용자 흐름도)

> Mermaid 플로우차트로 핵심 기능의 주요 여정을 표현합니다.
> 성공/실패 분기를 포함하고, 온보딩→핵심작업→리텐션 루프를 표현합니다.

---

## MVP 캡슐

| # | 항목 | 내용 |
|---|------|------|
| 1 | 목표 | 강사 효율 극대화 + 학생 자기주도 학습 환경 구축 |
| 2 | 페르소나 | 초등~고1 학생 (공통수학), 학원 강사/관리자 |
| 3 | 핵심 기능 | FEAT-1: 개념 테스트 (수학 개념 이해도 확인) |
| 4 | 성공 지표 (노스스타) | 강사 개별 확인 시간 50% 절감 |
| 5 | 입력 지표 | 주간 테스트 완료 학생 비율, 평균 정답률 향상 |
| 6 | 비기능 요구 | 응답 시간 < 500ms, 모바일/태블릿 반응형 지원 |
| 7 | Out-of-scope | AI 개인 맞춤 추천, 학부모 앱, 결제 시스템 |
| 8 | Top 리스크 | 학생들이 재미없어서 안 쓸 수 있음 |
| 9 | 완화/실험 | 듀오링고 스타일 게임화 요소 적용 |
| 10 | 다음 단계 | 개념 테스트 문제 DB 설계 |

---

## 1. 전체 사용자 여정 (Overview)

### 1.1 학생 여정

```mermaid
graph TD
    A[앱 진입] --> B{로그인 상태?}
    B -->|No| C[FEAT-0: 로그인]
    B -->|Yes| D[메인 화면]
    C --> D

    D --> E{무엇을 할까?}
    E -->|오늘의 미션| F[FEAT-1: 개념 테스트]
    E -->|연산 연습| G[FEAT-2: 연산 연습 v2]
    E -->|내 기록| H[학습 통계]

    F --> I[테스트 완료]
    I --> J[게임화 피드백]
    J --> K{연속 학습?}
    K -->|Yes| D
    K -->|No| L[앱 종료]

    style F fill:#4ade80
    style J fill:#fbbf24
```

### 1.2 강사 여정

```mermaid
graph TD
    A[앱 진입] --> B{로그인 상태?}
    B -->|No| C[강사 로그인]
    B -->|Yes| D[강사 대시보드]
    C --> D

    D --> E{무엇을 할까?}
    E -->|학생 현황| F[학생 목록/통계]
    E -->|학생 관리| G[학생 계정 생성/수정]
    E -->|테스트 관리| H[테스트 출제 v2]

    F --> I[개별 학생 상세]
    I --> J{조치 필요?}
    J -->|Yes| K[학생에게 피드백]
    J -->|No| D

    style D fill:#3b82f6
    style F fill:#8b5cf6
```

---

## 2. FEAT-0: 로그인 플로우

### 2.1 학생 로그인

```mermaid
graph TD
    A[앱 시작] --> B[로그인 화면]

    B --> C[학생 ID 입력]
    C --> D[비밀번호/PIN 입력]
    D --> E{인증 성공?}

    E -->|Yes| F[세션 저장]
    F --> G[메인 화면]

    E -->|No| H[에러 표시]
    H --> I{재시도?}
    I -->|Yes| C
    I -->|비밀번호 분실| J[선생님께 문의 안내]

    style G fill:#4ade80
    style H fill:#ef4444
```

### 2.2 강사 로그인

```mermaid
graph TD
    A[앱 시작] --> B[역할 선택]
    B -->|강사| C[강사 로그인]

    C --> D[이메일 입력]
    D --> E[비밀번호 입력]
    E --> F{인증 성공?}

    F -->|Yes| G[JWT 발급]
    G --> H[강사 대시보드]

    F -->|No| I[에러 표시]
    I --> J{재시도?}
    J -->|Yes| D
    J -->|비밀번호 재설정| K[이메일로 재설정 링크]

    style H fill:#3b82f6
    style I fill:#ef4444
```

---

## 3. FEAT-1: 개념 테스트 플로우

### 3.1 테스트 시작

```mermaid
graph TD
    A[메인 화면] --> B[오늘의 테스트 선택]
    B --> C{테스트 가능?}

    C -->|이미 완료| D[결과 확인 화면]
    C -->|가능| E[테스트 시작 안내]

    E --> F[문제 수/예상 시간 표시]
    F --> G{시작?}
    G -->|Yes| H[테스트 화면]
    G -->|No| I[메인으로 돌아가기]

    style H fill:#4ade80
```

### 3.2 문제 풀이 (핵심 루프)

```mermaid
graph TD
    A[문제 표시] --> B[답안 선택/입력]
    B --> C[제출 버튼]
    C --> D{서버 채점}

    D -->|정답| E[정답 피드백]
    E --> F[콤보/점수 증가]

    D -->|오답| G[오답 피드백]
    G --> H[정답 해설 표시]

    F --> I{다음 문제?}
    H --> I

    I -->|Yes| A
    I -->|No 마지막| J[테스트 완료]

    style E fill:#4ade80
    style G fill:#ef4444
    style J fill:#fbbf24
```

### 3.3 즉시 피드백 (게임화)

```mermaid
graph TD
    A[정답 제출] --> B{정답?}

    B -->|Yes| C[애니메이션: 정답!]
    C --> D{콤보 체크}
    D -->|연속 3문제| E[콤보 x3!]
    D -->|연속 5문제| F[볼타오름!]
    D -->|연속 10문제| G[무적 모드!]
    D -->|일반| H[점수 +10]

    B -->|No| I[애니메이션: 아쉬워요]
    I --> J[콤보 리셋]
    J --> K[해설 보기 버튼]

    E --> L[다음 문제]
    F --> L
    G --> L
    H --> L
    K --> L

    style C fill:#4ade80
    style E fill:#fbbf24
    style F fill:#f97316
    style G fill:#ef4444
    style I fill:#94a3b8
```

### 3.4 테스트 완료

```mermaid
graph TD
    A[마지막 문제 완료] --> B[결과 계산]
    B --> C[결과 화면]

    C --> D[정답률 표시]
    D --> E{레벨업 조건?}

    E -->|Yes| F[레벨업 애니메이션]
    E -->|No| G[격려 메시지]

    F --> H[새 레벨 표시]
    G --> H

    H --> I[틀린 문제 복습 안내]
    I --> J{복습?}

    J -->|Yes| K[틀린 문제 해설]
    J -->|No| L[메인으로]
    K --> L

    style F fill:#fbbf24
    style H fill:#4ade80
```

---

## 4. 강사 대시보드 플로우

### 4.1 학생 현황 조회

```mermaid
graph TD
    A[강사 대시보드] --> B[반 선택]
    B --> C[학생 목록 표시]

    C --> D[정렬/필터]
    D -->|정답률 낮은 순| E[취약 학생 우선]
    D -->|최근 미접속| F[미활동 학생 표시]
    D -->|전체| G[전체 목록]

    E --> H[학생 상세 클릭]
    F --> H
    G --> H

    H --> I[개별 학생 통계]
    I --> J[취약 개념 표시]
    J --> K[학생에게 메모/피드백]

    style I fill:#8b5cf6
    style J fill:#f97316
```

### 4.2 학생 계정 생성

```mermaid
graph TD
    A[학생 관리] --> B[새 학생 추가]
    B --> C[학생 정보 입력]

    C --> D[이름 입력]
    D --> E[학년 선택]
    E --> F[반 배정]
    F --> G[초기 비밀번호 설정]

    G --> H{생성?}
    H -->|Yes| I[학생 계정 생성]
    I --> J[로그인 정보 표시]
    J --> K[인쇄/공유 옵션]

    H -->|No| A

    style I fill:#4ade80
    style K fill:#3b82f6
```

---

## 5. 리텐션 루프 (습관 형성)

```mermaid
graph TD
    A[테스트 완료] --> B[즉각 보상]
    B --> C[경험치/포인트 적립]
    C --> D[진행 상황 저장]

    D --> E[다음 목표 제시]
    E --> F{스트릭 유지?}

    F -->|7일 연속| G[스트릭 배지 획득!]
    F -->|유지 중| H[스트릭 카운터 표시]
    F -->|끊김| I[스트릭 리셋 안내]

    G --> J[다음 테스트 유도]
    H --> J
    I --> J

    %% 재방문 루프
    K[다음 날] --> L{앱 알림?}
    L -->|Yes| M[푸시 알림 v2]
    M --> N[앱 재진입]
    L -->|No| O[자연 재방문]
    O --> N
    N --> A

    style G fill:#fbbf24
    style H fill:#4ade80
```

---

## 6. 에러 처리 플로우

```mermaid
graph TD
    A[에러 발생] --> B{에러 유형?}

    B -->|네트워크| C[연결 재시도 안내]
    C --> D{재시도?}
    D -->|Yes| E[API 재요청]
    D -->|No| F[답안 로컬 저장]
    F --> G[나중에 동기화 안내]

    B -->|입력 오류| H[필드별 에러 표시]
    H --> I[사용자 수정]
    I --> J[재제출]

    B -->|세션 만료| K[재로그인 유도]
    K --> L[로그인 화면]

    B -->|서버 오류| M[잠시 후 재시도 안내]
    M --> N[선생님께 문의 안내]

    style C fill:#f97316
    style H fill:#ef4444
    style M fill:#ef4444
```

---

## 7. 화면 목록 (Screen Inventory)

### 7.1 학생 화면

| 화면 ID | 화면명 | FEAT | 진입점 | 주요 액션 |
|---------|--------|------|--------|----------|
| S-01 | 로그인 | FEAT-0 | 앱 시작 | 학생 ID/비밀번호 입력 |
| S-02 | 메인 (홈) | - | S-01 | 테스트 선택, 내 기록 확인 |
| S-03 | 테스트 선택 | FEAT-1 | S-02 | 오늘의 테스트 시작 |
| S-04 | 테스트 진행 | FEAT-1 | S-03 | 문제 풀기, 답안 제출 |
| S-05 | 즉시 피드백 | FEAT-1 | S-04 | 정답/오답 확인, 해설 보기 |
| S-06 | 테스트 결과 | FEAT-1 | S-04 | 점수, 레벨업, 틀린 문제 복습 |
| S-07 | 내 통계 | - | S-02 | 학습 기록, 성장 그래프 |

### 7.2 강사 화면

| 화면 ID | 화면명 | FEAT | 진입점 | 주요 액션 |
|---------|--------|------|--------|----------|
| T-01 | 강사 로그인 | FEAT-0 | 앱 시작 | 이메일/비밀번호 입력 |
| T-02 | 대시보드 | - | T-01 | 전체 현황 확인 |
| T-03 | 학생 목록 | - | T-02 | 학생 정렬/필터, 상세 진입 |
| T-04 | 학생 상세 | - | T-03 | 개별 학생 통계, 취약점 확인 |
| T-05 | 학생 관리 | FEAT-0 | T-02 | 학생 계정 생성/수정/삭제 |
| T-06 | 테스트 관리 | v2 | T-02 | 테스트 출제, 문제 관리 |

---

## 8. 화면 와이어프레임 (간략)

### 8.1 학생 메인 화면

```
┌─────────────────────────────────────┐
│  안녕, 민수! 오늘도 파이팅!          │  <- 인사 + 격려
├─────────────────────────────────────┤
│  🔥 7일 연속 학습 중!               │  <- 스트릭
├─────────────────────────────────────┤
│  ┌───────────────────────────────┐  │
│  │  📝 오늘의 미션                │  │
│  │  분수의 덧셈 개념 테스트        │  │
│  │  예상 시간: 5분                │  │
│  │        [시작하기]              │  │
│  └───────────────────────────────┘  │
├─────────────────────────────────────┤
│  최근 활동                          │
│  • 어제: 소수 테스트 90점 🎉        │
│  • 2일 전: 분수 기초 완료           │
├─────────────────────────────────────┤
│  [🏠 홈] [📊 내 기록] [⚙️ 설정]     │  <- 하단 네비게이션
└─────────────────────────────────────┘
```

### 8.2 테스트 진행 화면

```
┌─────────────────────────────────────┐
│  문제 3/10         콤보 x2 🔥        │  <- 진행 상황
├─────────────────────────────────────┤
│                                     │
│  다음 중 1/2 + 1/4의 값은?          │  <- 문제
│                                     │
│  ┌─────────────────────────────┐    │
│  │  ① 2/6                     │    │
│  └─────────────────────────────┘    │
│  ┌─────────────────────────────┐    │
│  │  ② 3/4   ✓                 │    │  <- 선택된 답
│  └─────────────────────────────┘    │
│  ┌─────────────────────────────┐    │
│  │  ③ 1/6                     │    │
│  └─────────────────────────────┘    │
│  ┌─────────────────────────────┐    │
│  │  ④ 2/4                     │    │
│  └─────────────────────────────┘    │
│                                     │
│           [제출하기]                │
└─────────────────────────────────────┘
```

### 8.3 정답 피드백 화면

```
┌─────────────────────────────────────┐
│                                     │
│            🎉 정답!                 │  <- 애니메이션
│                                     │
│           콤보 x3! 🔥               │
│           +30점                     │
│                                     │
│  ────────────────────────────────   │
│  1/2 + 1/4 = 2/4 + 1/4 = 3/4       │  <- 간단 해설
│  ────────────────────────────────   │
│                                     │
│          [다음 문제 →]              │
│                                     │
└─────────────────────────────────────┘
```

---

## Decision Log 참조

| ID | 항목 | 선택 | 근거 | 영향 |
|----|------|------|------|------|
| D-09 | 피드백 방식 | 즉시 피드백 (문제별) | 집중력 유지, 게임화 | 채점 API 호출 빈도 증가 |
| D-10 | 게임화 요소 | 콤보, 레벨, 스트릭 | 듀오링고 벤치마크 | UI 애니메이션 필요 |
| D-11 | 테스트 구조 | 문제 1개씩 표시 | 집중력, 모바일 최적화 | 한 화면에 한 문제 |
